# winapis

## LoadLibraryA

在 Windows 操作系统中，LoadLibraryA 是 Kernel32.dll 导出的一个非常核心的 API 函数。

它的核心定义：  
它的作用是将一个指定的模块（通常是 .dll 文件，也可以是 .exe）加载到调用进程的虚拟地址空间中。

这里的“A”是什么意思？  
Windows API 通常成对出现：

- LoadLibraryA：接受 ANSI 字符串（传统的单字节字符，如 C 语言的 char*）。
- LoadLibraryW：接受 Wide 字符（Unicode 字符串，如 wchar_t*）。
它们的功能完全一样，只是输入参数的字符编码不同。

它的具体工作流程（当你调用它时）：

1. 查找文件：系统会在硬盘上按照特定的搜索顺序（当前目录 -> 系统目录 -> PATH 环境变量等）寻找你指定名字的 DLL 文件（例如 user32.dll）。
2. 映射内存：如果找到了，系统会将这个 DLL 文件从硬盘“搬运”（映射）到你当前进程的内存空间里。
3. 处理依赖：如果这个 DLL 还需要其他的 DLL 才能运行，系统会递归地把那些 DLL 也加载进来。
4. 初始化：系统会执行该 DLL 的入口函数 DllMain，让 DLL 做一些初始化的准备工作。
5. 返回基址：最重要的一步，它会返回一个 HMODULE（句柄）。  
   - 这个句柄本质上就是该 DLL 在内存中的 起始地址（基地址，Base Address）。

为什么要用它？

- 动态扩展能力：程序不需要在编译时就把所有功能都打包进去。可以通过 LoadLibraryA 在运行时按需加载插件。
- 获取其他 API 的前置条件：如果你想调用某个 DLL 里的函数（比如 MessageBox），你首先必须确保这个 DLL 已经被加载到内存里了，并且你需要拿到它的基地址，才能计算出 MessageBox 在内存里的准确位置。
