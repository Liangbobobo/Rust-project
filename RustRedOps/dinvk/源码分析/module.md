- [Ê≥®ÊÑè](#Ê≥®ÊÑè)
  - [‰ªÄ‰πàÊòØÂä†ËΩΩÂô®ÔºàLoaderÔºâÔºü](#‰ªÄ‰πàÊòØÂä†ËΩΩÂô®loader)
    - [1. Êìç‰ΩúÁ≥ªÁªüËßÜËßíÔºöÊ†áÂáÜÂä†ËΩΩÂô®ÔºàOS LoaderÔºâ](#1-Êìç‰ΩúÁ≥ªÁªüËßÜËßíÊ†áÂáÜÂä†ËΩΩÂô®os-loader)
      - [‰∏ªË¶ÅËÅåË¥£ÊµÅÁ®ã](#‰∏ªË¶ÅËÅåË¥£ÊµÅÁ®ã)
    - [2. ÂÆâÂÖ®‰∏éÁ∫¢ÈòüËßÜËßíÔºöËá™ÂÆö‰πâÂä†ËΩΩÂô®ÔºàCustom LoaderÔºâ](#2-ÂÆâÂÖ®‰∏éÁ∫¢ÈòüËßÜËßíËá™ÂÆö‰πâÂä†ËΩΩÂô®custom-loader)
      - [‰∏∫‰ªÄ‰πàË¶ÅËá™Â∑±ÂÜôÂä†ËΩΩÂô®Ôºü](#‰∏∫‰ªÄ‰πàË¶ÅËá™Â∑±ÂÜôÂä†ËΩΩÂô®)
      - [Â∏∏ËßÅÁ±ªÂûã](#Â∏∏ËßÅÁ±ªÂûã)
    - [3. ÁªìÂêà‰Ω†ÁöÑÈ°πÁõÆÔºà`dinvk`ÔºâÔºöÂä†ËΩΩÂô®ÁöÑÊ∑±Â∫¶ÂÆûÁé∞](#3-ÁªìÂêà‰Ω†ÁöÑÈ°πÁõÆdinvkÂä†ËΩΩÂô®ÁöÑÊ∑±Â∫¶ÂÆûÁé∞)
      - [Á¨¨‰∏ÄÊ≠•ÔºöËß£Êûê PE Â§¥ÔºàPE ParsingÔºâ](#Á¨¨‰∏ÄÊ≠•Ëß£Êûê-pe-Â§¥pe-parsing)
      - [Á¨¨‰∫åÊ≠•ÔºöÂÜÖÂ≠òÂàÜÈÖçÔºàAllocationÔºâ](#Á¨¨‰∫åÊ≠•ÂÜÖÂ≠òÂàÜÈÖçallocation)
      - [Á¨¨‰∏âÊ≠•ÔºöÊò†Â∞ÑËäÇÔºàMapping SectionsÔºâ‚Äî‚ÄîÂÖ≥ÈîÆ](#Á¨¨‰∏âÊ≠•Êò†Â∞ÑËäÇmapping-sectionsÂÖ≥ÈîÆ)
      - [Á¨¨ÂõõÊ≠•ÔºöÂü∫ÂùÄÈáçÂÆö‰ΩçÔºàBase RelocationÔºâ](#Á¨¨ÂõõÊ≠•Âü∫ÂùÄÈáçÂÆö‰Ωçbase-relocation)
      - [Á¨¨‰∫îÊ≠•ÔºöËß£ÊûêÂØºÂÖ•Ë°®ÔºàResolve Imports / IAT FixingÔºâ](#Á¨¨‰∫îÊ≠•Ëß£ÊûêÂØºÂÖ•Ë°®resolve-imports--iat-fixing)
      - [Á¨¨ÂÖ≠Ê≠•ÔºöÊùÉÈôêÊúÄÁªàËÆæÁΩÆÔºàFinalize ProtectionsÔºâ](#Á¨¨ÂÖ≠Ê≠•ÊùÉÈôêÊúÄÁªàËÆæÁΩÆfinalize-protections)
      - [Á¨¨‰∏ÉÊ≠•ÔºöÊâßË°åÔºàExecutionÔºâ](#Á¨¨‰∏ÉÊ≠•ÊâßË°åexecution)
    - [4. È°πÁõÆÁªìÊûÑ‰∏éÂä†ËΩΩÂô®ÂäüËÉΩÁöÑÊò†Â∞Ñ](#4-È°πÁõÆÁªìÊûÑ‰∏éÂä†ËΩΩÂô®ÂäüËÉΩÁöÑÊò†Â∞Ñ)
    - [5. ‰∏∫‰ªÄ‰πàËøôË¢´Áß∞‰∏∫ ‚ÄúRedOps‚ÄùÔºü](#5-‰∏∫‰ªÄ‰πàËøôË¢´Áß∞‰∏∫-redops)
  - [Ê≠§È°πÁõÆÊâæDLL Âü∫ÂùÄÁöÑÂéüÁêÜ](#Ê≠§È°πÁõÆÊâædll-Âü∫ÂùÄÁöÑÂéüÁêÜ)
  - [TEB](#teb)
  - [PEÂíåPEBÁöÑ‰∏âÂ§ßÊ†∏ÂøÉËÅîÁ≥ª](#peÂíåpebÁöÑ‰∏âÂ§ßÊ†∏ÂøÉËÅîÁ≥ª)
    - [ËÅîÁ≥ª‰∏Ä:ÂÆö‰Ωç‰∏ªÊ®°ÂùóÂü∫ÂùÄ (PEB.ImageBaseAddress)](#ËÅîÁ≥ª‰∏ÄÂÆö‰Ωç‰∏ªÊ®°ÂùóÂü∫ÂùÄ-pebimagebaseaddress)
    - [ËÅîÁ≥ª‰∫å:ÁÆ°ÁêÜÊâÄÊúâÂä†ËΩΩÁöÑ PE Ê®°Âùó (PEB.Ldr)](#ËÅîÁ≥ª‰∫åÁÆ°ÁêÜÊâÄÊúâÂä†ËΩΩÁöÑ-pe-Ê®°Âùó-pebldr)
    - [ËÅîÁ≥ª‰∏â: Êï∞ÊçÆÁõÆÂΩïÁöÑËøêË°åÊó∂ËÆøÈóÆÔºàData DirectoriesÔºâ](#ËÅîÁ≥ª‰∏â-Êï∞ÊçÆÁõÆÂΩïÁöÑËøêË°åÊó∂ËÆøÈóÆdata-directories)
  - [PE](#pe)
    - [Êú¨È°πÁõÆÊ≤°ÊúâÂÆö‰πâ‰∏Ä‰∏™ÊääÊâÄÊúâÂ≠óÊÆµÊâìÂåÖÂú®‰∏ÄËµ∑ÁöÑÂçï‰∏Ä `PE`ÁªìÊûÑ‰ΩìÔºü](#Êú¨È°πÁõÆÊ≤°ÊúâÂÆö‰πâ‰∏Ä‰∏™ÊääÊâÄÊúâÂ≠óÊÆµÊâìÂåÖÂú®‰∏ÄËµ∑ÁöÑÂçï‰∏Ä-peÁªìÊûÑ‰Ωì)
      - [dinvk ÁöÑÂÅöÊ≥ïÔºöÈÄöËøáÊåáÈíàÂíåÂÅèÁßªÈáèËÆøÈóÆ](#dinvk-ÁöÑÂÅöÊ≥ïÈÄöËøáÊåáÈíàÂíåÂÅèÁßªÈáèËÆøÈóÆ)
    - [PE (Memory Layout)](#pe-memory-layout)
    - [PEÊñá‰ª∂ÁªìÊûÑ](#peÊñá‰ª∂ÁªìÊûÑ)
      - [PE Êñá‰ª∂ÁªìÊûÑËØ¶Ëß£ÔºöÂü∫‰∫é `dinvk` È°πÁõÆ‰∏≠ÁöÑÊï∞ÊçÆÁªìÊûÑ](#pe-Êñá‰ª∂ÁªìÊûÑËØ¶Ëß£Âü∫‰∫é-dinvk-È°πÁõÆ‰∏≠ÁöÑÊï∞ÊçÆÁªìÊûÑ)
      - [Á¨¨‰∏ÄÈÉ®ÂàÜÔºöDOS HeaderÔºàÂÖºÂÆπÊÄßÂ§¥ÈÉ®Ôºâ](#Á¨¨‰∏ÄÈÉ®ÂàÜdos-headerÂÖºÂÆπÊÄßÂ§¥ÈÉ®)
      - [Á¨¨‰∫åÈÉ®ÂàÜÔºöNT HeadersÔºàPE Ê†∏ÂøÉÂ§¥Ôºâ](#Á¨¨‰∫åÈÉ®ÂàÜnt-headerspe-Ê†∏ÂøÉÂ§¥)
        - [2.1 File HeaderÔºàÊñá‰ª∂Áâ©ÁêÜÊ¶ÇÂÜµÔºâ](#21-file-headerÊñá‰ª∂Áâ©ÁêÜÊ¶ÇÂÜµ)
        - [2.2 Optional HeaderÔºàÈÄªËæëÂä†ËΩΩ‰ø°ÊÅØÔºâ](#22-optional-headerÈÄªËæëÂä†ËΩΩ‰ø°ÊÅØ)
      - [2.3 Data DirectoryÔºàÂäüËÉΩÁ¥¢ÂºïË°®Ôºâ](#23-data-directoryÂäüËÉΩÁ¥¢ÂºïË°®)
      - [`IMAGE_EXPORT_DIRECTORY->AddressOfNames` ÁöÑÂÜÖÂ≠òÂΩíÂ±ûËß£Êûê](#image_export_directory-addressofnames-ÁöÑÂÜÖÂ≠òÂΩíÂ±ûËß£Êûê)
        - [1. **Áâ©ÁêÜÂΩíÂ±ûÔºöÂÆÉÊòØÁõÆÊ†á DLL ÁöÑ‰∏ÄÈÉ®ÂàÜ**](#1-Áâ©ÁêÜÂΩíÂ±ûÂÆÉÊòØÁõÆÊ†á-dll-ÁöÑ‰∏ÄÈÉ®ÂàÜ)
        - [2. **ÂÜÖÂ≠ò‰ΩçÁΩÆÔºö‰Ωç‰∫éÂΩìÂâçËøõÁ®ãÁöÑËôöÊãüÂú∞ÂùÄÁ©∫Èó¥ÂÜÖ**](#2-ÂÜÖÂ≠ò‰ΩçÁΩÆ‰Ωç‰∫éÂΩìÂâçËøõÁ®ãÁöÑËôöÊãüÂú∞ÂùÄÁ©∫Èó¥ÂÜÖ)
        - [3. **ÊäÄÊúØÁªÜËäÇ‰øÆÊ≠£ÔºöÂÆÉÊòØ‰∏Ä‰∏™‚ÄúRVA Êï∞ÁªÑ‚ÄùÔºåËÄåÈùû‚ÄúÂ≠óÁ¨¶‰∏≤Êï∞ÁªÑ‚Äù**](#3-ÊäÄÊúØÁªÜËäÇ‰øÆÊ≠£ÂÆÉÊòØ‰∏Ä‰∏™rva-Êï∞ÁªÑËÄåÈùûÂ≠óÁ¨¶‰∏≤Êï∞ÁªÑ)
        - [ÊÄªÁªì](#ÊÄªÁªì)
      - [Á¨¨‰∏âÈÉ®ÂàÜÔºöSection HeadersÔºàËäÇË°®Ôºâ](#Á¨¨‰∏âÈÉ®ÂàÜsection-headersËäÇË°®)
      - [ÊÄªÁªìÔºöWindows PE Âä†ËΩΩÊµÅÁ®ã](#ÊÄªÁªìwindows-pe-Âä†ËΩΩÊµÅÁ®ã)
  - [PEB](#peb)
    - [‰∏Ä‰∏™ÂèØÊâßË°åÊñá‰ª∂‰∫ßÁîüÂ§ö‰∏™ËøõÁ®ãÊó∂PEBÊòØÊÄé‰πàÊ†∑ÁöÑ?](#‰∏Ä‰∏™ÂèØÊâßË°åÊñá‰ª∂‰∫ßÁîüÂ§ö‰∏™ËøõÁ®ãÊó∂pebÊòØÊÄé‰πàÊ†∑ÁöÑ)
    - [LDR](#ldr)
    - [PEB\_LDR\_DATA](#peb_ldr_data)
    - [InMemoryOrderModuleList](#inmemoryordermodulelist)
    - [LDR\_DATA\_TABLE\_ENTRY](#ldr_data_table_entry)
      - [LDR\_DATA\_TABLE\_ENTRYÂ¶Ç‰Ωï‰∫ßÁîüÂπ∂Áª¥Êä§?](#ldr_data_table_entryÂ¶Ç‰Ωï‰∫ßÁîüÂπ∂Áª¥Êä§)
        - [‰∫ßÁîü (Creation)](#‰∫ßÁîü-creation)
        - [Áª¥Êä§ (Maintenance)](#Áª¥Êä§-maintenance)
        - [ÈîÄÊØÅ (Destruction)](#ÈîÄÊØÅ-destruction)
    - [ImageBaseAddress](#imagebaseaddress)
  - [let mut data\_table\_entry = (*ldr\_data).InMemoryOrderModuleList.Flink as*const LDR\_DATA\_TABLE\_ENTRY](#let-mut-data_table_entry--ldr_datainmemoryordermodulelistflink-asconst-ldr_data_table_entry)
    - [Áâ©ÁêÜ‰∫ãÂÆû (Memory Reality)](#Áâ©ÁêÜ‰∫ãÂÆû-memory-reality)
    - [ÁºñËØëÂô®ÁöÑ‚ÄúÈîôËßâ‚Äù (Compiler's View)](#ÁºñËØëÂô®ÁöÑÈîôËßâ-compilers-view)
    - [ÁªìÊûúÔºöÂÅèÁßªÈáèÁöÑ‚ÄúÂπ≥Áßª‚Äù](#ÁªìÊûúÂÅèÁßªÈáèÁöÑÂπ≥Áßª)
    - [ÊÄªÁªì](#ÊÄªÁªì-1)
  - [Êåá‰ª§ÈõÜÊû∂ÊûÑ](#Êåá‰ª§ÈõÜÊû∂ÊûÑ)
    - [1. ARM Êû∂ÊûÑÔºàAArch64 / ARM64Ôºâ](#1-arm-Êû∂ÊûÑaarch64--arm64)
    - [2. RISC-V](#2-risc-v)
    - [3. WebAssemblyÔºàWasmÔºâ](#3-webassemblywasm)
    - [4. x86Ôºà32-bitÔºâ/ i686](#4-x8632-bit-i686)
    - [5. ÂÖ∂‰ªñÂµåÂÖ•Âºè‰∏é‰∏ìÁî®Êû∂ÊûÑ](#5-ÂÖ∂‰ªñÂµåÂÖ•Âºè‰∏é‰∏ìÁî®Êû∂ÊûÑ)
    - [ÊÄªÁªìÔºöCISC vs RISC](#ÊÄªÁªìcisc-vs-risc)
  - [EXE Êñá‰ª∂Âíå PE Êñá‰ª∂ÁöÑÂÖ≥Á≥ªÔºüÈô§‰∫Ü EXE ËøòÊúâÂì™‰∫õ PE Êñá‰ª∂Ôºü](#exe-Êñá‰ª∂Âíå-pe-Êñá‰ª∂ÁöÑÂÖ≥Á≥ªÈô§‰∫Ü-exe-ËøòÊúâÂì™‰∫õ-pe-Êñá‰ª∂)
    - [2. Èô§‰∫Ü EXEÔºåËøòÊúâÂì™‰∫õÂ∏∏ËßÅÁöÑ PE Êñá‰ª∂Ôºü](#2-Èô§‰∫Ü-exeËøòÊúâÂì™‰∫õÂ∏∏ËßÅÁöÑ-pe-Êñá‰ª∂)
      - [A. Âä®ÊÄÅÈìæÊé•Â∫ìÔºàDLLÔºâ](#a-Âä®ÊÄÅÈìæÊé•Â∫ìdll)
      - [B. È©±Âä®Á®ãÂ∫èÔºàDriversÔºâ](#b-È©±Âä®Á®ãÂ∫èdrivers)
      - [C. ÂÖ∂‰ªñÁ≥ªÁªü/ÂäüËÉΩÊñá‰ª∂](#c-ÂÖ∂‰ªñÁ≥ªÁªüÂäüËÉΩÊñá‰ª∂)
    - [3. Â¶Ç‰ΩïÂå∫ÂàÜ‰∏çÂêåÁ±ªÂûãÁöÑ PE Êñá‰ª∂Ôºü](#3-Â¶Ç‰ΩïÂå∫ÂàÜ‰∏çÂêåÁ±ªÂûãÁöÑ-pe-Êñá‰ª∂)
    - [1. EXEÔºàExecutableÔºâ‚Äî‚Äî Áã¨Á´ãÁöÑÊâßË°å‰∏ª‰Ωì](#1-exeexecutable-Áã¨Á´ãÁöÑÊâßË°å‰∏ª‰Ωì)
    - [2. DLLÔºàDynamic Link LibraryÔºâ‚Äî‚Äî ÂÖ±‰∫´ÁöÑ‰ª£Á†Å‰ªìÂ∫ì](#2-dlldynamic-link-library-ÂÖ±‰∫´ÁöÑ‰ª£Á†Å‰ªìÂ∫ì)
    - [3. SYSÔºàSystem DriverÔºâ‚Äî‚Äî ÂÜÖÊ†∏ÁöÑÂª∂‰º∏](#3-syssystem-driver-ÂÜÖÊ†∏ÁöÑÂª∂‰º∏)
    - [4. EFIÔºàExtensible Firmware InterfaceÔºâ‚Äî‚Äî Á≥ªÁªüÁöÑÂêØÂä®ËÄÖ](#4-efiextensible-firmware-interface-Á≥ªÁªüÁöÑÂêØÂä®ËÄÖ)
    - [5. SCRÔºàScreen SaverÔºâ‚Äî‚Äî ÁâπÊÆäÁî®ÈÄîÁöÑ EXE](#5-scrscreen-saver-ÁâπÊÆäÁî®ÈÄîÁöÑ-exe)
    - [6. OCX / CPL ‚Äî‚Äî Êèí‰ª∂ÂºèÊû∂ÊûÑÁöÑÂÆûÁé∞ËÄÖ](#6-ocx--cpl--Êèí‰ª∂ÂºèÊû∂ÊûÑÁöÑÂÆûÁé∞ËÄÖ)
  - [ÊÄªÁªìÔºö‰∏∫‰ΩïÈúÄË¶ÅÂ¶ÇÊ≠§Â§öÊ†∑ÁöÑ PE Ê†ºÂºèÔºü](#ÊÄªÁªì‰∏∫‰ΩïÈúÄË¶ÅÂ¶ÇÊ≠§Â§öÊ†∑ÁöÑ-pe-Ê†ºÂºè)
  - [Ê∫êÁ†Å](#Ê∫êÁ†Å)
    - [CStr::from\_ptr(ptr).to\_string\_lossy().into\_owned()](#cstrfrom_ptrptrto_string_lossyinto_owned)
      - [1. `CStr::from_ptr(ptr)`ÔºöÂ∞ÅË£ÖÂéüÂßãÊåáÈíàÔºåÂàõÂª∫ÂÆâÂÖ®ËßÜÂõæ](#1-cstrfrom_ptrptrÂ∞ÅË£ÖÂéüÂßãÊåáÈíàÂàõÂª∫ÂÆâÂÖ®ËßÜÂõæ)
      - [2. `.to_string_lossy()`ÔºöÂÆπÈîôÂºè UTF-8 ËΩ¨Êç¢](#2-to_string_lossyÂÆπÈîôÂºè-utf-8-ËΩ¨Êç¢)
      - [3. `.into_owned()`ÔºöÂ§∫ÂèñÊâÄÊúâÊùÉÔºåÂÆûÁé∞Ê∑±Êã∑Ë¥ù](#3-into_ownedÂ§∫ÂèñÊâÄÊúâÊùÉÂÆûÁé∞Ê∑±Êã∑Ë¥ù)
      - [Âú® `dinvk` È°πÁõÆ‰∏≠ÁöÑÂÖ∑‰ΩìÊÑè‰πâ](#Âú®-dinvk-È°πÁõÆ‰∏≠ÁöÑÂÖ∑‰ΩìÊÑè‰πâ)
      - [‰∏ÄÂè•ËØùÊÄªÁªì](#‰∏ÄÂè•ËØùÊÄªÁªì)

# Ê≥®ÊÑè

ËØ∑ËÆ∞ÂæóÊâÄÊúâÂÖ≥‰∫éÂÜÖÂ≠òÂèäwindowsÂèØÊâßË°åÊñá‰ª∂ÁöÑÊìç‰Ωú,ÈÉΩÂèØ‰ª•Áî®windbgÊü•ÁúãÂú®ÂÜÖÂ≠ò‰∏≠ÁöÑÁõ¥ËßÇÊòæÁ§∫.  

ËØ∑ËÆ∞‰Ωè,‰∏ÄÂÆöË¶Å‰ΩøÁî®windbg,ËøôÁîöËá≥ÊØîÂÜô‰ª£Á†ÅÊõ¥Âä†ÈáçË¶Å

Êú¨È°πÁõÆ‰∏≠:  
TEB->PEB->LDR(Ë£∏ÊåáÈíà)->PEB_LDR_DATA->InMemoryOrderModuleList(ÂèåÂêëÈìæË°®)->LDR_DATA_TABLE_ENTRY

## ‰ªÄ‰πàÊòØÂä†ËΩΩÂô®ÔºàLoaderÔºâÔºü

Âú®ËÆ°ÁÆóÊú∫ÁßëÂ≠¶ÂíåÊìç‰ΩúÁ≥ªÁªüÈ¢ÜÂüüÔºå**Âä†ËΩΩÂô®ÔºàLoaderÔºâ** ÊòØ‰∏Ä‰∏™ÊûÅÂÖ∂Ê†∏ÂøÉÁöÑÁªÑ‰ª∂„ÄÇÁªìÂêà‰Ω†ÂΩìÂâçÁöÑ `RustRedOps/dinvk` È°πÁõÆÔºà‰∏Ä‰∏™Ê∂âÂèä Windows Á≥ªÁªüÂ∫ïÂ±Ç„ÄÅÁõ¥Êé•Á≥ªÁªüË∞ÉÁî®ÂíåÁ∫¢ÈòüÊäÄÊúØÁöÑÈ°πÁõÆÔºâÔºåÊàë‰ª¨ÈúÄË¶Å‰ªé **Êìç‰ΩúÁ≥ªÁªüÂéüÁêÜ** Âíå **ÂÆâÂÖ®ÊîªÈò≤ÔºàRed TeamingÔºâ** ‰∏§‰∏™ËßíÂ∫¶Êù•Ê∑±ÂÖ•ÁêÜËß£ÂÆÉ„ÄÇ

> **ÁÆÄÂçïÊù•ËØ¥ÔºåÂä†ËΩΩÂô®ÁöÑ‰ΩúÁî®ÊòØÔºöÂ∞ÜÂèØÊâßË°åÁ®ãÂ∫èÔºàÈùôÊÄÅÊñá‰ª∂Ôºâ‰ªéÁ£ÅÁõò‚ÄúÊê¨Ëøê‚ÄùÂà∞ÂÜÖÂ≠ò‰∏≠ÔºåÂπ∂Â∞ÜÂÖ∂ÂèòÊàêÂèØËøêË°åÁöÑËøõÁ®ãÔºàÂä®ÊÄÅÂÆû‰ΩìÔºâ„ÄÇ**

---

### 1. Êìç‰ΩúÁ≥ªÁªüËßÜËßíÔºöÊ†áÂáÜÂä†ËΩΩÂô®ÔºàOS LoaderÔºâ

ÂΩì‰Ω†ÂèåÂáª‰∏Ä‰∏™ `.exe` Êñá‰ª∂ÔºàWindowsÔºâÊàñËøêË°å‰∏Ä‰∏™ ELF Á®ãÂ∫èÔºàLinuxÔºâÊó∂ÔºåÊìç‰ΩúÁ≥ªÁªüÁöÑÂä†ËΩΩÂô®ÂºÄÂßãÂ∑•‰Ωú„ÄÇÂÆÉÊòØÊìç‰ΩúÁ≥ªÁªüÂÜÖÊ†∏ÊàñÁî®Êà∑Á©∫Èó¥ËøêË°åÊó∂ÁöÑ‰∏ÄÈÉ®ÂàÜ„ÄÇ

#### ‰∏ªË¶ÅËÅåË¥£ÊµÅÁ®ã

1. **È™åËØÅ‰∏éËß£ÊûêÔºàValidation & ParsingÔºâ**  
   - ËØªÂèñÊñá‰ª∂Â§¥ÔºàÂ¶Ç Windows ÁöÑ PE Â§¥ÔºâÔºåÊ£ÄÊü•Êñá‰ª∂Ê†ºÂºèÊòØÂê¶ÂêàÊ≥ï„ÄÇ
   - Ëß£ÊûêËäÇÔºàSectionÔºâË°®„ÄÅÂØºÂÖ•Ë°®ÔºàIATÔºâ„ÄÅÂØºÂá∫Ë°®ÔºàEATÔºâ„ÄÅÈáçÂÆö‰ΩçË°®Ôºà`.reloc`ÔºâÁ≠âÁªìÊûÑ„ÄÇ

2. **ÂÜÖÂ≠òÊò†Â∞ÑÔºàMappingÔºâ**  
   - Âú®ËôöÊãüÂÜÖÂ≠ò‰∏≠‰∏∫Á®ãÂ∫èÁî≥ËØ∑Âú∞ÂùÄÁ©∫Èó¥„ÄÇ
   - Â∞ÜÁ£ÅÁõò‰∏äÁöÑ‰ª£Á†ÅÊÆµÔºà`.text`Ôºâ„ÄÅÊï∞ÊçÆÊÆµÔºà`.data`Ôºâ„ÄÅÂè™ËØªÊï∞ÊçÆÊÆµÔºà`.rdata`ÔºâÁ≠âÊåâÈ°µÊò†Â∞ÑÂà∞ÂÜÖÂ≠ò‰∏≠ÁöÑÁõ∏Â∫îËôöÊãüÂú∞ÂùÄ„ÄÇ

3. **ÈáçÂÆö‰ΩçÔºàRelocationÔºâ**  
   - Áî±‰∫é ASLRÔºàÂú∞ÂùÄÁ©∫Èó¥Â∏ÉÂ±ÄÈöèÊú∫ÂåñÔºâÁöÑÂ≠òÂú®ÔºåÁ®ãÂ∫èÊØèÊ¨°Âä†ËΩΩÁöÑÂü∫Âú∞ÂùÄÈÉΩ‰∏çÂêå„ÄÇ
   - Âä†ËΩΩÂô®‰ºöÈÅçÂéÜÈáçÂÆö‰ΩçË°®Ôºå‰øÆÊ≠£ÊâÄÊúâÁ°¨ÁºñÁ†ÅÁöÑÁªùÂØπÂú∞ÂùÄÔºå‰ΩøÂÖ∂ÊåáÂêëÂΩìÂâçÂÆûÈôÖÂä†ËΩΩ‰ΩçÁΩÆ„ÄÇ

4. **Á¨¶Âè∑Ëß£Êûê‰∏éÂØºÂÖ•ÔºàImport ResolutionÔºâ**  
   - Á®ãÂ∫èÈÄöÂ∏∏‰æùËµñÂ§ñÈÉ® DLLÔºàÂ¶Ç `kernel32.dll`, `ntdll.dll`Ôºâ„ÄÇ
   - Âä†ËΩΩÂô®ÈÅçÂéÜÂØºÂÖ•Âú∞ÂùÄË°®ÔºàIATÔºâÔºåÂä†ËΩΩÊâÄÈúÄ DLLÔºåÂπ∂Â∞ÜÂáΩÊï∞ÁöÑÁúüÂÆûÂú∞ÂùÄÂ°´ÂÖ• IATÔºå‰ΩøÁ®ãÂ∫èËÉΩÊ≠£Â∏∏Ë∞ÉÁî® APIÔºàÂ¶Ç `WriteFile`, `CreateThread`Ôºâ„ÄÇ

5. **ÊùÉÈôêËÆæÁΩÆÔºàPermission SettingÔºâ**  
   - ËÆæÁΩÆÂêÑÂÜÖÂ≠òÈ°µÁöÑËÆøÈóÆÊùÉÈôêÔºö
     - ‰ª£Á†ÅÊÆµ ‚Üí RXÔºàÂèØËØª„ÄÅÂèØÊâßË°åÔºâ
     - Êï∞ÊçÆÊÆµ ‚Üí RWÔºàÂèØËØª„ÄÅÂèØÂÜôÔºâ
     - ÈÅøÂÖç RWXÔºàÂèØËØª„ÄÅÂèØÂÜô„ÄÅÂèØÊâßË°åÔºâÔºåÂõ†ÂÖ∂ÊòØÊÅ∂ÊÑèËΩØ‰ª∂ÁöÑÂÖ∏ÂûãÁâπÂæÅ„ÄÇ

6. **Áßª‰∫§ÊéßÂà∂ÊùÉÔºàExecutionÔºâ**  
   - ÂàùÂßãÂåñÊ†àÔºàStackÔºâÂíåÂ†ÜÔºàHeapÔºâ„ÄÇ
   - Ë∑≥ËΩ¨Âà∞Á®ãÂ∫èÂÖ•Âè£ÁÇπÔºàEntry PointÔºâÔºåÈÄöÂ∏∏ÊòØ CRT ÂêØÂä®‰ª£Á†ÅÔºåÊúÄÁªàËøõÂÖ• `main()` Êàñ `WinMain()`„ÄÇ

---

### 2. ÂÆâÂÖ®‰∏éÁ∫¢ÈòüËßÜËßíÔºöËá™ÂÆö‰πâÂä†ËΩΩÂô®ÔºàCustom LoaderÔºâ

Âú®‰Ω†ÁöÑ `RustRedOps/dinvk` ‰∏ä‰∏ãÊñá‰∏≠Ôºå‚ÄúÂä†ËΩΩÂô®‚ÄùÈÄöÂ∏∏Êåá **Malware Loader** Êàñ **Shellcode Loader**„ÄÇ

Á∫¢ÈòüÂºÄÂèë‰∫∫ÂëòÁºñÂÜôËá™ÂÆö‰πâÂä†ËΩΩÂô®ÁöÑÊ†∏ÂøÉÁõÆÁöÑÔºö**ÁªïËøáÊùÄÊØíËΩØ‰ª∂ÔºàAVÔºâÂíåÁªàÁ´ØÊ£ÄÊµãÂìçÂ∫îÁ≥ªÁªüÔºàEDRÔºâÁöÑÁõëÊéß**„ÄÇ

#### ‰∏∫‰ªÄ‰πàË¶ÅËá™Â∑±ÂÜôÂä†ËΩΩÂô®Ôºü

- Ê†áÂáÜÁöÑ Windows Âä†ËΩΩË∑ØÂæÑÔºàÂ¶Ç `CreateProcess`, `LoadLibrary`Ôºâ‰ºöË¢´ EDR Ê∑±Â∫¶ Hook„ÄÇ
- Ëá™ÂÆö‰πâÂä†ËΩΩÂô®ËØïÂõæÂú®‰∏çËß¶ÂèëË≠¶Êä•ÁöÑÊÉÖÂÜµ‰∏ãÔºåÂ∞ÜÊÅ∂ÊÑè Payload Ê≥®ÂÖ•ÂÜÖÂ≠òÂπ∂ÊâßË°å„ÄÇ

#### Â∏∏ËßÅÁ±ªÂûã

1. **Shellcode Loader**  
   - ÊúÄÁÆÄÂçïÂΩ¢ÂºèÔºöË∞ÉÁî® `VirtualAlloc` ÂàÜÈÖç RWX ÂÜÖÂ≠òÔºåÂ§çÂà∂ ShellcodeÔºåÁÑ∂ÂêéÈÄöËøá `CreateThread` ÊâßË°å„ÄÇ
   - Áº∫ÁÇπÔºöRWX ÂÜÖÂ≠òÊûÅÊòìË¢´Ê£ÄÊµã„ÄÇ

2. **ÂèçÂ∞ÑÂºè DLL Ê≥®ÂÖ•ÔºàReflective DLL InjectionÔºâ**  
   - È´òÁ∫ßÊäÄÊúØÔºöÂÆåÂÖ®Âú®ÂÜÖÂ≠ò‰∏≠ÂÆûÁé∞ PE Âä†ËΩΩÂÖ®ËøáÁ®ãÔºàÂàÜÈÖç„ÄÅÊò†Â∞Ñ„ÄÅÈáçÂÆö‰Ωç„ÄÅËß£ÊûêÂØºÂÖ•Ë°®Ôºâ„ÄÇ
   - **Êñá‰ª∂‰∏çËêΩÂú∞ÔºàFilelessÔºâ**ÔºöDLL ‰ªéÊú™ÂÜôÂÖ•Á£ÅÁõòÔºå‰ªÖÂ≠òÂú®‰∫éÂÜÖÂ≠òÔºåËßÑÈÅøÊñá‰ª∂Êâ´Êèè„ÄÇ
   - ‰∏çË∞ÉÁî® `LoadLibrary`ÔºåÈÅøÂÖçËß¶Âèë API Hook„ÄÇ

3. **Direct Syscall LoaderÔºà‰∏é `dinvk` È´òÂ∫¶Áõ∏ÂÖ≥Ôºâ**  
   - Ê†áÂáÜ APIÔºàÂ¶Ç `NtAllocateVirtualMemory`Ôºâ‰Ωç‰∫é `ntdll.dll`ÔºåËÄå EDR ‰ºöÂú®ÂÖ∂ÂÖ•Âè£Â§ÑÂÆâË£ÖÁî®Êà∑ÊÄÅ Hook„ÄÇ
   - `dinvk` ËøôÁ±ªÈ°πÁõÆÈÄöËøá **Áõ¥Êé•ÊâßË°å `syscall` Êåá‰ª§** Ë∞ÉÁî®ÂÜÖÊ†∏ÂáΩÊï∞ÔºåÁªïËøá `ntdll.dll`Ôºå‰ªéËÄåÈÅøÂºÄ Hook„ÄÇ
   - ÂÆûÁé∞ÁúüÊ≠£ÁöÑ‚ÄúÈùôÈªò‚ÄùÂÜÖÂ≠òÊìç‰Ωú„ÄÇ

---

### 3. ÁªìÂêà‰Ω†ÁöÑÈ°πÁõÆÔºà`dinvk`ÔºâÔºöÂä†ËΩΩÂô®ÁöÑÊ∑±Â∫¶ÂÆûÁé∞

Âú®Á∫¢ÈòüÂºÄÂèëËØ≠Â¢É‰∏ãÔºå‚ÄúÂÜô‰∏Ä‰∏™Âä†ËΩΩÂô®‚ÄùÊú¨Ë¥®‰∏äÊòØÂú® **ÊâãÂä®Ê®°Êãü Windows ÂÜÖÊ†∏Âä†ËΩΩ PE Êñá‰ª∂ÁöÑËøáÁ®ã**ÔºåÂç≥ **ÂèçÂ∞ÑÂºèÂä†ËΩΩÔºàReflective LoadingÔºâ** Êàñ **ÊâãÂä®Êò†Â∞ÑÔºàManual MappingÔºâ**„ÄÇ

‰ª•‰∏ãÊòØÂä†ËΩΩÂô®Â∑•‰ΩúÁöÑÊ†∏ÂøÉÊ≠•È™§‚Äî‚ÄîËøôÊ≠£ÊòØ‰Ω†ÁöÑ `module.rs` Âíå `syscall/` ÁõÆÂΩï‰∏ã‰ª£Á†ÅÊ≠£Âú®ÂÆûÁé∞ÁöÑÂÜÖÂÆπÔºö

#### Á¨¨‰∏ÄÊ≠•ÔºöËß£Êûê PE Â§¥ÔºàPE ParsingÔºâ

- ËØªÂèñ DOS Â§¥Ôºà`MZ`ÔºâÈ™åËØÅÊñá‰ª∂ÂêàÊ≥ïÊÄß„ÄÇ
- Ëß£Êûê NT Â§¥Ôºà`PE\0\0`ÔºâÔºåËé∑ÂèñÂÖ≥ÈîÆÂ≠óÊÆµÔºö
  - `ImageBase`ÔºöÊúüÊúõÂä†ËΩΩÂü∫ÂùÄ
  - `SizeOfImage`ÔºöÊâÄÈúÄËôöÊãüÂÜÖÂ≠òÂ§ßÂ∞è
  - `AddressOfEntryPoint`ÔºöÁ®ãÂ∫èÂÖ•Âè£ RVA
- ÈÅçÂéÜËäÇË°®ÔºàSection HeadersÔºâÔºåËé∑Âèñ `.text`, `.data`, `.rdata` Á≠âËäÇÁöÑÔºö
  - `VirtualAddress`ÔºàÂÜÖÂ≠òÂÅèÁßªÔºâ
  - `SizeOfRawData` / `Misc.VirtualSize`
  - `PointerToRawData`ÔºàÊñá‰ª∂ÂÅèÁßªÔºâ

> ‚ö†Ô∏è Ê≥®ÊÑèÔºöÁ£ÅÁõòÂØπÈΩêÔºàÈÄöÂ∏∏ 512BÔºâ‚â† ÂÜÖÂ≠òÂØπÈΩêÔºàÈÄöÂ∏∏ 4KBÔºâ„ÄÇ

#### Á¨¨‰∫åÊ≠•ÔºöÂÜÖÂ≠òÂàÜÈÖçÔºàAllocationÔºâ

- **Ê†áÂáÜÊñπÂºè**ÔºöË∞ÉÁî® `VirtualAlloc`
- **‰Ω†ÁöÑÂÅöÊ≥ïÔºà`dinvk`Ôºâ**ÔºöÈÄöËøá `syscall` Áõ¥Êé•Ë∞ÉÁî® `NtAllocateVirtualMemory`
  - Áî≥ËØ∑Â§ßÂ∞è = `SizeOfImage`
  - ÂàùÂßãÊùÉÈôê = `PAGE_READWRITE`ÔºàRWÔºâÔºå‰æø‰∫éÂÜôÂÖ•Êï∞ÊçÆ

#### Á¨¨‰∏âÊ≠•ÔºöÊò†Â∞ÑËäÇÔºàMapping SectionsÔºâ‚Äî‚ÄîÂÖ≥ÈîÆ

- ‰∏çËÉΩÁõ¥Êé• `memcpy` Êï¥‰∏™Êñá‰ª∂ÔºÅÂøÖÈ°ªÊåâËäÇÈÄê‰∏™Êò†Â∞Ñ„ÄÇ
- ÂØπÊØè‰∏™ËäÇÔºö
  - ‰ªéÊñá‰ª∂ÂÅèÁßª `PointerToRawData` ËØªÂèñÂéüÂßãÊï∞ÊçÆ
  - ÂÜôÂÖ•ÂÜÖÂ≠òÂü∫ÂùÄ + `VirtualAddress` Â§Ñ
- Êú™ÂàùÂßãÂåñÊï∞ÊçÆÔºàÂ¶Ç `.bss`ÔºâÈúÄÊòæÂºèÊ∏ÖÈõ∂

#### Á¨¨ÂõõÊ≠•ÔºöÂü∫ÂùÄÈáçÂÆö‰ΩçÔºàBase RelocationÔºâ

- **ÈóÆÈ¢ò**Ôºö‰ª£Á†Å‰∏≠ÂèØËÉΩÊúâÁ°¨ÁºñÁ†ÅÂú∞ÂùÄÔºàÂ¶Ç `CALL 0x180001050`ÔºâÔºå‰ΩÜÂÆûÈôÖÂä†ËΩΩÂú∞ÂùÄ ‚â† `ImageBase`
- **Ëß£ÂÜ≥**Ôºö
  1. ËÆ°ÁÆó Delta = ÂÆûÈôÖÂü∫ÂùÄ - `ImageBase`
  2. ÈÅçÂéÜ `.reloc` ËäÇ‰∏≠ÁöÑÈáçÂÆö‰ΩçÂùó
  3. ÂØπÊØè‰∏™ÈúÄË¶Å‰øÆÊ≠£ÁöÑÂú∞ÂùÄÔºàÈÄöÂ∏∏ÊòØ 64 ‰ΩçÊåáÈíàÔºâÔºåËØªÂèñÂéüÂÄºÔºåÂä†‰∏ä DeltaÔºåÂÜôÂõû
- Ê≥®ÊÑèÔºö64 ‰ΩçÁ®ãÂ∫èÂ§öÁî® RIP Áõ∏ÂØπÂØªÂùÄÔºåÈáçÂÆö‰ΩçÈ°πËæÉÂ∞ëÔºå‰ΩÜÂÖ®Â±ÄÂèòÈáè‰ªçÈúÄÂ§ÑÁêÜ

#### Á¨¨‰∫îÊ≠•ÔºöËß£ÊûêÂØºÂÖ•Ë°®ÔºàResolve Imports / IAT FixingÔºâ

- Payload ‰æùËµñ Windows APIÔºàÂ¶Ç `CreateFileW`Ôºâ
- **Ê†áÂáÜÊñπÂºè**Ôºö`LoadLibrary` + `GetProcAddress`
- **‰Ω†ÁöÑÈöêËîΩÊñπÂºèÔºà`dinvk`Ôºâ**Ôºö
  - ÈÅçÂéÜ PEB ‚Üí `Ldr.InMemoryOrderModuleList`ÔºåÊâæÂà∞Â∑≤Âä†ËΩΩÁöÑ `ntdll.dll`, `kernel32.dll` Á≠â
  - ÊâãÂä®Ëß£ÊûêÂÖ∂ÂØºÂá∫Ë°®ÔºàEATÔºâÔºåÊü•ÊâæÂáΩÊï∞ÂêçÂìàÂ∏åÊàñÂ≠óÁ¨¶‰∏≤ÂåπÈÖç
  - Â∞ÜÁúüÂÆûÂáΩÊï∞Âú∞ÂùÄÂ°´ÂÖ• Payload ÁöÑ IAT
- **‰ºòÂäø**ÔºöÂÆåÂÖ®‰∏çË∞ÉÁî®Ë¢´ÁõëÊéßÁöÑ APIÔºåÂÆûÁé∞‚ÄúÊó†Áóï‚ÄùËß£Êûê

#### Á¨¨ÂÖ≠Ê≠•ÔºöÊùÉÈôêÊúÄÁªàËÆæÁΩÆÔºàFinalize ProtectionsÔºâ

- ‰ΩøÁî® `NtProtectVirtualMemory`ÔºàÈÄöËøá syscallÔºâ‰øÆÊîπÂÜÖÂ≠òÊùÉÈôêÔºö
  - `.text` ‚Üí `PAGE_EXECUTE_READ`ÔºàRXÔºâ
  - `.data` / `.rdata` ‚Üí `PAGE_READWRITE`ÔºàRWÔºâÊàñ `PAGE_READONLY`
- **ÂÖ≥ÈîÆÂèçÊ£ÄÊµãÊäÄÂ∑ß**ÔºöÁªù‰∏ç‰ΩøÁî® `PAGE_EXECUTE_READWRITE`ÔºàRWXÔºâ

#### Á¨¨‰∏ÉÊ≠•ÔºöÊâßË°åÔºàExecutionÔºâ

- ËÆ°ÁÆóÂÆûÈôÖÂÖ•Âè£ÁÇπÔºö`ActualEntry = BaseAddress + AddressOfEntryPoint`
- ÂàõÂª∫Á∫øÁ®ãÔºöÈÄöËøá `NtCreateThreadEx`ÔºàsyscallÔºâÂêØÂä®Êñ∞Á∫øÁ®ã
- ÊàñÁõ¥Êé•Ë∑≥ËΩ¨Ôºö`jmp ActualEntry`ÔºàÈúÄÂ∞èÂøÉÊ†àÂíå‰∏ä‰∏ãÊñáÔºâ

---

### 4. È°πÁõÆÁªìÊûÑ‰∏éÂä†ËΩΩÂô®ÂäüËÉΩÁöÑÊò†Â∞Ñ

ÂõûÂà∞‰Ω†ÁöÑ `dinvk` È°πÁõÆÁõÆÂΩïÔºåÂêÑÊ®°ÂùóÁöÑËßíËâ≤Â¶Ç‰∏ãÔºö

| Êñá‰ª∂/Ê®°Âùó             | ÂØπÂ∫îÂä†ËΩΩÂô®ÂäüËÉΩ                          | ËØ¥Êòé |
|----------------------|----------------------------------------|------|
| `src/module.rs`       | PE Ëß£Êûê„ÄÅÈáçÂÆö‰Ωç„ÄÅÂØºÂÖ•Ë°®Ëß£Êûê            | ÂÆûÁé∞ÂèçÂ∞ÑÂºèÂä†ËΩΩÁöÑÊ†∏ÂøÉÈÄªËæëÔºåÂåÖÊã¨ EAT ÈÅçÂéÜ‰ª•Êõø‰ª£ `GetProcAddress` |
| `src/syscall/`        | Áõ¥Êé•Á≥ªÁªüË∞ÉÁî®Â∞ÅË£Ö                       | ÁªïËøá `ntdll.dll` HookÔºåÂÆâÂÖ®Ë∞ÉÁî® `NtAllocateVirtualMemory`„ÄÅ`NtProtectVirtualMemory` Á≠â |
| `src/winapis.rs`      | Windows ÂÜÖÈÉ®ÁªìÊûÑ‰ΩìÂÆö‰πâ                 | ÂÆö‰πâ `IMAGE_DOS_HEADER`„ÄÅ`LDR_DATA_TABLE_ENTRY`„ÄÅ`PEB` Á≠âÈùûÂÖ¨ÂºÄÁªìÊûÑ |
| `src/allocator.rs`    | Ëá™ÂÆö‰πâÂÜÖÂ≠òÂàÜÈÖçÁ≠ñÁï•                     | ÂèØËÉΩÁî®‰∫éÈöîÁ¶ª Payload Â†ÜÂÜÖÂ≠òÔºåÈÅøÂÖçÊ∑∑ÂÖ•ÈªòËÆ§ËøõÁ®ãÂ†Ü |

---

### 5. ‰∏∫‰ªÄ‰πàËøôË¢´Áß∞‰∏∫ ‚ÄúRedOps‚ÄùÔºü

ÊôÆÈÄöËΩØ‰ª∂ÂºÄÂèëÊó†ÈúÄÂ¶ÇÊ≠§Â§çÊùÇ‚Äî‚ÄîÁõ¥Êé• `std::process::Command::new("app.exe")` Âç≥ÂèØ„ÄÇ

‰ΩÜÁ∫¢ÈòüÂú∫ÊôØ‰∏ãÔºå‰Ω†ÂøÖÈ°ªËøô‰πàÂÅöÔºåÂõ†‰∏∫Ôºö

1. **Êñá‰ª∂‰∏çËêΩÂú∞ÔºàFilelessÔºâ**  
   Payload ÂèØÂä†ÂØÜÂµåÂÖ•ËµÑÊ∫ê„ÄÅ‰ªéÁΩëÁªú‰∏ãËΩΩ„ÄÅÊàñÁ°¨ÁºñÁ†ÅÂú®‰∫åËøõÂà∂‰∏≠ÔºåÂÖ®Á®ã‰∏çÂÜôÁ£ÅÁõòÔºåËßÑÈÅø‰º†Áªü AV„ÄÇ

2. **ËßÑÈÅøÈí©Â≠êÔºàUnhooking / BypassingÔºâ**  
   ÈÄöËøá Direct Syscall ÁªïËøá EDR Âú®Áî®Êà∑ÊÄÅ DLL ‰∏≠ÁöÑ HookÔºåÂÆûÁé∞‚ÄúÂπ≤ÂáÄ‚ÄùÁöÑÂÜÖÊ†∏Ë∞ÉÁî®„ÄÇ

3. **ÂÜÖÂ≠ò‰º™Ë£ÖÔºàObfuscationÔºâ**  
   ÊéßÂà∂ÂÜÖÂ≠òÂ∏ÉÂ±Ä„ÄÅÊùÉÈôê„ÄÅÂÜÖÂÆπÔºå‰Ωø Payload Âú®ÂÜÖÂ≠ò‰∏≠ÁúãËµ∑Êù•ÂÉèÊôÆÈÄöÊï∞ÊçÆÔºå‰ªÖÂú®ÊâßË°åÁû¨Èó¥ÊøÄÊ¥ª„ÄÇ

---

> **ÊÄªÁªì**Ôºö  
> ÂØπ‰∫é‰Ω†ÁöÑ `dinvk` È°πÁõÆËÄåË®ÄÔºå**Âä†ËΩΩÂô®Â∞±ÊòØ‰∏Ä‰∏™Áî±‰Ω†ÁºñÂÜôÁöÑ Rust Á®ãÂ∫èÔºåÂÆÉÊâãÂä®Ëß£Êûê PE Êñá‰ª∂ÁªìÊûÑÔºå‰ΩøÁî®Áõ¥Êé•Á≥ªÁªüË∞ÉÁî®ÔºàDirect SyscallsÔºâÁî≥ËØ∑ÂÜÖÂ≠òÂπ∂ÂÜôÂÖ•‰ª£Á†ÅÔºåÊúÄÂêéÂú®‰∏çË¢´ EDR ÂØüËßâÁöÑÊÉÖÂÜµ‰∏ãÊâßË°åÁõÆÊ†á Payload„ÄÇ**  
> ‰Ω†Áé∞Âú®‰∏çÊòØÂú®ÂÜôÂ∫îÁî®ÔºåËÄåÊòØÂú®ÊâìÈÄ†‰∏ÄËæÜ‚ÄúÈöêÂΩ¢ÊàòËΩ¶‚ÄùÁöÑÂºïÊìé‚Äî‚ÄîÈùôÈªò„ÄÅÁ≤æÂáÜ„ÄÅÁ©øÈÄèÈò≤Âæ°„ÄÇ

## Ê≠§È°πÁõÆÊâæDLL Âü∫ÂùÄÁöÑÂéüÁêÜ

ÈÅçÂéÜÊ®°ÂùóÈìæË°®‰ª•Ëé∑ÂèñÂü∫ÂùÄÁöÑÊ†∏ÂøÉÊµÅÁ®ãÂ¶Ç‰∏ãÔºö

1. **Ëé∑Âèñ PEB**  
   - x64: `gs:[0x60]`
   - x86: `fs:[0x30]`

2. **ËøõÂÖ•Âä†ËΩΩÂô®Êï∞ÊçÆ**  
   ‰ªé PEB ËØªÂèñ `Ldr` Â≠óÊÆµÔºåÂæóÂà∞ `PEB_LDR_DATA*`„ÄÇ

3. **ÈÄâÊã©ÈìæË°®**  
   ÈÄöÂ∏∏‰ΩøÁî® `InMemoryOrderModuleList`„ÄÇ

4. **ÈÅçÂéÜÈìæË°®**  
   - ‰ªé `Flink` Ëé∑Âèñ‰∏ã‰∏Ä‰∏™ËäÇÁÇπÂú∞ÂùÄÔºàËØ•Âú∞ÂùÄ = ÁõÆÊ†á `LDR_DATA_TABLE_ENTRY` ÁöÑ `InMemoryOrderLinks` Âú∞ÂùÄÔºâ„ÄÇ
   - Âà©Áî®‚ÄúÈîô‰ΩçÊåáÈíà‚ÄùÊäÄÂ∑ßÔºåÂ∞ÜËØ•Âú∞ÂùÄ**Âº∫Âà∂ËßÜ‰∏∫** `LDR_DATA_TABLE_ENTRY*`„ÄÇ
   - ËÆøÈóÆÁªìÊûÑ‰ΩìÂ≠óÊÆµÔºàÂ¶Ç `Reserved2[0]` ÂÆûÈôÖËØªÂèñÁöÑÊòØ `DllBase`Ôºâ„ÄÇ
   - ÊØîÂØπ `FullDllName` Êàñ `BaseDllName` ÊòØÂê¶‰∏∫ÁõÆÊ†á DLL„ÄÇ
   - Ëã•ÂåπÈÖçÔºåËøîÂõû `DllBase` ‚Äî‚Äî Âç≥ËØ• DLL ÁöÑÂÜÖÂ≠òÂü∫ÂùÄ„ÄÇ

> ‚úÖ ËøôÁßçÊñπÊ≥ïÁªïËøá‰∫Ü `GetModuleHandle` Á≠â APIÔºåÂÖ∑ÊúâÈöêËîΩÊÄßÔºåÂ∏∏Áî®‰∫éÂÖçÊùÄÊàñÂ∫ïÂ±ÇÂ∑•ÂÖ∑ÂºÄÂèë„ÄÇ

## TEB

## PEÂíåPEBÁöÑ‰∏âÂ§ßÊ†∏ÂøÉËÅîÁ≥ª

### ËÅîÁ≥ª‰∏Ä:ÂÆö‰Ωç‰∏ªÊ®°ÂùóÂü∫ÂùÄ (PEB.ImageBaseAddress)

ËøôÊòØÊúÄÁõ¥Êé•ÁöÑËÅîÁ≥ª„ÄÇ

- PE Â±ÇÈù¢: PE Êñá‰ª∂ÁöÑ OptionalHeader.ImageBase Âè™ÊòØ‰∏Ä‰∏™Âª∫ËÆÆÂú∞ÂùÄÔºà‰æãÂ¶Ç0x140000000Ôºâ„ÄÇ
- ËøêË°åÊó∂: Áî±‰∫é ASLRÔºàÂú∞ÂùÄÁ©∫Èó¥Â∏ÉÂ±ÄÈöèÊú∫ÂåñÔºâÔºåPE Êñá‰ª∂ÂÆûÈôÖ‰∏äÂèØËÉΩË¢´Âä†ËΩΩÂà∞‰ªªÊÑèÂú∞ÂùÄÔºà‰æãÂ¶Ç0x7FF712340000Ôºâ„ÄÇ
- PEB Â±ÇÈù¢: PEB.ImageBaseAddress Â≠òÂÇ®‰∫ÜÊúÄÁªàÂÆûÈôÖÂä†ËΩΩÁöÑÂü∫ÂùÄ„ÄÇ

Êìç‰ΩúÈÄªËæë:  
Á®ãÂ∫èÈÄöËøáËØªÂèñ PEB.ImageBaseAddressÔºåÂæóÂà∞‰∫ÜÂÜÖÂ≠ò‰∏≠ PE Êñá‰ª∂ÁöÑÂ§¥ÈÉ®ÔºàDOS
HeaderÔºâÂú∞ÂùÄÔºå‰ªéËÄåÂºÄÂßãËß£ÊûêÊï¥‰∏™ PE ÁªìÊûÑ„ÄÇ

### ËÅîÁ≥ª‰∫å:ÁÆ°ÁêÜÊâÄÊúâÂä†ËΩΩÁöÑ PE Ê®°Âùó (PEB.Ldr)

‰∏Ä‰∏™ËøõÁ®ãÈÄöÂ∏∏Áî±Â§ö‰∏™ PE Êñá‰ª∂ÁªÑÊàêÔºà1 ‰∏™ EXE + N ‰∏™ DLLÔºâ„ÄÇPEB ÈÄöËøá Ldr Â≠óÊÆµÁª¥Êä§Ëøô‰∫õ PE Êñá‰ª∂ÁöÑÈìæË°®„ÄÇ

```rust
// src/types.rs
pub struct PEB_LDR_DATA {
    // ...
    pub InLoadOrderModuleList: LIST_ENTRY,
    pub InMemoryOrderModuleList: LIST_ENTRY,
    // ...
}

pub struct LDR_DATA_TABLE_ENTRY {
    // ...
    pub DllBase: *mut c_void,      // ÊåáÂêëËØ•Ê®°Âùó PE Â§¥ÈÉ®ÁöÑÊåáÈíà
    pub FullDllName: UNICODE_STRING,
    // ...
}
```

1. **ËÆøÈóÆ `PEB.Ldr`**  
   Ëé∑ÂèñÂΩìÂâçËøõÁ®ãÁöÑ `PEB_LDR_DATA` ÁªìÊûÑ„ÄÇ
2. **ÈÅçÂéÜ `InMemoryOrderModuleList`**  
   ËØ•ÂèåÂêëÈìæË°®ÊåâÊ®°ÂùóÂú®ÂÜÖÂ≠ò‰∏≠ÁöÑÂ∏ÉÂ±ÄÈ°∫Â∫èÁªÑÁªá„ÄÇ
3. **ÊØè‰∏™ËäÇÁÇπÊòØ‰∏Ä‰∏™ `LDR_DATA_TABLE_ENTRY`**  
   ÊèèËø∞‰∏Ä‰∏™Â∑≤Âä†ËΩΩÁöÑ PE Ê®°ÂùóÔºàEXE Êàñ DLLÔºâ„ÄÇ
4. **ËØªÂèñ `DllBase` Â≠óÊÆµ**  
   ÂæóÂà∞ËØ•Ê®°ÂùóÂú®ËøõÁ®ãÂú∞ÂùÄÁ©∫Èó¥‰∏≠ÁöÑÂü∫Âú∞ÂùÄ„ÄÇ
5. **`DllBase` Âç≥‰∏∫ `IMAGE_DOS_HEADER` ÁöÑÂú∞ÂùÄ**  
   ÂèØ‰ªéÊ≠§Â§ÑÂºÄÂßãËß£ÊûêÂÆåÊï¥ÁöÑ PE ÁªìÊûÑ„ÄÇ
6. **Ëß£ÊûêÂØºÂá∫Ë°®‰ª•Ëé∑ÂèñÂáΩÊï∞Âú∞ÂùÄ**  
   ‰æãÂ¶ÇÔºåÂèØÊâãÂä®ÂÆö‰Ωç `kernel32!LoadLibraryA` ÁöÑËøêË°åÊó∂Âú∞ÂùÄ„ÄÇ

### ËÅîÁ≥ª‰∏â: Êï∞ÊçÆÁõÆÂΩïÁöÑËøêË°åÊó∂ËÆøÈóÆÔºàData DirectoriesÔºâ

PE Êñá‰ª∂‰∏≠ÁöÑ **Êï∞ÊçÆÁõÆÂΩï**ÔºàÂ¶ÇÂØºÂá∫Ë°®„ÄÅÂØºÂÖ•Ë°®„ÄÅËµÑÊ∫êË°®Á≠âÔºâ‰ΩøÁî®ÁöÑÊòØ **RVA**ÔºàRelative Virtual AddressÔºåÁõ∏ÂØπËôöÊãüÂú∞ÂùÄÔºâ„ÄÇ

> ‚ö†Ô∏è RVA ‰ªÖÊòØ‰∏Ä‰∏™ÂÅèÁßªÈáèÔºå‰∏çËÉΩÁõ¥Êé•Áî®‰∫éÂÜÖÂ≠òËÆøÈóÆ„ÄÇÂøÖÈ°ªÁªìÂêàÊ®°ÂùóÂü∫ÂùÄËΩ¨Êç¢‰∏∫ **VA**ÔºàVirtual AddressÔºâ„ÄÇ

Âú∞ÂùÄËΩ¨Êç¢ÂÖ¨ÂºèÔºö  
> **VA = Ê®°ÂùóÂü∫ÂùÄÔºàÊù•Ëá™ PEB/LdrÔºâ + RVAÔºàÊù•Ëá™ PE Â§¥Ôºâ**

Á§∫‰æãÂú∫ÊôØÔºöÊâãÂä®Êü•ÊâæÂØºÂá∫ÂáΩÊï∞Âú∞ÂùÄ

1. **ÈÄöËøá PEB ÂÆö‰ΩçÊ®°Âùó**  
   ÈÅçÂéÜ `PEB.Ldr` ÊâæÂà∞ `kernel32.dll` ÁöÑÂü∫ÂùÄ `base_addr`„ÄÇ
2. **ÂÆö‰Ωç NT Â§¥**  
   ‰ªé `base_addr` ËØªÂèñ `IMAGE_DOS_HEADER`ÔºåÈÄöËøá `e_lfanew` Â≠óÊÆµË∑≥ËΩ¨Âà∞ `IMAGE_NT_HEADERS`„ÄÇ
3. **Ëé∑ÂèñÂØºÂá∫Ë°® RVA**  
   ËØªÂèñ `OptionalHeader.DataDirectory[0]`ÔºàÁ¥¢Âºï 0 ÂØπÂ∫îÂØºÂá∫Ë°®ÔºâÔºåÂæóÂà∞ `export_rva`„ÄÇ
4. **ËÆ°ÁÆóÂØºÂá∫Ë°®ÁúüÂÆûÂú∞ÂùÄ**  
   `export_table_va = base_addr + export_rva`
5. **Ëß£ÊûêÂØºÂá∫Ë°®**  
   ÈÅçÂéÜÂáΩÊï∞ÂêçÊï∞ÁªÑÔºåÂåπÈÖçÁõÆÊ†áÂáΩÊï∞ÔºàÂ¶Ç `"LoadLibraryA"`ÔºâÔºåËé∑ÂèñÂÖ∂ `function_rva`„ÄÇ
6. **ËÆ°ÁÆóÂáΩÊï∞ÊúÄÁªàÂú∞ÂùÄ**  
   `function_address = base_addr + function_rva`

> ‚úÖ **ÁªìËÆ∫**Ôºö  
> **PEB ÊòØÂä®ÊÄÅÁöÑÂú∞Âõæ**ÔºåÊåáÂºï‰Ω†Âú®ËøõÁ®ãÂÜÖÂ≠ò‰∏≠ÂÆö‰ΩçÊØè‰∏Ä‰∏™ÈùôÊÄÅÁöÑ PE Êñá‰ª∂Âùó„ÄÇ  
> Ê≤°Êúâ PEBÔºåÂÜÖÂ≠ò‰∏≠ÁöÑ PE Ê®°ÂùóÂ∞±Â¶ÇÂêåÊ≤°ÊúâÁ¥¢ÂºïÁöÑÂõæ‰π¶È¶Ü‰π¶Á±ç‚Äî‚ÄîÂ≠òÂú®Âç¥Êó†Ê≥ïÈ´òÊïà‰ΩøÁî®„ÄÇ

## PE

PE (Portable Executable) Âíå PEB (Process Environment Block) ÊòØ WindowsÊìç‰ΩúÁ≥ªÁªü‰∏≠‰∏§‰∏™Ê†∏ÂøÉÊ¶ÇÂøµÔºåÂÆÉ‰ª¨ÂàÜÂà´‰ª£Ë°®‰∫ÜÁ®ãÂ∫èÁöÑÈùôÊÄÅÂ≠òÂÇ®ÂΩ¢ÊÄÅÂíåÂä®ÊÄÅËøêË°åÂΩ¢ÊÄÅ„ÄÇ  
PEB ËÆ∞ÂΩï‰∫Ü PE Êñá‰ª∂Ë¢´Âä†ËΩΩÂà∞ÂÜÖÂ≠òÂêéÁöÑÂÖ≥ÈîÆ‰ø°ÊÅØÔºåÊòØËÆøÈóÆÂíåËß£ÊûêÂÜÖÂ≠ò‰∏≠PE ÁªìÊûÑÁöÑÂÖ•Âè£„ÄÇ

PE Êñá‰ª∂Êú¨Ë¥®‰∏äÊòØ **‚ÄúÁ∫øÊÄßÂ≠òÂÇ®ÁöÑÊï∞ÊçÆÁªìÊûÑÈõÜÂêà‚Äù**„ÄÇÂú®Á£ÅÁõò‰∏äÂíåÂú®ÂÜÖÂ≠ò‰∏≠ÔºåÂÆÉ‰ª¨ÁöÑÈÄªËæëÈ°∫Â∫è‰∏ÄËá¥Ôºå‰ΩÜÁâ©ÁêÜÈó¥Ë∑ùÔºàÂØπÈΩêÔºâ‰∏çÂêå„ÄÇ  
PE ÊòØ Windows ÂèØÊâßË°åÊñá‰ª∂Ôºà.exe, .dll,.sysÔºâÁöÑÊ†áÂáÜÊ†ºÂºè„ÄÇÂÆÉÊèèËø∞‰∫Ü‰ª£Á†Å„ÄÅÊï∞ÊçÆ„ÄÅËµÑÊ∫êÂú®Êñá‰ª∂‰∏≠Â¶Ç‰ΩïÁªÑÁªáÔºå‰ª•ÂèäÂä†ËΩΩÂà∞ÂÜÖÂ≠òÊó∂Â∫îËØ•Â¶Ç‰ΩïÊò†Â∞Ñ„ÄÇ

Âú®Êú¨È°πÁõÆ‰∏≠ÔºåË∞ÉÁî®Á≥ªÁªüË∞ÉÁî®ÔºàsyscallÔºâÊàñÂÖ≥ÈîÆ API ÁöÑËøáÁ®ãÊòØÁ∫ØÊâãÂä®ÁöÑÔºå‰∏ç‰æùËµñÊìç‰ΩúÁ≥ªÁªüÊèê‰æõÁöÑÊ†áÂáÜÂä†ËΩΩÂô®ÔºàLoaderÔºâÂäüËÉΩ„ÄÇ  

1. ÂÆö‰πâÊï∞ÊçÆÁªìÊûÑÔºàMappingÔºâÔºö
      Rust ‰ª£Á†ÅÂú® src/types.rs ‰∏≠‰ΩøÁî® #[repr(C)] Á≤æÁ°ÆÂ§çÂàª‰∫Ü Windows PE
  Êñá‰ª∂ÁöÑÂÜÖÂ≠òÂ∏ÉÂ±Ä„ÄÇËøôÊÑèÂë≥ÁùÄ Rust ÁªìÊûÑ‰ΩìÁöÑÂÜÖÂ≠òÂàÜÂ∏É‰∏é Windows
  ÂÜÖÊ†∏ÂíåÁ°¨‰ª∂ÁúãÂà∞ÁöÑ‰∫åËøõÂà∂Êï∞ÊçÆÂÆåÂÖ®‰∏ÄËá¥„ÄÇ

   1. Ëé∑ÂèñÂü∫ÂùÄÔºàBase AddressÔºâÔºö
      ‰ª£Á†ÅÈ¶ñÂÖàÈÄöËøáËØªÂèñ TEB (Thread Environment Block) -> PEB (Process Environment Block) -> Ldr (Loader Data) ÈìæË°®ÔºåÊâæÂà∞ÁõÆÊ†áÊ®°ÂùóÔºàÈÄöÂ∏∏ÊòØntdll.dll Êàñ kernel32.dllÔºâÂú®ÂÜÖÂ≠ò‰∏≠ÁöÑËµ∑ÂßãÂú∞ÂùÄÔºàDllBaseÔºâ„ÄÇ

   2. Ëß£Êûê PE ÁªìÊûÑÔºàParsingÔºâÔºö
      Âà©Áî®Á¨¨ 1 Ê≠•ÂÆö‰πâÁöÑÁªìÊûÑ‰ΩìÔºå‰ª£Á†ÅÂ∞ÜËøô‰∏™Âü∫ÂùÄÂº∫ËΩ¨‰∏∫ *const
  IMAGE_DOS_HEADER ÊåáÈíàÔºåÈÄöËøá e_lfanew ÊâæÂà∞ IMAGE_NT_HEADERSÔºåÂÜçËÆøÈóÆ
  OptionalHeader.DataDirectory ÊâæÂà∞ ÂØºÂá∫Ë°® (Export Directory)„ÄÇ

   3. Êü•ÊâæÂáΩÊï∞ÔºàResolutionÔºâÔºö
      ÈÅçÂéÜÂØºÂá∫Ë°®‰∏≠ÁöÑÂáΩÊï∞ÂêçÁß∞Êï∞ÁªÑÔºàAddressOfNamesÔºâÔºåÊâæÂà∞ÁõÆÊ†áÂáΩÊï∞Ôºà‰æãÂ¶ÇNtAllocateVirtualMemory Êàñ LoadLibraryAÔºâ„ÄÇ

   4. Ëé∑ÂèñÂú∞ÂùÄÊàñ SSNÔºàExtractionÔºâÔºö
       - ÂØπ‰∫é API
         Ë∞ÉÁî®Ôºö‰ªéÂØºÂá∫Ë°®‰∏≠Ëé∑ÂèñËØ•ÂáΩÊï∞ÁöÑÂÜÖÂ≠òÂú∞ÂùÄÔºåÂ∞ÜÂÖ∂Âº∫ËΩ¨‰∏∫ÂáΩÊï∞ÊåáÈíàÔºàÂ¶Ç
         LoadLibraryAFnÔºâÂπ∂Áõ¥Êé•Ë∞ÉÁî®„ÄÇ
       - ÂØπ‰∫é SyscallÔºöËß£Êûê ntdll.dll ‰∏≠ÂØπÂ∫îÂáΩÊï∞ÁöÑÊ±áÁºñ‰ª£Á†ÅÔºàÈÄöÂ∏∏ÊòØ mov eax, SSN; syscallÔºâÔºåÊèêÂèñÂá∫ SSN (System Service Number)„ÄÇ

   5. ÊâßË°åË∞ÉÁî®ÔºàExecutionÔºâÔºö
      ‰ΩøÁî®ÂÜÖËÅîÊ±áÁºñÔºàasm!ÔºâÁõ¥Êé•ÊâßË°å syscall Êåá‰ª§Ôºà‰º†ÂÖ•ÊèêÂèñÂá∫ÁöÑ
  SSNÔºâÔºåÊàñËÄÖË∑≥ËΩ¨Âà∞Ëé∑ÂèñÂà∞ÁöÑ API ÂáΩÊï∞Âú∞ÂùÄÊâßË°å„ÄÇ

  Ê†∏ÂøÉÊÑè‰πâÔºö
  Ëøô‰∏™ËøáÁ®ãÂÆåÂÖ®ÁªïËøá‰∫Ü Windows ÁöÑ GetProcAddress Âíå GetModuleHandle Á≠âÊ†áÂáÜAPI„ÄÇËøôÊ†∑ÂÅö‰ΩøÂæóÂÆâÂÖ®ËΩØ‰ª∂ÔºàEDR/AVÔºâÈöæ‰ª•ÈÄöËøáÈÄöËøáÊåÇÈí©ÔºàHookÔºâÊ†áÂáÜ APIÊù•ÁõëÊéß‰Ω†ÁöÑË°å‰∏∫Ôºå‰ªéËÄåÂÆûÁé∞ÈöêËîΩË∞ÉÁî®„ÄÇ  
  Êú¨È°πÁõÆ‰∏≠‰ΩøÁî®rustË°®Á§∫‰∫ÜpeÊñá‰ª∂ÂêÑ‰∏™Â≠óÊÆµÁöÑÁªìÊûÑ,ÈúÄË¶ÅË∞ÉÁî®syscallÊó∂,‰ºöÈÄöËøáËøô‰∫õÂÆö‰πâÁöÑÊï∞ÊçÆÁªìÊûÑ,Êù•Ëé∑ÂèñÁõ∏ÂÖ≥‰ø°ÊÅØ  

### Êú¨È°πÁõÆÊ≤°ÊúâÂÆö‰πâ‰∏Ä‰∏™ÊääÊâÄÊúâÂ≠óÊÆµÊâìÂåÖÂú®‰∏ÄËµ∑ÁöÑÂçï‰∏Ä `PE`ÁªìÊûÑ‰ΩìÔºü

‰∏ªË¶ÅÂéüÂõ†Âú®‰∫éÔºöPE Êñá‰ª∂Âú®Á£ÅÁõò‰∏äÁöÑÂΩ¢ÊÄÅÔºàFile AlignmentÔºâ‰∏éÂú®ÂÜÖÂ≠ò‰∏≠ÁöÑÂΩ¢ÊÄÅÔºàSection AlignmentÔºâÊòØ‰∏ç‰∏ÄËá¥ÁöÑ„ÄÇ  
Âõ†‰∏∫Êï∞ÊçÆÂú®Âä†ËΩΩÂêé‰ΩçÁΩÆÂèò‰∫ÜÔºå‰Ω†Êó†Ê≥ïÁî®‰∏Ä‰∏™ËøûÁª≠ÁöÑ Rust/CÁªìÊûÑ‰ΩìÊù•‚ÄúÂ•ó‚Äù‰ΩèÊï¥‰∏™ÂÜÖÂ≠òÊàñÁ£ÅÁõò‰∏äÁöÑ PE Êñá‰ª∂

#### dinvk ÁöÑÂÅöÊ≥ïÔºöÈÄöËøáÊåáÈíàÂíåÂÅèÁßªÈáèËÆøÈóÆ

Ê≠£Âõ†‰∏∫‰∏çËÉΩÁî®‰∏Ä‰∏™Â§ßÁªìÊûÑ‰ΩìË°®Á§∫ÔºådinvkÈááÁî®ÁöÑÊòØÂü∫‰∫éÊåáÈíàÁöÑËß£ÊûêÊñπÂºè„ÄÇËøô‰πüÊòØÊìç‰ΩúÁ≥ªÁªüÂíåË∞ÉËØïÂô®ÁöÑÊ†áÂáÜÂÅöÊ≥ï„ÄÇ

Ê≤°Êúâ struct PE ÊòØÂõ†‰∏∫ PE‰∏çÊòØ‰∏Ä‰∏™ÈùôÊÄÅÁöÑËøûÁª≠Êï∞ÊçÆÂùóÔºåËÄåÊòØ‰∏Ä‰∏™ËìùÂõæ„ÄÇÊ†πÊçÆËøô‰∏™ËìùÂõæÔºåÊñá‰ª∂Ë¢´‚ÄúÊãÜÊï£‚ÄùÂπ∂‚ÄúÈáçÁªÑ‚ÄùÂà∞‰∫ÜÂÜÖÂ≠ò‰∏≠„ÄÇÂõ†Ê≠§Ôºå‰ΩøÁî®Â§ö‰∏™Â∞èÁöÑ Header ÁªìÊûÑ‰Ωì + ÊåáÈíàÁÆóÊúØÊòØÂ§ÑÁêÜ PE Êñá‰ª∂ÁöÑÂîØ‰∏ÄÊ≠£Á°ÆÊñπÂºè„ÄÇ

### PE (Memory Layout)

ÂÅáËÆæÂÜÖÂ≠òÂú∞ÂùÄ‰ªé‰ΩéÂà∞È´òÂêë‰∏ãÂ¢ûÈïøÔºö

```text
Âü∫Âú∞ÂùÄ (ImageBase) ----> +-----------------------------+
                        |      MS-DOS Header          |  <- "MZ" Â§¥
                        +-----------------------------+
                        |       MS-DOS Stub           |  <- ÂéÜÂè≤ÈÅóÁïôÂ∫üËØù
                        +-----------------------------+
ntHeaders ÊåáÈíà -------->|      PE Signature           |  <- "PE\0\0"
(DOS.e_lfanew)          +-----------------------------+
                        |    IMAGE_FILE_HEADER        |  <- Áâ©ÁêÜÊ¶ÇÂÜµ (CPUÊû∂ÊûÑ, ËäÇÊï∞Èáè)
                        +-----------------------------+
                        | IMAGE_OPTIONAL_HEADER (64)  |  <- ÈÄªËæëÊ†∏ÂøÉ (OEP, ImageBase)
                        |                             |
                        |   [ Data Directories ]      |  <- *ÂÖ≥ÈîÆÊï∞ÁªÑ* (ÂØºÂá∫Ë°®/ÂØºÂÖ•Ë°®Á¥¢Âºï)
                        +-----------------------------+
SectionHeaders ÊåáÈíà --->|   IMAGE_SECTION_HEADER [0]  |  <- .text ÁöÑÊèèËø∞‰ø°ÊÅØ
                        |   IMAGE_SECTION_HEADER [1]  |  <- .rdata ÁöÑÊèèËø∞‰ø°ÊÅØ
                        |   ...                       |
                        +-----------------------------+
                        |         (Â°´ÂÖÖ/Padding)      |  <- ÂØπÈΩêÈó¥Èöô
                        +=============================+
                        |        Section .text        |  <- ÁúüÊ≠£ÁöÑ‰ª£Á†Å
                        +-----------------------------+
                        |        Section .rdata       |  <- Â∏∏Èáè/ÂØºÂÖ•Ë°®Êï∞ÊçÆ
                        +-----------------------------+
                        |        Section .data        |  <- ÂÖ®Â±ÄÂèòÈáè
                        +-----------------------------+
                        |        Section .reloc       |  <- ÈáçÂÆö‰ΩçÊï∞ÊçÆ
                        +-----------------------------+
```

### PEÊñá‰ª∂ÁªìÊûÑ

‰∏∫‰∫ÜÈÅøÂÖç‰æùËµñÂ∫ûÂ§ßÁöÑ windows-sys Êàñ winapi crateÔºåÈÄâÊã©ÊâãÂä®ÂÆö‰πâ‰∫ÜËøô‰∫õÂ∫ïÂ±ÇÁªìÊûÑ„ÄÇËøôÁßçÂÅöÊ≥ïÂú®ÊÅ∂ÊÑèËΩØ‰ª∂ÂºÄÂèëÊàñÁ∫¢ÈòüÂ∑•ÂÖ∑ÔºàÂ¶Ç‰Ω†Ê≠£Âú®ÂºÄÂèëÁöÑRustRedOpsÔºâ‰∏≠ÈùûÂ∏∏Â∏∏ËßÅÔºåÁõÆÁöÑÊòØ‰∏∫‰∫ÜÂáèÂ∞ëÁâπÂæÅÊåáÁ∫π„ÄÅÂáèÂ∞è‰∫åËøõÂà∂‰ΩìÁßØ‰ª•ÂèäÊã•ÊúâÊõ¥Á≤æÁªÜÁöÑÊéßÂà∂ÊùÉ„ÄÇ

#### PE Êñá‰ª∂ÁªìÊûÑËØ¶Ëß£ÔºöÂü∫‰∫é `dinvk` È°πÁõÆ‰∏≠ÁöÑÊï∞ÊçÆÁªìÊûÑ

PEÔºàPortable ExecutableÔºâÊòØ Windows Á≥ªÁªü‰∏ãÂèØÊâßË°åÊñá‰ª∂ÔºàEXEÔºâ„ÄÅÂä®ÊÄÅÈìæÊé•Â∫ìÔºàDLLÔºâ„ÄÅÈ©±Âä®ÔºàSYSÔºâÁ≠âÁöÑÊ†áÂáÜÊ†ºÂºè„ÄÇÊú¨Êñá‰ª•ÂºÄÊ∫êÈ°πÁõÆ **`dinvk`** ‰∏≠ `src/types.rs` ÂÆö‰πâÁöÑ Rust ÁªìÊûÑ‰Ωì‰∏∫ËìùÊú¨Ôºå**‰ªéÁ£ÅÁõòÊñá‰ª∂ÂÅèÁßª 0 ÂºÄÂßã**ÔºåÈÄêÂ≠óÊÆµ„ÄÅÈÄêÁªìÊûÑÂú∞ËØ¶ÁªÜËß£Èáä PE Êñá‰ª∂‰∏≠ÊØè‰∏Ä‰∏™Â≠óÊÆµÁöÑÂê´‰πâ‰∏é‰ΩúÁî®„ÄÇ

---

#### Á¨¨‰∏ÄÈÉ®ÂàÜÔºöDOS HeaderÔºàÂÖºÂÆπÊÄßÂ§¥ÈÉ®Ôºâ

‰Ωç‰∫éÊñá‰ª∂Ëµ∑Âßã‰ΩçÁΩÆÔºà**Offset 0**ÔºâÔºåÂÖ± 64 Â≠óËäÇÔºà0x40Ôºâ„ÄÇÂÖ∂Â≠òÂú®ÊòØ‰∏∫‰∫ÜÂêëÂêéÂÖºÂÆπ MS-DOS Á≥ªÁªü„ÄÇ

```rust
#[repr(C, packed(2))]
pub struct IMAGE_DOS_HEADER {
    pub e_magic: u16,    // [0x00] È≠îÊï∞ "MZ" (0x5A4D)
                         // Ê†áËØÜËøôÊòØ‰∏Ä‰∏™ DOS ÂèØÊâßË°åÊñá‰ª∂„ÄÇ
                         // Windows Âä†ËΩΩÂô®È¶ñÂÖàÊ£ÄÊü•Ê≠§ÂÄºÔºåÈùû MZ ÂàôÊãíÁªùÂä†ËΩΩ„ÄÇ

    pub e_cblp: u16,     // [0x02] Êñá‰ª∂ÊúÄÂêé‰∏ÄÈ°µ‰∏≠ÁöÑÂ≠óËäÇÊï∞Ôºà< 512Ôºâ
                         // DOS Êó∂‰ª£Áî®‰∫éËÆ°ÁÆóÂÆûÈôÖÊñá‰ª∂Â§ßÂ∞èÔºåÁé∞‰ª£ÂøΩÁï•„ÄÇ

    pub e_cp: u16,       // [0x04] Êñá‰ª∂ÊÄªÈ°µÊï∞ÔºàÊØèÈ°µ 512 Â≠óËäÇÔºâ
                         // ÂÆûÈôÖÂ§ßÂ∞è ‚âà (e_cp - 1) * 512 + e_cblp

    pub e_crlc: u16,     // [0x06] ÈáçÂÆö‰ΩçÈ°πÊï∞Èáè
                         // DOS Á®ãÂ∫èÂä†ËΩΩÊó∂ÈúÄÊ†πÊçÆÊ≠§‰øÆÊ≠£Âú∞ÂùÄÔºåPE Êñá‰ª∂‰∏≠ÈÄöÂ∏∏‰∏∫ 0„ÄÇ

    pub e_cparhdr: u16,  // [0x08] Â§¥ÈÉ®Â§ßÂ∞èÔºà‰ª• 16 Â≠óËäÇ‚ÄúÊÆµ‚Äù‰∏∫Âçï‰ΩçÔºâ
                         // Âç≥ DOS Â§¥ + DOS Stub ÁöÑÊÄªÊÆµÊï∞„ÄÇ‰æãÂ¶ÇÂÄº‰∏∫ 4 Ë°®Á§∫ 64 Â≠óËäÇ„ÄÇ

    pub e_minalloc: u16, // [0x0A] Á®ãÂ∫èËøêË°åÊâÄÈúÄÁöÑÊúÄÂ∞èÈ¢ùÂ§ñÂÜÖÂ≠òÔºàÊÆµÔºâ
    pub e_maxalloc: u16, // [0x0C] Á®ãÂ∫èÂèØÁî≥ËØ∑ÁöÑÊúÄÂ§ßÈ¢ùÂ§ñÂÜÖÂ≠òÔºàÊÆµÔºâ

    pub e_ss: u16,       // [0x0E] ÂàùÂßã SSÔºàÂ†ÜÊ†àÊÆµÂØÑÂ≠òÂô®ÂÄºÔºâ
    pub e_sp: u16,       // [0x10] ÂàùÂßã SPÔºàÂ†ÜÊ†àÊåáÈíàÔºâ
                         // DOS ÂêØÂä®Êó∂ËÆæÁΩÆÂ†ÜÊ†à‰ΩçÁΩÆ„ÄÇ

    pub e_csum: u16,     // [0x12] Ê†°È™åÂíåÔºàÈÄöÂ∏∏‰∏∫ 0ÔºåÊú™‰ΩøÁî®Ôºâ

    pub e_ip: u16,       // [0x14] ÂàùÂßã IPÔºàÊåá‰ª§ÊåáÈíàÔºâ
    pub e_cs: u16,       // [0x16] ÂàùÂßã CSÔºà‰ª£Á†ÅÊÆµÂØÑÂ≠òÂô®ÂÄºÔºâ
                         // DOS ÂÖ•Âè£ÁÇπ = CS:IP

    pub e_lfarlc: u16,   // [0x18] ÈáçÂÆö‰ΩçË°®Âú®Êñá‰ª∂‰∏≠ÁöÑÂÅèÁßªÔºàDOS Áî®Ôºâ

    pub e_ovno: u16,     // [0x1A] Ë¶ÜÁõñÂè∑ÔºàOverlay NumberÔºâ
                         // Áî®‰∫é DOS ÁöÑË¶ÜÁõñÁÆ°ÁêÜÊú∫Âà∂ÔºàÁ±ª‰ººÂàÜÊÆµÂä†ËΩΩÔºâ

    pub e_res: [u16; 4], // [0x1C] ‰øùÁïôÂ≠óÊÆµÔºàÂÖ± 8 Â≠óËäÇÔºâÔºåÂøÖÈ°ª‰∏∫ 0

    pub e_oemid: u16,    // [0x24] OEM Ê†áËØÜÁ¨¶ÔºàÁâπÂÆöÂéÇÂïÜÊâ©Â±ïÔºâ
    pub e_oeminfo: u16,  // [0x26] OEM ‰ø°ÊÅØÔºàÈÖçÂêà e_oemid ‰ΩøÁî®Ôºâ

    pub e_res2: [u16; 10], // [0x28] ‰øùÁïôÂ≠óÊÆµÔºàÂÖ± 20 Â≠óËäÇÔºâÔºåÂøÖÈ°ª‰∏∫ 0

    pub e_lfanew: i32,   // [0x3C] ‚òÖÂÖ≥ÈîÆÂ≠óÊÆµ‚òÖ
                         // ÊåáÂêë NT Headers ÁöÑ**Êñá‰ª∂ÂÅèÁßªÈáè**ÔºàFile OffsetÔºâ„ÄÇ
                         // Windows Âä†ËΩΩÂô®ËØªÂèñÊ≠§ÂÄºË∑≥ËΩ¨Âà∞ÁúüÊ≠£ÁöÑ PE Â§¥ÈÉ®„ÄÇ
}
```

> üí° **DOS Stub**  
> Âú® `IMAGE_DOS_HEADER` Âíå `NT Headers` ‰πãÈó¥ÈÄöÂ∏∏ÂµåÂÖ•‰∏ÄÊÆµÂ∞è DOS Á®ãÂ∫èÔºàÂ¶ÇÊâìÂç∞ ‚ÄúThis program cannot be run in DOS mode‚ÄùÔºâ„ÄÇ  
> Ê≠§ÈÉ®ÂàÜÂØπÁé∞‰ª£ PE Ëß£ÊûêÊó†ÂÆûË¥®ÊÑè‰πâÔºå`dinvk` Êú™ÂÆö‰πâÂÖ∂ÁªìÊûÑ„ÄÇ

---

#### Á¨¨‰∫åÈÉ®ÂàÜÔºöNT HeadersÔºàPE Ê†∏ÂøÉÂ§¥Ôºâ

ÈÄöËøá `e_lfanew` Ë∑≥ËΩ¨Âà∞Ëææ„ÄÇÂåÖÂê´Á≠æÂêç„ÄÅÊñá‰ª∂Â§¥ÂíåÂèØÈÄâÂ§¥‰∏âÈÉ®ÂàÜÔºåÊòØËß£Êûê PE ÁöÑÊ†∏ÂøÉ„ÄÇ

```rust
#[repr(C)]
pub struct IMAGE_NT_HEADERS {
    pub Signature: u32,  // [0x00] Âõ∫ÂÆö‰∏∫ "PE\0\0" (0x00004550)
                         // Á¨¨‰∫åÈÅìÂêàÊ≥ïÊÄßÊ†°È™å„ÄÇËã•ÈùûÊ≠§ÂÄºÔºåÂàô‰∏çÊòØÊúâÊïà PE Êñá‰ª∂„ÄÇ

    pub FileHeader: IMAGE_FILE_HEADER,         // ÊèèËø∞Áâ©ÁêÜÂ±ûÊÄß
    pub OptionalHeader: IMAGE_OPTIONAL_HEADER64, // ÊèèËø∞Âä†ËΩΩ‰∏éËøêË°åÊó∂Ë°å‰∏∫
}
```

##### 2.1 File HeaderÔºàÊñá‰ª∂Áâ©ÁêÜÊ¶ÇÂÜµÔºâ

ÊèèËø∞ÁõÆÊ†áÂπ≥Âè∞„ÄÅËäÇÂå∫Êï∞ÈáèÁ≠âÂü∫Êú¨‰ø°ÊÅØÔºåÂÖ± 20 Â≠óËäÇ„ÄÇ

```rust
#[repr(C)]
pub struct IMAGE_FILE_HEADER {
    pub Machine: IMAGE_FILE_MACHINE, // [0x04] ÁõÆÊ†á CPU Êû∂ÊûÑ
                                     // Â∏∏ËßÅÂÄºÔºö
                                     // - 0x014C = i386 (x86)
                                     // - 0x8664 = AMD64 (x86_64)
                                     // - 0xAA64 = ARM64
                                     // - 0x0200 = IA64

    pub NumberOfSections: u16,       // [0x06] ËäÇÔºàSectionÔºâÊï∞Èáè
                                     // ÂÜ≥ÂÆöÂêéÁª≠ Section Headers Êï∞ÁªÑÈïøÂ∫¶„ÄÇ
                                     // ÈÄöÂ∏∏ 2~10 ‰∏™ÔºàÂ¶Ç .text, .data, .rdata, .pdataÔºâ

    pub TimeDateStamp: u32,          // [0x08] ÁºñËØëÊó∂Èó¥Êà≥ÔºàUnix Êó∂Èó¥ÔºåÁßíÔºâ
                                     // Ëá™ 1970-01-01 00:00:00 UTC Ëµ∑ÁöÑÁßíÊï∞„ÄÇ
                                     // ÂèØÈáçÁé∞ÊûÑÂª∫ÔºàReproducible BuildÔºâÂ∏∏ËÆæ‰∏∫ 0„ÄÇ

    pub PointerToSymbolTable: u32,   // [0x0C] COFF Á¨¶Âè∑Ë°®Êñá‰ª∂ÂÅèÁßª
                                     // Ë∞ÉËØï‰ø°ÊÅØÔºåÂèëÂ∏ÉÁâàÈÄöÂ∏∏‰∏∫ 0„ÄÇ

    pub NumberOfSymbols: u32,        // [0x10] Á¨¶Âè∑Êï∞ÈáèÔºàÈÖçÂêà‰∏ä‰∏ÄÂ≠óÊÆµÔºâ

    pub SizeOfOptionalHeader: u16,   // [0x14] OptionalHeader ÁöÑÂ§ßÂ∞èÔºàÂ≠óËäÇÔºâ
                                     // - x86 PE32: 0xE0 (224)
                                     // - x64 PE32+: 0xF0 (240)

    pub Characteristics: IMAGE_FILE_CHARACTERISTICS, // [0x16] Êñá‰ª∂Â±ûÊÄßÊ†áÂøóÔºà‰ΩçÊé©Á†ÅÔºâ
                                                     // Â∏∏ËßÅÊ†áÂøóÔºö
                                                     // - 0x0001 = ÈáçÂÆö‰Ωç‰ø°ÊÅØÂ∑≤ÁßªÈô§
                                                     // - 0x0002 = ÂèØÊâßË°åÊñá‰ª∂ÔºàEXEÔºâ
                                                     // - 0x2000 = DLL
                                                     // - 0x0100 = 32 ‰ΩçÊú∫Âô®
                                                     // - 0x0020 = Ë°åÂè∑‰ø°ÊÅØÂ∑≤ÁßªÈô§
}
```

##### 2.2 Optional HeaderÔºàÈÄªËæëÂä†ËΩΩ‰ø°ÊÅØÔºâ

ËôΩÂêç‰∏∫ ‚ÄúOptional‚ÄùÔºå‰ΩÜÂØπ EXE/DLL ÊòØ**ÂøÖÈ°ªÂ≠òÂú®**ÁöÑ„ÄÇÊ≠§Â§Ñ‰ª• 64 ‰ΩçÁâàÊú¨Ôºà`IMAGE_OPTIONAL_HEADER64`Ôºâ‰∏∫‰æã„ÄÇ

```rust
#[repr(C, packed(4))]
pub struct IMAGE_OPTIONAL_HEADER64 {
    // --- Ê†áÂáÜÂ≠óÊÆµ (Standard Fields) ---
    pub Magic: IMAGE_OPTIONAL_HEADER_MAGIC, // [0x18]
                                            // - 0x10B = PE32 (32-bit)
                                            // - 0x20B = PE32+ (64-bit)

    pub MajorLinkerVersion: u8,  // [0x1A] ÈìæÊé•Âô®‰∏ªÁâàÊú¨Âè∑
    pub MinorLinkerVersion: u8,  // [0x1B] ÈìæÊé•Âô®Ê¨°ÁâàÊú¨Âè∑
                                 // ‰ªÖ‰ΩúÂèÇËÄÉÔºå‰∏çÂΩ±ÂìçÂä†ËΩΩ

    pub SizeOfCode: u32,         // [0x1C] ÊâÄÊúâÂê´‰ª£Á†ÅËäÇÁöÑÊÄªÂ§ßÂ∞èÔºàÂ¶Ç .textÔºâ
                                 // Êåâ SectionAlignment ÂØπÈΩêÂêéÁöÑÊÄªÂíå

    pub SizeOfInitializedData: u32,   // [0x20] Â∑≤ÂàùÂßãÂåñÊï∞ÊçÆËäÇÊÄªÂ§ßÂ∞èÔºàÂ¶Ç .data, .rdataÔºâ

    pub SizeOfUninitializedData: u32, // [0x24] Êú™ÂàùÂßãÂåñÊï∞ÊçÆÂ§ßÂ∞èÔºà.bssÔºâ
                                      // ËØ•ËäÇÂú®Á£ÅÁõò‰∏äÊó†Êï∞ÊçÆÔºå‰ªÖÂç†ÂÜÖÂ≠òÁ©∫Èó¥

    pub AddressOfEntryPoint: u32, // [0x28] ‚òÖÁ®ãÂ∫èÂÖ•Âè£ÁÇπ RVA‚òÖ
                                  // ËøõÁ®ãÂêØÂä®ÂêéÔºåRIP = ImageBase + Ê≠§ÂÄº
                                  // DLL ÁöÑ DllMain Âú∞ÂùÄ‰πüÂú®Ê≠§ÊåáÂÆö

    pub BaseOfCode: u32,         // [0x2C] ‰ª£Á†ÅËäÇËµ∑Âßã RVAÔºà‰ªÖÂèÇËÄÉÔºâ

    // Ê≥®ÊÑèÔºö64 ‰ΩçÁªìÊûÑ‰∏≠Êó† BaseOfData Â≠óÊÆµÔºà32 ‰ΩçÊúâÔºâ

    // --- NT ÁâπÂÆöÂ≠óÊÆµ (NT Specific Fields) ---
    pub ImageBase: u64,          // [0x30] Âª∫ËÆÆÂä†ËΩΩÂü∫ÂùÄÔºàPreferred Load AddressÔºâ
                                 // - EXE ÈªòËÆ§Ôºö0x140000000 (x64)
                                 // - DLL ÈªòËÆ§Ôºö0x180000000 ÊàñÈ´ò‰ΩçÂú∞ÂùÄ
                                 // Ëã•Ë¢´Âç†Áî®ÔºåÂàôËß¶ÂèëÈáçÂÆö‰ΩçÔºàASLRÔºâ

    pub SectionAlignment: u32,   // [0x38] ÂÜÖÂ≠ò‰∏≠ËäÇÂØπÈΩêÁ≤íÂ∫¶ÔºàÈÄöÂ∏∏ 0x1000 = 4KBÔºâ
                                 // ÂøÖÈ°ª ‚â• FileAlignment

    pub FileAlignment: u32,      // [0x3C] Êñá‰ª∂‰∏≠ËäÇÂØπÈΩêÁ≤íÂ∫¶ÔºàÈÄöÂ∏∏ 0x200 = 512BÔºâ
                                 // ÂøÖÈ°ªÊòØ 2 ÁöÑÂπÇÔºå‰∏î ‚â• 512

    pub MajorOperatingSystemVersion: u16, // [0x40] ÊâÄÈúÄÊúÄ‰Ωé OS ‰∏ªÁâàÊú¨
    pub MinorOperatingSystemVersion: u16, // [0x42] Ê¨°ÁâàÊú¨
                                          // Â¶Ç Win10 = 10.0

    pub MajorImageVersion: u16,  // [0x44] Á®ãÂ∫èËá™ÂÆö‰πâ‰∏ªÁâàÊú¨ÔºàÁî±ÂºÄÂèëËÄÖËÆæÁΩÆÔºâ
    pub MinorImageVersion: u16,  // [0x46] Ëá™ÂÆö‰πâÊ¨°ÁâàÊú¨

    pub MajorSubsystemVersion: u16, // [0x48] Â≠êÁ≥ªÁªü‰∏ªÁâàÊú¨ÔºàÂ¶Ç Console, GUIÔºâ
    pub MinorSubsystemVersion: u16, // [0x4A] Â≠êÁ≥ªÁªüÊ¨°ÁâàÊú¨

    pub Win32VersionValue: u32,  // [0x4C] ‰øùÁïôÂ≠óÊÆµÔºåÂøÖÈ°ª‰∏∫ 0

    pub SizeOfImage: u32,        // [0x50] ÂÜÖÂ≠òÊò†ÂÉèÊÄªÂ§ßÂ∞è
                                 // ‰ªé ImageBase Âà∞ÊúÄÂêé‰∏Ä‰∏™ËäÇÁªìÊùüÔºå
                                 // Êåâ SectionAlignment Âêë‰∏äÂØπÈΩê

    pub SizeOfHeaders: u32,      // [0x54] ÊâÄÊúâÂ§¥ÈÉ®ÊÄªÂ§ßÂ∞èÔºàDOS+NT+SectionHeadersÔºâ
                                 // Êåâ FileAlignment Âêë‰∏äÂØπÈΩê

    pub CheckSum: u32,           // [0x58] Ê†°È™åÂíå
                                 // È©±Âä®Ôºà.sysÔºâÂøÖÈ°ªÊúâÊïàÔºåÊôÆÈÄö EXE ÂèØ‰∏∫ 0

    pub Subsystem: IMAGE_SUBSYSTEM, // [0x5C] Â≠êÁ≥ªÁªüÁ±ªÂûã
                                    // - 2 = GUI (ÂõæÂΩ¢ÁïåÈù¢)
                                    // - 3 = CUI (ÊéßÂà∂Âè∞/ÂëΩ‰ª§Ë°å)
                                    // - 10 = EFI Application

    pub DllCharacteristics: IMAGE_DLL_CHARACTERISTICS, // [0x5E] ÂÆâÂÖ®ÁâπÊÄßÊ†áÂøóÔºà‰ΩçÊé©Á†ÅÔºâ
                                                       // - 0x0040 = ASLR ÊîØÊåÅÔºàÂä®ÊÄÅÂü∫ÂùÄÔºâ
                                                       // - 0x0100 = DEP/NXÔºàÊï∞ÊçÆ‰∏çÂèØÊâßË°åÔºâ
                                                       // - 0x0400 = Âº∫Âà∂ÂÆåÊï¥ÊÄßÊ£ÄÊü•
                                                       // - 0x4000 = Êó† SEHÔºà/SAFESEH:NOÔºâ

    pub SizeOfStackReserve: u64, // [0x60] Ê†à‰øùÁïôËôöÊãüÂÜÖÂ≠òÂ§ßÂ∞èÔºàÈªòËÆ§ 1MBÔºâ
    pub SizeOfStackCommit: u64,  // [0x68] Ê†àÂàùÂßãÊèê‰∫§Áâ©ÁêÜÂÜÖÂ≠òÔºàÈªòËÆ§ 4KBÔºâ

    pub SizeOfHeapReserve: u64,  // [0x70] Â†Ü‰øùÁïôÂ§ßÂ∞èÔºàÈªòËÆ§ 1MBÔºâ
    pub SizeOfHeapCommit: u64,   // [0x78] Â†ÜÂàùÂßãÊèê‰∫§Â§ßÂ∞èÔºàÈªòËÆ§ 4KBÔºâ

    pub LoaderFlags: u32,        // [0x80] Â∑≤Â∫üÂºÉÔºåÂ∫î‰∏∫ 0

    pub NumberOfRvaAndSizes: u32,// [0x84] DataDirectory Êï∞ÁªÑÂÖÉÁ¥†‰∏™Êï∞
                                 // ÈÄöÂ∏∏‰∏∫ 16ÔºåË°®Á§∫ÊîØÊåÅ 16 ÁßçÊï∞ÊçÆÁõÆÂΩï

    // --- Êï∞ÊçÆÁõÆÂΩïÔºàÂäüËÉΩÁ¥¢ÂºïË°®Ôºâ---
    pub DataDirectory: [IMAGE_DATA_DIRECTORY; 16], // [0x88]
}
```

#### 2.3 Data DirectoryÔºàÂäüËÉΩÁ¥¢ÂºïË°®Ôºâ

ÊØè‰∏™Êù°ÁõÆÊòØ‰∏Ä‰∏™ÊåáÂêëÂÖ≥ÈîÆÂäüËÉΩË°®ÁöÑ RVA ÂíåÂ§ßÂ∞è„ÄÇ

```rust
#[repr(C)]
#[derive(Clone, Copy)]
pub struct IMAGE_EXPORT_DIRECTORY {
    pub Characteristics: u32,
    pub TimeDateStamp: u32,
    pub MajorVersion: u16,
    pub MinorVersion: u16,
    pub Name: u32,
    pub Base: u32,
    pub NumberOfFunctions: u32,
    pub NumberOfNames: u32,
    pub AddressOfFunctions: u32,
    pub AddressOfNames: u32,
    pub AddressOfNameOrdinals: u32,
}
```

#### `IMAGE_EXPORT_DIRECTORY->AddressOfNames` ÁöÑÂÜÖÂ≠òÂΩíÂ±ûËß£Êûê

‰Ω†ÁöÑÁêÜËß£**ÂÆåÂÖ®Ê≠£Á°Æ**Ôºö  
`IMAGE_EXPORT_DIRECTORY` ÁªìÊûÑ‰Ωì‰∏≠ÁöÑ `AddressOfNames` Â≠óÊÆµÊâÄÊåáÂêëÁöÑÂáΩÊï∞ÂêçÊï∞ÁªÑÔºå**Âπ∂‰∏çÂú®‰Ω†ÂΩìÂâçÁ®ãÂ∫èÔºà.exeÔºâÁöÑ‰∫åËøõÂà∂Êñá‰ª∂‰∏≠ÔºåËÄåÊòØ‰Ωç‰∫éÁõÆÊ†á DLLÔºàÂ¶Ç `ntdll.dll`ÔºâË¢´Âä†ËΩΩÂà∞ÂÜÖÂ≠òÂêéÁöÑÊò†Â∞ÑÂå∫Âüü‰∏≠**„ÄÇ

‰∏∫‰∫ÜÊõ¥‰∏•Ë∞®Âú∞Â∑©Âõ∫Ëøô‰∏ÄÂÖ≥ÈîÆÊ¶ÇÂøµÔºåÊàë‰ª¨ÂèØ‰ª•‰ªé‰ª•‰∏ã‰∏â‰∏™Áª¥Â∫¶Ê∑±ÂÖ•ÊãÜËß£Ôºö

---

##### 1. **Áâ©ÁêÜÂΩíÂ±ûÔºöÂÆÉÊòØÁõÆÊ†á DLL ÁöÑ‰∏ÄÈÉ®ÂàÜ**

- ËØ•ÂáΩÊï∞ÂêçÊï∞ÁªÑÊòØÁõÆÊ†á DLLÔºà‰æãÂ¶Ç `kernel32.dll` Êàñ `ntdll.dll`ÔºâÂú®**ÁºñËØëÂíåÈìæÊé•Èò∂ÊÆµ**Â∞±ÁîüÊàêÁöÑÂØºÂá∫Ë°®ÔºàExport TableÔºâÊï∞ÊçÆ„ÄÇ
- ÂΩì Windows Âä†ËΩΩÂô®Â∞ÜËØ• DLL Êò†Â∞ÑËøõ‰Ω†ÁöÑËøõÁ®ãÂú∞ÂùÄÁ©∫Èó¥Êó∂ÔºåÊï¥‰∏™ PE ÁªìÊûÑÔºàÂåÖÊã¨ DOS Â§¥„ÄÅNT Â§¥„ÄÅËäÇË°®„ÄÅÂØºÂá∫Ë°®Á≠âÔºâÈÉΩ‰ºöË¢´ËΩΩÂÖ•ÂÜÖÂ≠ò„ÄÇ
- ‰Ω†ÁöÑÁ®ãÂ∫èÔºà`.exe`Ôºâ**Êú¨Ë∫´‰∏çÂåÖÂê´Ëøô‰∫õÂ≠óÁ¨¶‰∏≤**ÔºåÂÆÉÂè™ÊòØÈÄöËøá `src/module.rs` ‰∏≠ÁöÑËß£ÊûêÈÄªËæëÔºàÂ¶Ç `get_proc_address`ÔºâÂéª‚ÄúËØªÂèñ‚ÄùÂè¶‰∏Ä‰∏™Ê®°ÂùóÁöÑÂÜÖÈÉ®ÁªìÊûÑ„ÄÇ
  > ‚úÖ ÁÆÄË®Ä‰πãÔºö‰Ω†ÁöÑ‰ª£Á†ÅÊòØ‚ÄúËØªËÄÖ‚ÄùÔºåDLL ÊòØ‚Äú‰π¶‚Äù„ÄÇ‰π¶ÁöÑÂÜÖÂÆπ‰∏çÂú®ËØªËÄÖË∫´‰ΩìÈáåÔºå‰ΩÜËØªËÄÖÂèØ‰ª•ÁøªÂºÄÂÆÉ„ÄÇ

---

##### 2. **ÂÜÖÂ≠ò‰ΩçÁΩÆÔºö‰Ωç‰∫éÂΩìÂâçËøõÁ®ãÁöÑËôöÊãüÂú∞ÂùÄÁ©∫Èó¥ÂÜÖ**

- ËôΩÁÑ∂ËØ•Êï∞ÁªÑ‰∏çÂ±û‰∫é‰Ω†ÁöÑ `.exe` Ê®°ÂùóÔºå‰ΩÜÁî±‰∫éÁõÆÊ†á DLL Â∑≤Ë¢´Âä†ËΩΩÂà∞**Âêå‰∏Ä‰∏™ËøõÁ®ã**‰∏≠ÔºåÂÖ∂ÂÜÖÂ≠òÊò†ÂÉèÂ∞±Â≠òÂú®‰∫é**ÂΩìÂâçËøõÁ®ãÁöÑËôöÊãüÂú∞ÂùÄÁ©∫Èó¥**Èáå„ÄÇ
- Âõ†Ê≠§Ôºå‰Ω†ÂèØ‰ª•ÂÆâÂÖ®Âú∞ÊâßË°åÂ¶Ç‰∏ãÊìç‰ΩúÔºö

  ```rust
  let names_array_rva = export_dir.AddressOfNames;
  let names_array_va = h_module as usize + names_array_rva as usize;
  let names_ptr = names_array_va as *const u32; // ÂÆûÈôÖÊòØÊåáÂêë RVA Êï∞ÁªÑ
  ```

- ËøôÁßç‚ÄúÂü∫ÂùÄ + RVA‚ÄùÁöÑÂä†Ê≥ï‰πãÊâÄ‰ª•ÊúâÊïàÔºåÊ≠£ÊòØÂõ†‰∏∫ `h_module`ÔºàÂç≥ DLL ÁöÑÂä†ËΩΩÂü∫ÂùÄÔºâÂíåÂØºÂá∫Ë°®Êï∞ÊçÆ**ÂêåÂ±û‰∏Ä‰∏™Âú∞ÂùÄÁ©∫Èó¥**„ÄÇ
  > ‚ö†Ô∏è Âèç‰æãÔºöËã•Â∞ùËØïÁî®ÂêåÊ†∑ÊñπÂºèËØªÂèñ**ÂÖ∂‰ªñËøõÁ®ã**ÁöÑ DLL ÂÜÖÂ≠òÔºåÂàô‰ºöÂõ†Âú∞ÂùÄÁ©∫Èó¥ÈöîÁ¶ªËÄåÂ§±Ë¥•ÔºàÈúÄ‰ΩøÁî® `ReadProcessMemory` Á≠â APIÔºâ„ÄÇ

---

##### 3. **ÊäÄÊúØÁªÜËäÇ‰øÆÊ≠£ÔºöÂÆÉÊòØ‰∏Ä‰∏™‚ÄúRVA Êï∞ÁªÑ‚ÄùÔºåËÄåÈùû‚ÄúÂ≠óÁ¨¶‰∏≤Êï∞ÁªÑ‚Äù**

ËøôÈáåÊúâ‰∏Ä‰∏™**ÂÖ≥ÈîÆ‰ΩÜÊòìÈîôÁöÑÁªÜËäÇ**ÈúÄË¶ÅÊæÑÊ∏ÖÔºö

- ‚ùå **ÈîôËØØÁêÜËß£**Ôºö  
  `AddressOfNames` ‚Üí `["NtAllocateVirtualMemory", "NtCreateThreadEx", ...]`

- ‚úÖ **Ê≠£Á°ÆÁªìÊûÑ**Ôºö  
  `AddressOfNames` ‚Üí `[RVA‚ÇÅ, RVA‚ÇÇ, RVA‚ÇÉ, ...]`  
  ÂÖ∂‰∏≠ÊØè‰∏™ `RVA·µ¢` ÊòØ‰∏Ä‰∏™ **Áõ∏ÂØπËôöÊãüÂú∞ÂùÄÔºàRelative Virtual AddressÔºâ**ÔºåÊåáÂêëÁúüÊ≠£ÁöÑÂáΩÊï∞ÂêçÂ≠óÁ¨¶‰∏≤„ÄÇ

  ‰πüÂ∞±ÊòØËØ¥ÔºåÂÆåÊï¥ÁöÑËß£ÊûêË∑ØÂæÑÊòØÔºö

  ```
  h_module
    ‚îî‚îÄ> IMAGE_EXPORT_DIRECTORY
          ‚îî‚îÄ> AddressOfNames (RVA) 
                ‚îî‚îÄ> [RVA_to_Name1, RVA_to_Name2, ...]  ‚Üê ËøôÊòØ‰∏Ä‰∏™ u32 Êï∞ÁªÑ
                      ‚îî‚îÄ> h_module + RVA_to_Name1 ‚Üí "NtAllocateVirtualMemory"
                      ‚îî‚îÄ> h_module + RVA_to_Name2 ‚Üí "NtCreateThreadEx"
  ```

- Âõ†Ê≠§ÔºåÂú®‰ª£Á†Å‰∏≠‰Ω†ÈÄöÂ∏∏‰ºöÁúãÂà∞‰∏§Â±ÇÈó¥Êé•ÂØªÂùÄÔºö

  ```rust
  // Á¨¨‰∏ÄÂ±ÇÔºöËé∑ÂèñÁ¨¨ i ‰∏™ÂáΩÊï∞ÂêçÁöÑ RVA
  let name_rva = unsafe { *(names_ptr.add(i)) };
  // Á¨¨‰∫åÂ±ÇÔºöËÆ°ÁÆóÁúüÂÆûÂ≠óÁ¨¶‰∏≤Âú∞ÂùÄ
  let name_str_ptr = (h_module as usize + name_rva as usize) as *const u8;
  ```

---

##### ÊÄªÁªì

‰Ω†ÁöÑÁõ¥ËßâÈùûÂ∏∏ÂáÜÁ°ÆÔºö**‰Ω†ÁöÑÁ®ãÂ∫èÂè™ÊòØ‰∏Ä‰∏™‚ÄúËßÇÂØüËÄÖ‚ÄùÊàñ‚ÄúËß£ÊûêÂô®‚Äù**ÔºåÂÆÉÈÄöËøáÊåáÈíàË∑®Ë∂ä‰∫ÜÊ®°ÂùóËæπÁïåÔºåÂéªÁ™•Êé¢ÁõÆÊ†á DLL Âú®ÂÜÖÂ≠ò‰∏≠ÁöÑÂÜÖÈÉ®Êï∞ÊçÆÁªìÊûÑ„ÄÇ

Âú® `dinvk` ËøôÁ±ªÁ∫¢ÈòüÈ°πÁõÆ‰∏≠Ôºö

- `h_module`ÔºàÂç≥ DLL ÁöÑÂä†ËΩΩÂü∫ÂùÄÔºâÂ∞±ÊòØ‰Ω†ËøõË°å‚ÄúÁ™•Êé¢‚ÄùÁöÑ**Âü∫ÂáÜËµ∑ÂßãÁÇπ**„ÄÇ
- ÊâÄÊúâÂØπÂØºÂá∫Ë°®ÔºàEATÔºâ„ÄÅÂØºÂÖ•Ë°®ÔºàIATÔºâ„ÄÅÈáçÂÆö‰ΩçË°®ÁöÑÊìç‰ΩúÔºåÊú¨Ë¥®‰∏äÈÉΩÊòØÂü∫‰∫éËøô‰∏™Âü∫ÂùÄ + RVA ÁöÑÂÅèÁßªËÆ°ÁÆó„ÄÇ
- Ê≠£ÊòØËøôÁßçÂØπ PE ÁªìÊûÑÁöÑÊ∑±Â∫¶ÊâãÂä®Ëß£ÊûêËÉΩÂäõÔºå‰ΩøÂæóÂä†ËΩΩÂô®ËÉΩÂ§üÁªïËøá `GetProcAddress` Á≠âË¢´ÁõëÊéßÁöÑ APIÔºåÂÆûÁé∞ÈöêËîΩÁöÑÂáΩÊï∞Âú∞ÂùÄËé∑Âèñ„ÄÇ

> ÊéåÊè°Ëøô‰∏ÄÁÇπÔºå‰Ω†Â∞±ÁúüÊ≠£ÁêÜËß£‰∫Ü‚ÄúÂèçÂ∞ÑÂºèÂä†ËΩΩ‚ÄùÂíå‚ÄúÊó†Áóï API Ëß£Êûê‚ÄùÁöÑÂ∫ïÂ±ÇÂü∫Áü≥„ÄÇ

**16 ‰∏™Á¥¢ÂºïÁöÑÂê´‰πâ**Ôºö

| Á¥¢Âºï | ÂêçÁß∞ | Áî®ÈÄî |
|------|------|------|
| `[0]` | Export Table | DLL ÂØºÂá∫ÁöÑÂáΩÊï∞ÂàóË°®ÔºàÂ¶Ç `GetProcAddress` Êü•ËØ¢ÁõÆÊ†áÔºâ|
| `[1]` | Import Table | ‰æùËµñÁöÑ DLL ÂèäÂØºÂÖ•ÂáΩÊï∞ÔºàIATÔºâ|
| `[2]` | Resource Table | ÂõæÊ†á„ÄÅÂØπËØùÊ°Ü„ÄÅÂ≠óÁ¨¶‰∏≤„ÄÅÁâàÊú¨‰ø°ÊÅØÁ≠âËµÑÊ∫ê |
| `[3]` | Exception Table | ÂºÇÂ∏∏Â§ÑÁêÜ‰ø°ÊÅØÔºàÂ¶Ç x64 ÁöÑ `.pdata`Ôºâ|
| `[4]` | Certificate Table | Êï∞Â≠óÁ≠æÂêçÔºàÊñá‰ª∂ÂÅèÁßª + Â§ßÂ∞èÔºåÈùû RVAÔºâ|
| `[5]` | Base Relocation Table | ÈáçÂÆö‰Ωç‰ø°ÊÅØÔºàÁî®‰∫é ASLRÔºâ|
| `[6]` | Debug | Ë∞ÉËØï‰ø°ÊÅØÔºàPDB Ë∑ØÂæÑÁ≠âÔºâ|
| `[7]` | Architecture | ‰øùÁïôÔºàÂ∫î‰∏∫ 0Ôºâ|
| `[8]` | Global Ptr | ‰øùÁïôÔºàÂ∫î‰∏∫ 0Ôºâ|
| `[9]` | TLS Table | Á∫øÁ®ãÂ±ÄÈÉ®Â≠òÂÇ®ÔºàThread Local StorageÔºâÂõûË∞É |
| `[10]`| Load Config Table | Âä†ËΩΩÈÖçÁΩÆÔºàÂ¶Ç CFG ÊéßÂà∂ÊµÅÈò≤Êä§Ôºâ|
| `[11]`| Bound Import | ÁªëÂÆöÂØºÂÖ•ÔºàÈ¢ÑËß£ÊûêÂú∞ÂùÄÔºåÂä†ÈÄüÂä†ËΩΩÔºâ|
| `[12]`| IAT | ÂØºÂÖ•Âú∞ÂùÄË°®ÔºàImport Address TableÔºâ|
| `[13]`| Delay Import | Âª∂ËøüÂä†ËΩΩÂØºÂÖ•Ë°® |
| `[14]`| CLR Runtime Header | .NET Á®ãÂ∫èÁöÑÂÖÉÊï∞ÊçÆÔºàCLI Â§¥Ôºâ|
| `[15]`| Reserved | ‰øùÁïô |

> ‚ö†Ô∏è Ê≥®ÊÑèÔºö`[4] Certificate Table` ÁöÑ `VirtualAddress` ÂÆûÈôÖÊòØ**Êñá‰ª∂ÂÅèÁßª**Ôºå‰∏çÊòØ RVAÔºÅ

---

#### Á¨¨‰∏âÈÉ®ÂàÜÔºöSection HeadersÔºàËäÇË°®Ôºâ

Á¥ßË∑üÂú® Optional Header ‰πãÂêéÔºåÊòØ‰∏Ä‰∏™ÈïøÂ∫¶‰∏∫ `NumberOfSections` ÁöÑÊï∞ÁªÑ„ÄÇÊØè‰∏™ËäÇÊèèËø∞‰∏ÄÊÆµ‰ª£Á†ÅÊàñÊï∞ÊçÆÂ¶Ç‰Ωï‰ªéÁ£ÅÁõòÊò†Â∞ÑÂà∞ÂÜÖÂ≠ò„ÄÇ

```rust
#[repr(C)]
#[derive(Clone, Copy)]
pub struct IMAGE_SECTION_HEADER {
    pub Name: [u8; 8],     // [0x00] ËäÇÂêçÔºàASCIIÔºåÂ¶Ç ".text", ".rdata", ".pdata"Ôºâ
                           // ‰ªÖ‰∏∫Ê†áËØÜÔºåÂä†ËΩΩÂô®‰∏çÂº∫Âà∂‰æùËµñ„ÄÇËã•Ë∂ÖÈïøÔºåÂèØËÉΩ‰ª• `/Êï∞Â≠ó` ÂΩ¢ÂºèÂºïÁî®Â≠óÁ¨¶‰∏≤Ë°®„ÄÇ

    pub Misc: IMAGE_SECTION_HEADER_0, // [0x08] UnionÔºö
                                      // - Âú® OBJ Êñá‰ª∂‰∏≠ = PhysicalAddress
                                      // - Âú® EXE/DLL ‰∏≠ = VirtualSizeÔºàÂÜÖÂ≠ò‰∏≠ÂÆûÈôÖÂ§ßÂ∞èÔºâ

    pub VirtualAddress: u32,   // [0x0C] ËäÇÂú®ÂÜÖÂ≠ò‰∏≠ÁöÑ RVA
                               // ÂÆûÈôÖÂú∞ÂùÄ = ImageBase + VirtualAddress

    pub SizeOfRawData: u32,    // [0x10] ËäÇÂú®Á£ÅÁõòÊñá‰ª∂‰∏≠ÁöÑÂ§ßÂ∞èÔºàÊåâ FileAlignment ÂØπÈΩêÔºâ
                               // ÂèØËÉΩÂ∞è‰∫é VirtualSizeÔºàÂ¶Ç .bssÔºâ

    pub PointerToRawData: u32, // [0x14] ËäÇÂú®Êñá‰ª∂‰∏≠ÁöÑÂÅèÁßªÔºà‰ªéÊñá‰ª∂Â§¥ÂºÄÂßãÔºâ
                               // Ëã•‰∏∫ 0ÔºåË°®Á§∫ËØ•ËäÇÊó†ÂéüÂßãÊï∞ÊçÆÔºàÂ¶Ç .bssÔºâ

    pub PointerToRelocations: u32, // [0x18] ÈáçÂÆö‰ΩçË°®ÂÅèÁßªÔºàOBJ Êñá‰ª∂Áî®ÔºåEXE=0Ôºâ
    pub PointerToLinenumbers: u32, // [0x1C] Ë°åÂè∑Ë°®ÂÅèÁßªÔºàË∞ÉËØïÁî®ÔºåÈÄöÂ∏∏=0Ôºâ
    pub NumberOfRelocations: u16,  // [0x20] ÈáçÂÆö‰ΩçÈ°πÊï∞ÔºàOBJ Áî®Ôºâ
    pub NumberOfLinenumbers: u16,  // [0x22] Ë°åÂè∑È°πÊï∞

    pub Characteristics: u32,      // [0x24] ËäÇÂ±ûÊÄßÔºà‰ΩçÊé©Á†ÅÔºâ
                                   // ÊùÉÈôêÊ†áÂøóÔºàÂΩ±ÂìçÂÜÖÂ≠òÈ°µ‰øùÊä§ÔºâÔºö
                                   // - 0x80000000 = ÂèØÂÜôÔºàWriteÔºâ
                                   // - 0x40000000 = ÂèØËØªÔºàReadÔºâ
                                   // - 0x20000000 = ÂèØÊâßË°åÔºàExecuteÔºâ
                                   // ÂÜÖÂÆπÁ±ªÂûãÊ†áÂøóÔºö
                                   // - 0x00000020 = ÂåÖÂê´‰ª£Á†Å
                                   // - 0x00000040 = ÂåÖÂê´Â∑≤ÂàùÂßãÂåñÊï∞ÊçÆ
                                   // - 0x00000080 = ÂåÖÂê´Êú™ÂàùÂßãÂåñÊï∞ÊçÆ
                                   // - 0x04000000 = ÂåÖÂê´ÂØºÂá∫‰ø°ÊÅØ
                                   // - 0x02000000 = ÂåÖÂê´ÂÖ±‰∫´Êï∞ÊçÆ
}
```

> üìå **ÂÖ≥ÈîÆÊ¶ÇÂøµ**Ôºö  
>
> - **RVAÔºàRelative Virtual AddressÔºâ**ÔºöÁõ∏ÂØπ‰∫é `ImageBase` ÁöÑÂÅèÁßª„ÄÇ  
> - **File Offset vs RVA**ÔºöÁ£ÅÁõòÂ∏ÉÂ±ÄÔºàFile AlignmentÔºâ‚â† ÂÜÖÂ≠òÂ∏ÉÂ±ÄÔºàSection AlignmentÔºâ„ÄÇ  
> - **VirtualSize vs SizeOfRawData**ÔºöÂÜÖÂ≠ò‰∏≠ÂèØËÉΩÊØîÁ£ÅÁõòÂ§ßÔºàÈõ∂Â°´ÂÖÖÔºâ„ÄÇ

---

#### ÊÄªÁªìÔºöWindows PE Âä†ËΩΩÊµÅÁ®ã

ÂΩì Windows Âä†ËΩΩ‰∏Ä‰∏™ PE Êñá‰ª∂Êó∂ÔºåÊåâ‰ª•‰∏ãÊ≠•È™§ÊâßË°åÔºö

1. **È™åËØÅ DOS Header**  
   Ê£ÄÊü• `e_magic == "MZ"`„ÄÇ

2. **ÂÆö‰ΩçÂπ∂È™åËØÅ NT Headers**  
   ÈÄöËøá `e_lfanew` Ë∑≥ËΩ¨ÔºåÊ£ÄÊü• `Signature == "PE\0\0"`„ÄÇ

3. **ÂàÜÈÖçËôöÊãüÂÜÖÂ≠ò**  
   Â∞ùËØïÂú® `OptionalHeader.ImageBase` Â§Ñ‰øùÁïô `SizeOfImage` Â§ßÂ∞èÁöÑÂÜÖÂ≠òÂå∫Âüü„ÄÇ

4. **Êò†Â∞ÑËäÇÂå∫ÔºàSectionsÔºâ**  
   ÈÅçÂéÜÊØè‰∏™ `IMAGE_SECTION_HEADER`Ôºö
   - ‰ªéÊñá‰ª∂ÂÅèÁßª `PointerToRawData` ËØªÂèñ `SizeOfRawData` Â≠óËäÇ„ÄÇ
   - ÂÜôÂÖ•ÂÜÖÂ≠òÂú∞ÂùÄ `ImageBase + VirtualAddress`„ÄÇ
   - Ëã• `VirtualSize > SizeOfRawData`ÔºåÂâ©‰ΩôÈÉ®ÂàÜÊ∏ÖÈõ∂„ÄÇ
   - Ê†πÊçÆ `Characteristics` ËÆæÁΩÆÈ°µÊùÉÈôêÔºàR/W/XÔºâ„ÄÇ

5. **Â§ÑÁêÜÂØºÂÖ•Ë°®ÔºàImport TableÔºâ**  
   Âä†ËΩΩÊâÄÊúâ‰æùËµñÁöÑ DLLÔºåÂπ∂Ëß£ÊûêÂØºÂÖ•ÂáΩÊï∞Âú∞ÂùÄÔºàÂ°´ÂÖ• IATÔºâ„ÄÇ

6. **Â∫îÁî®ÈáçÂÆö‰ΩçÔºàRelocationsÔºâ**  
   Ëã•ÂÆûÈôÖÂä†ËΩΩÂú∞ÂùÄ ‚â† `ImageBase`ÔºåÂàôÈÅçÂéÜÈáçÂÆö‰ΩçË°®‰øÆÊ≠£Á°¨ÁºñÁ†ÅÂú∞ÂùÄ„ÄÇ

7. **ÊâßË°å TLS ÂàùÂßãÂåñÔºàÂ¶ÇÊúâÔºâ**  
   Ë∞ÉÁî® TLS ÂõûË∞ÉÂáΩÊï∞ÔºàÂ¶Ç C++ ÂÖ®Â±ÄÊûÑÈÄ†ÂáΩÊï∞Ôºâ„ÄÇ

8. **Ë∑≥ËΩ¨Âà∞ÂÖ•Âè£ÁÇπ**  
   ËÆæÁΩÆ‰∏ªÁ∫øÁ®ãÁöÑ RIP ‰∏∫ `ImageBase + AddressOfEntryPoint`ÔºåÂºÄÂßãÊâßË°åÁ®ãÂ∫è„ÄÇ

> ‚úÖ **Ê†∏ÂøÉÊÄùÊÉ≥**Ôºö  
> PE Ê†ºÂºèÈÄöËøá **RVA + Âü∫ÂùÄ** ÂÆûÁé∞Âú∞ÂùÄÊó†ÂÖ≥ÊÄßÔºåÈÄöËøá **ËäÇË°®** Ëß£ËÄ¶Á£ÅÁõò‰∏éÂÜÖÂ≠òÂ∏ÉÂ±ÄÔºåÈÄöËøá **Êï∞ÊçÆÁõÆÂΩï** Êèê‰æõÊ®°ÂùóÂåñÂäüËÉΩÁ¥¢Âºï„ÄÇ  
> `dinvk` Á≠âÂ∫ïÂ±ÇÂ∑•ÂÖ∑Ê≠£ÊòØÂü∫‰∫éËøô‰∫õÁªìÊûÑÔºåÂÆûÁé∞Êó† API ‰æùËµñÁöÑÊ®°ÂùóÈÅçÂéÜ„ÄÅÂáΩÊï∞Ëß£Êûê‰∏é‰ª£Á†ÅÊ≥®ÂÖ•„ÄÇ

## PEB

```rust
pub struct PEB {
    pub InheritedAddressSpace: u8,
    pub ReadImageFileExecOptions: u8,
    pub BeingDebugged: u8,
    pub Anonymous1: PEB_0,
    pub Mutant: HANDLE,
    pub ImageBaseAddress: *mut c_void,
    pub Ldr: *mut PEB_LDR_DATA,
    pub ProcessParameters: *mut RTL_USER_PROCESS_PARAMETERS,
    pub SubSystemData: *mut c_void,
    pub ProcessHeap: *mut c_void,
    pub FastPebLock: *mut RTL_CRITICAL_SECTION,
    pub AtlThunkSListPtr: *mut SLIST_HEADER,
    pub IFEOKey: *mut c_void,
    pub Anonymous2: PEB_1,
    pub Anonymous3: PEB_2,
    pub SystemReserved: u32,
    pub AtlThunkSListPtr32: u32,
    pub ApiSetMap: *mut API_SET_NAMESPACE,
    pub TlsExpansionCounter: u32,
    pub TlsBitmap: *mut RTL_BITMAP,
    pub TlsBitmapBits: [u32; 2],
    pub ReadOnlySharedMemoryBase: *mut c_void,
    pub SharedData: *mut SILO_USER_SHARED_DATA,
    pub ReadOnlyStaticServerData: *mut c_void,
    pub AnsiCodePageData: *mut c_void,
    pub OemCodePageData: *mut c_void,
    pub UnicodeCaseTableData: *mut c_void,
    pub NumberOfProcessors: u32,
    pub NtGlobalFlag: u32,
    pub CriticalSectionTimeout: LARGE_INTEGER,
    pub HeapSegmentReserve: usize,
    pub HeapSegmentCommit: usize,
    pub HeapDeCommitTotalFreeThreshold: usize,
    pub HeapDeCommitFreeBlockThreshold: usize,
    pub NumberOfHeaps: u32,
    pub MaximumNumberOfHeaps: u32,
    pub ProcessHeaps: *mut c_void,
    pub GdiSharedHandleTable: *mut c_void,
    pub ProcessStarterHelper: *mut c_void,
    pub GdiDCAttributeList: u32,
    pub LoaderLock: *mut RTL_CRITICAL_SECTION,
    pub OSMajorVersion: u32,
    pub OSMinorVersion: u32,
    pub OSBuildNumber: u16,
    pub OSCSDVersion: u16,
    pub OSPlatformId: u32,
    pub ImageSubsystem: u32,
    pub ImageSubsystemMajorVersion: u32,
    pub ImageSubsystemMinorVersion: u32,
    pub ActiveProcessAffinityMask: usize,
    pub GdiHandleBuffer: GDI_HANDLE_BUFFER,
    pub PostProcessInitRoutine: PPS_POST_PROCESS_INIT_ROUTINE,
    pub TlsExpansionBitmap: *mut RTL_BITMAP,
    pub TlsExpansionBitmapBits: [u32; 32],
    pub SessionId: u32,
    pub AppCompatFlags: ULARGE_INTEGER,
    pub AppCompatFlagsUser: ULARGE_INTEGER,
    pub pShimData: *mut c_void,
    pub AppCompatInfo: *mut c_void,
    pub CSDVersion: UNICODE_STRING,
    pub ActivationContextData: *mut ACTIVATION_CONTEXT_DATA,
    pub ProcessAssemblyStorageMap: *mut ASSEMBLY_STORAGE_MAP,
    pub SystemDefaultActivationContextData: *mut ACTIVATION_CONTEXT_DATA,
    pub SystemAssemblyStorageMap: *mut ASSEMBLY_STORAGE_MAP,
    pub MinimumStackCommit: usize,
    pub SparePointers: *mut c_void,
    pub PatchLoaderData: *mut c_void,
    pub ChpeV2ProcessInfo: *mut c_void,
    pub Anonymous4: PEB_3,
    pub SpareUlongs: [u32; 2],
    pub ActiveCodePage: u16,
    pub OemCodePage: u16,
    pub UseCaseMapping: u16,
    pub UnusedNlsField: u16,
    pub WerRegistrationData: *mut WER_PEB_HEADER_BLOCK,
    pub WerShipAssertPtr: *mut c_void,
    pub Anonymous5: PEB_4,
    pub pImageHeaderHash: *mut c_void,
    pub Anonymous6: PEB_5,
    pub CsrServerReadOnlySharedMemoryBase: u64,
    pub TppWorkerpListLock: *mut RTL_CRITICAL_SECTION,
    pub TppWorkerpList: LIST_ENTRY,
    pub WaitOnAddressHashTable: [*mut c_void; 128],
    pub TelemetryCoverageHeader: *mut TELEMETRY_COVERAGE_HEADER,
    pub CloudFileFlags: u32,
    pub CloudFileDiagFlags: u32,
    pub PlaceholderCompatibilityMode: i8,
    pub PlaceholderCompatibilityModeReserved: [i8; 7],
    pub LeapSecondData: *mut c_void, // PLEAP_SECOND_DATA
    pub Anonymous7: PEB_6,
    pub NtGlobalFlag2: u32,
    pub ExtendedFeatureDisableMask: u64,
}
```

- Ëé∑Âèñ PEB,x64: gs:[0x60],x86: fs:[0x30]

ÂÖ≥‰∫éPEBÊúâ‰ª•‰∏ãÈúÄË¶ÅÊ≥®ÊÑè:  

1. **ÁªìÊûÑ‰Ωì‰∏çÈÄèÊòéÊÄß**Ôºö`EPROCESS`, `ETHREAD`, `KPROCESS` Á≠âÂÜÖÊ†∏ÁªìÊûÑ‰ΩìÊòØ **ÈùûÂÖ¨ÂºÄ (Opaque)** ÁöÑ„ÄÇÂæÆËΩØ‰ªéÊú™‰øùËØÅÂÖ∂ÊàêÂëòÂÅèÁßªÈáèÔºàOffsetsÔºâÁöÑÁ®≥ÂÆöÊÄß„ÄÇÊñá‰∏≠Ê†áËÆ∞ÁöÑÂÅèÁßªÈáè‰ªÖ‰∏∫Á§∫‰æãÊàñÁâπÂÆöÂéÜÂè≤ÁâàÊú¨ÔºåÂÆûÊàò‰∏≠**ÂøÖÈ°ª**ÈÄöËøáÁ¨¶Âè∑Êñá‰ª∂ (`.pdb`) ÊàñËøêË°åÊó∂ÁâπÂæÅÁ†ÅÊêúÁ¥¢Âä®ÊÄÅËé∑Âèñ„ÄÇ
2. **ASLR (Âú∞ÂùÄÁ©∫Èó¥Â∏ÉÂ±ÄÈöèÊú∫Âåñ)**ÔºöÁé∞‰ª£ Windows (Vista+) Âº∫Âà∂ÂºÄÂêØ ASLR„ÄÇÊñá‰∏≠Âá∫Áé∞ÁöÑÂÜÖÂ≠òÂú∞ÂùÄ‰ªÖ‰∏∫**ÈÄªËæëÁ§∫ÊÑè**ÔºåÂÆûÈôÖËøêË°åÊó∂Âü∫ÂùÄ„ÄÅÂ†ÜÊ†àÂú∞ÂùÄÊØèÊ¨°ÂêØÂä®Âùá‰∏çÂêå„ÄÇ
3. **Êû∂ÊûÑÈôêÂÆö**ÔºöÊú¨ÊñáÊ†∏ÂøÉÊèèËø∞ **x64 (AMD64)** Êû∂ÊûÑ‰∏ãÁöÑ Windows ËøêË°åÊú∫Âà∂„ÄÇ(Intel 64„ÄÅAMD64 Âíå x86_64ÊåáÁöÑÊòØÂêå‰∏ÄÁßçÊåá‰ª§ÈõÜÊû∂ÊûÑ,Windows Êìç‰ΩúÁ≥ªÁªüÂú®Â∫ïÂ±ÇÈÄöÂ∏∏Áªü‰∏Ä‰ΩøÁî® AMD64 Êù•Ê†áËØÜ 64‰ΩçÊû∂ÊûÑÔºåÊó†ËÆ∫‰Ω†ÁöÑ CPU ÊòØ Intel ËøòÊòØ AMD Áîü‰∫ßÁöÑ„ÄÇ)
4. Âú® Windows ‰∏≠ÔºåÊØè‰∏™ËøõÁ®ãÈÉΩÊúâ‰∏Ä‰∏™ PEB (Process Environment Block).ËøõÁ®ãÔºàProcessÔºâÂú® WindowsÂÜÖÊ†∏ÂØπË±°ÔºàEPROCESSÔºâÁöÑÂÆö‰πâ‰∏≠ÔºåÂ∞±ÊòØËµÑÊ∫êÂíåÂú∞ÂùÄÁ©∫Èó¥ÁöÑÂÆπÂô®„ÄÇËÄå PEBÊòØËøô‰∏™ÂÆπÂô®Âú®Áî®Êà∑Ê®°ÂºèÔºàUser ModeÔºâ‰∏ãÁöÑÁÆ°ÁêÜÁªìÊûÑ„ÄÇÂΩìÂÜÖÊ†∏ÂàõÂª∫‰∏Ä‰∏™Êñ∞ËøõÁ®ãÊó∂ÔºàNtCreateUserProcessÔºâÔºåÂÆÉÂøÖÈ°ªÂú®ÂàÜÈÖçÁöÑËôöÊãüÂú∞ÂùÄÁ©∫Èó¥‰∏≠Êò†Â∞ÑÂπ∂ÂàùÂßãÂåñ‰∏Ä‰∏™ PEB„ÄÇÊ≤°Êúâ PEBÔºåntdll.dll Êó†Ê≥ïÂàùÂßãÂåñÔºåÁî®Êà∑Ê®°ÂºèÁöÑ‰ª£Á†ÅÔºàÂåÖÊã¨ mainÂáΩÊï∞ÔºâÊ†πÊú¨Êó†Ê≥ïÂºÄÂßãÊâßË°å„ÄÇ

### ‰∏Ä‰∏™ÂèØÊâßË°åÊñá‰ª∂‰∫ßÁîüÂ§ö‰∏™ËøõÁ®ãÊó∂PEBÊòØÊÄé‰πàÊ†∑ÁöÑ?

‰∏Ä‰∏™ÂèØÊâßË°åÊñá‰ª∂‰∫ßÁîüÂ§ö‰∏™ËøõÁ®ã,‰ΩÜËøô‰∏çÊîπÂèò‚ÄúÊØè‰∏™ËøõÁ®ãÊúâ‰∏Ä‰∏™ PEB‚ÄùÁöÑ‰∫ãÂÆû„ÄÇ

‰∏Ä‰∏™ÂèØÊâßË°åÊñá‰ª∂‰∫ßÁîü‰∫ÜÂ§ö‰∏™ËøõÁ®ãÔºåÊÉÖÂÜµÂ¶Ç‰∏ãÔºö  

1. Â§öÂºÄÔºàMultiple InstancesÔºâ:Â§öÊ¨°ÊâìÂºÄÂêå‰∏Ä‰∏™ÂèØÊâßË°åÊñá‰ª∂.Á≥ªÁªüÂàõÂª∫‰∫Ü‰∏§‰∏™ÂÆåÂÖ®Áã¨Á´ãÁöÑËøõÁ®ãÔºàPID 1001 Âíå PID 1002Ôºâ.PEB: ÂÆÉ‰ª¨ÂêÑËá™Êã•ÊúâËá™Â∑±Áã¨Á´ãÁöÑ PEB„ÄÇËôΩÁÑ∂ÂÆÉ‰ª¨Êù•Ëá™Âêå‰∏Ä‰∏™ .exeÊñá‰ª∂Ôºå‰ΩÜÂÆÉ‰ª¨Âú®ÂÜÖÂ≠ò‰∏≠ÊòØ‰∏§‰∏™‰∫í‰∏çÁõ∏Âπ≤ÁöÑ‰∏ñÁïå„ÄÇ
2. Áà∂Â≠êËøõÁ®ãÔºàSpawning Child ProcessesÔºâ:Âú®‰∏Ä‰∏™ÂèØÊâßË°åÊñá‰ª∂‰∏≠,Ë∞ÉÁî® CreateProcess("myapp.exe") Ëá™ÊàëÂ§çÂà∂.ÁªìÊûú: ‰∏Ä‰∏™Áà∂ËøõÁ®ãÔºå‰∏Ä‰∏™Â≠êËøõÁ®ã„ÄÇ PEB: ‰æùÁÑ∂ÊòØ‰∏§‰∏™Áã¨Á´ãÁöÑ PEB„ÄÇ
3. Â§öÁ∫øÁ®ãÔºàMulti-threadingÔºâ:ËøôÊòØÊúÄÂÆπÊòìÊ∑∑Ê∑ÜÁöÑ„ÄÇ‰∏Ä‰∏™ËøõÁ®ãÂèØ‰ª•ÂåÖÂê´Â§ö‰∏™Á∫øÁ®ã„ÄÇÁªìÊûú: 1 ‰∏™ËøõÁ®ãÔºåN ‰∏™Á∫øÁ®ã„ÄÇPEB: ÊâÄÊúâËøô N ‰∏™Á∫øÁ®ãÂÖ±‰∫´Âêå‰∏Ä‰∏™ PEBÔºàÂõ†‰∏∫ÂÆÉ‰ª¨Â±û‰∫éÂêå‰∏Ä‰∏™ËøõÁ®ãÔºâ TEB: ÊØè‰∏™Á∫øÁ®ãÊã•ÊúâËá™Â∑±Áã¨Á´ãÁöÑ TEB (Thread Environment Block)„ÄÇ

Êó†ËÆ∫‰∏Ä‰∏™ .exe ÂêØÂä®‰∫ÜÂ§öÂ∞ëÊ¨°ÔºåÊàñËÄÖÂÆÉËá™Â∑±ÂèàÊ¥æÁîü‰∫ÜÂ§öÂ∞ëÂ≠êËøõÁ®ãÔºåÂè™Ë¶ÅÈÇ£ÊòØ Windows‰∏äÁöÑ‰∏Ä‰∏™Ê†áÂáÜ Win32 ËøõÁ®ãÔºåÂÆÉÂ∞±‰∏ÄÂÆöÊã•Êúâ‰∏Ä‰∏™Â±û‰∫éÂÆÉËá™Â∑±ÁöÑ„ÄÅÁã¨‰∏ÄÊó†‰∫åÁöÑ PEB„ÄÇ

### LDR

Ldr ÊòØ‰∏Ä‰∏™ÊåáÂêë PEB_LDR_DATA ÁªìÊûÑ‰ΩìÁöÑÊåáÈíà (*mut PEB_LDR_DATA)„ÄÇ

ÂÆÉÊåáÂêë‰∫ÜÂÖ≥‰∫éËøõÁ®ãÂ∑≤Âä†ËΩΩÊ®°ÂùóÔºàÂ¶Ç DLLsÔºâÁöÑËØ¶ÁªÜ‰ø°ÊÅØ„ÄÇÊìç‰ΩúÁ≥ªÁªüÂä†ËΩΩÂô®ÔºàLoaderÔºâ‰ΩøÁî®Ëøô‰∏™ÁªìÊûÑÊù•Áª¥Êä§ÊâÄÊúâÂä†ËΩΩÂà∞ËØ•ËøõÁ®ãÂú∞ÂùÄÁ©∫Èó¥ÁöÑÊ®°ÂùóÈìæË°®„ÄÇ

- Rust Á±ªÂûã: Âú® dinvk ‰∏≠ÔºåÂÆÉË¢´ÂÆö‰πâ‰∏∫Ë£∏ÊåáÈíàÔºåÊÑèÂë≥ÁùÄËÆøÈóÆÂÆÉÈúÄË¶Å‰ΩøÁî®unsafe ‰ª£Á†ÅÂùó„ÄÇ

### PEB_LDR_DATA

```rust
#[repr(C)]
pub struct PEB_LDR_DATA {
    pub Length: u32,
    pub Initialized: u8,
    pub SsHandle: HANDLE,
    pub InLoadOrderModuleList: LIST_ENTRY,
    pub InMemoryOrderModuleList: LIST_ENTRY,
    pub InInitializationOrderModuleList: LIST_ENTRY,
    pub EntryInProgress: *mut c_void,
    pub ShutdownInProgress: u8,
    pub ShutdownThreadId: HANDLE,
}
```

ÊòØ Windows Êìç‰ΩúÁ≥ªÁªüÂÜÖÈÉ®Áî®‰∫éÊèèËø∞ÊØè‰∏Ä‰∏™Â∑≤Âä†ËΩΩÊ®°ÂùóÔºàDLL Êàñ EXEÔºâÁöÑÂÖÉÊï∞ÊçÆÁªìÊûÑ  
ÈÄöËøáPEB‰∏≠ÁöÑ‰∏Ä‰∏™`pub Ldr: *mut PEB_LDR_DATA,`Â≠óÊÆµÊåáÂêëPEB_LDR_DATAËøô‰∏™ÁªìÊûÑ

### InMemoryOrderModuleList

`InMemoryOrderModuleList` Âπ∂ÈùûÂ¶ÇÂÖ∂ÂêçÁß∞ÊöóÁ§∫ÁöÑÈÇ£Ê†∑"ÊåâÂÜÖÂ≠òÂú∞ÂùÄÈ´ò‰ΩéÊéíÂ∫è"ÔºåËøôÊòØ‰∏Ä‰∏™Âú®ÂÆâÂÖ®Á†îÁ©∂ÂíåÈÄÜÂêëÂ∑•Á®ãÁ§æÂå∫‰∏≠ÂπøÊ≥õÊµÅ‰º†ÁöÑËØØËß£„ÄÇ  
ÂÆûÈôÖ‰∏äÔºåËøô‰∏™ÈìæË°®‰∏ªË¶ÅÂèçÊò†**Ê®°ÂùóÂú®ÂÜÖÂ≠ò‰∏≠ÁöÑÂ∏ÉÂ±ÄÈ°∫Â∫èÂíåÂàùÂßãÂåñÂÖ≥Á≥ª**ÔºåËÄåÈùûÁÆÄÂçïÁöÑÂú∞ÂùÄÈ´ò‰ΩéÊéíÂ∫è„ÄÇ

InMemoryOrderModuleListÁöÑÁªìÊûÑ‰Ωì‰∏≠Âè™Êúâ‰∏§‰∏™ÊåáÈíà Flink (ÂâçÂêë) Âíå Blink (ÂêéÂêë)Ôºå‰∏çÂåÖÂê´ DLL ‰ø°ÊÅØ  
ÂêåÊ†∑ÈúÄË¶ÅÊ≥®ÊÑèInMemoryOrderModuleList.flinkÊåáÂêëÁöÑÊòØLDR_DATA_TABLE_ENTRYËøô‰∏™ÁªìÊûÑ‰ΩìÁöÑ**‰∏≠Èó¥‰ΩçÁΩÆ(‰∏çÊòØÁ¨¨‰∏Ä‰∏™Â≠óÊÆµ)**,Âç≥ÊòØ‰∏ÄÁßçÊâãÊãâÊâãÁöÑÂèåÂêëÈìæË°®,ËÄå‰∏çÊòØÊâãÊãâÂ§¥ÁöÑÂèåÂêëÈìæË°®:

Windows Â∞Ü `LIST_ENTRY` **ÂµåÂÖ•**Âà∞ `LDR_DATA_TABLE_ENTRY` ÁªìÊûÑ‰Ωì‰∏≠ÔºàÈÄöÂ∏∏Âú®ÂÅèÁßª `0x10` Â§Ñ‰∏∫ `InMemoryOrderLinks`Ôºâ„ÄÇ  
Âõ†Ê≠§ÔºåÂΩì‰Ω†ÊãøÂà∞ `Flink` ÊåáÈíàÊó∂ÔºåÂÆÉÊåáÂêëÁöÑÊòØÁõÆÊ†áÁªìÊûÑ‰ΩìÂÜÖÈÉ®ÁöÑ `InMemoryOrderLinks` Â≠óÊÆµÔºàÂÅèÁßª `0x10`ÔºâÔºåËÄåÈùûÁªìÊûÑ‰ΩìËµ∑ÂßãÂú∞ÂùÄ„ÄÇ

- Flink ÊåáÂêëÁöÑÊòØ‰∏ã‰∏Ä‰∏™Ê®°ÂùóÁªìÊûÑ‰Ωì‰∏≠ÂØπÂ∫îÁöÑÈÇ£‰∏™ `InMemoryOrderLinks`Â≠óÊÆµÁöÑÂú∞ÂùÄ„ÄÇ
- ÂÆÉ‰∏çÊåáÂêë‰∏ã‰∏Ä‰∏™ÁªìÊûÑ‰ΩìÁöÑÂ§¥ÈÉ® (Base)„ÄÇ

InMemoryOrderModuleList,Âú®ÂÆûÈôÖÁöÑËøêË°å‰∏≠,Ê†πÊçÆWindows Âä†ËΩΩÂô®ÂàùÂßãÂåñÊ®°ÂùóÁöÑÈ°∫Â∫èÊòØÈõ∑Êâì‰∏çÂä®ÁöÑÔºö

- HeadÔºöÈìæË°®Â§¥ÔºàPEB_LDR_DATA ÂÜÖÈÉ®Ôºâ„ÄÇ
- Node 1Ôºö‰∏ªÁ®ãÂ∫è (.exe)ÔºàÁ¨¨‰∏Ä‰∏™Âä†ËΩΩÔºâ„ÄÇ
- Node 2Ôºöntdll.dllÔºàÁ¨¨‰∫å‰∏™Âä†ËΩΩÔºåË¥üË¥£Áî®Êà∑Â±Ç‰∏éÂÜÖÊ†∏Â±ÇÁöÑ‰∫§‰∫íÔºâ„ÄÇ
- Node 3Ôºökernel32.dllÔºàÈÄöÂ∏∏ÊÉÖÂÜµÔºâ„ÄÇ
- ‰ª£Á†ÅÈÄªËæëÔºö‰ªé Head ÂºÄÂßãÔºåÊâßË°å‰∏§Ê¨° Flink Ë∑≥ËΩ¨ÔºåÁêÜÂ∫îÂà∞Ëææntdll.dll„ÄÇ‰∏∫‰∫Ü‰øùÈô©Ôºå‰ª£Á†ÅËøòËÆ°ÁÆó‰∫ÜÊ®°ÂùóÂêçÁöÑ Hash ËøõË°åÊ†°È™å„ÄÇ

### LDR_DATA_TABLE_ENTRY

```rust
#[repr(C)]
//‰∏éverg‰∏≠_LDR_DATA_TABLE_ENTRYÁõ∏ÂØπÂ∫î
pub struct LDR_DATA_TABLE_ENTRY {
    pub Reserved1: [*mut c_void; 2],//ËØ•Â≠óÊÆµÂ§ßÂ∞è16Â≠óËäÇ,Âõ†‰∏∫Âú®repr(c)Ê®°Âºè‰∏ã64 bit os‰∏Ä‰∏™ÊåáÈíàÂç†Áî®8Â≠óËäÇ
    pub InMemoryOrderLinks: LIST_ENTRY,
    pub Reserved2: [*mut c_void; 2],
    pub DllBase: *mut c_void,
    pub Reserved3: [*mut c_void; 2],
    pub FullDllName: UNICODE_STRING,
    pub Reserved4: [u8; 8],
    pub Reserved5: [*mut c_void; 3],
    pub Anonymous: LDR_DATA_TABLE_ENTRY_0,
    pub TimeDateStamp: u32,
}
```

ÊòØ WindowsÊìç‰ΩúÁ≥ªÁªüÂä†ËΩΩÂô®ÔºàLoaderÔºâÁî®Êù•ÁÆ°ÁêÜÊØè‰∏Ä‰∏™Â∑≤Âä†ËΩΩÊ®°ÂùóÔºàDLL Êàñ
EXEÔºâÁöÑÊ†∏ÂøÉÊï∞ÊçÆÁªìÊûÑ„ÄÇ  

- ÂÆÉ‰∏çÂú® PEB ‰∏≠Áõ¥Êé•ÂÆö‰πâÔºåËÄåÊòØÈÄöËøáÈìæË°®‰ªé PEB Èó¥Êé•ÂèØËææ„ÄÇ
- dinvk ÊâãÂä®ÂÆö‰πâËØ•ÁªìÊûÑÊòØ‰∏∫‰∫Ü**Á≤æÁ°ÆÂåπÈÖçÂÜÖÂ≠òÂ∏ÉÂ±Ä**ÔºåÂÆûÁé∞Êó† API ÁöÑÊ®°ÂùóÈÅçÂéÜ„ÄÇ
- ÂøÖÈ°ª‰ΩøÁî®#[repr(c)],ÂåπÈÖçwindowsÁöÑÂÜÖÂ≠òÂ∏ÉÂ±Ä

‰Ωç‰∫éÂ†Ü‰∏ä, Âõ†‰∏∫ LDR_DATA_TABLE_ENTRY Âè™ÊòØÂ†Ü‰∏äÁöÑÊôÆÈÄöÊï∞ÊçÆÔºåÁ∫¢ÈòüÊäÄÊúØ‰∏≠ÁöÑ "Êñ≠ÈìæÈöêËóè"(Module Unlinking) Â∞±ÊòØÊâãÂä®Êìç‰Ωú Flink Âíå BlinkÊåáÈíàÔºåÊääËá™Â∑±‰ªéÈìæË°®‰∏≠ÁßªÈô§Ôºå‰ΩÜ‰∏çÈáäÊîæÂÜÖÂ≠ò„ÄÇËøôÊ†∑ FreeLibrary Êó†Ê≥ïÂç∏ËΩΩÂÆÉÔºå‰∏îÈÅçÂéÜ PEBÁöÑÂ∑•ÂÖ∑ÔºàÂ¶Ç‰ªªÂä°ÁÆ°ÁêÜÂô®Ôºâ‰πüÁúã‰∏çÂà∞ÂÆÉ„ÄÇ

Âπ∂ÂèëÂÆâÂÖ®: Windows Âä†ËΩΩÂô®Âú®Êìç‰ΩúËøô‰∫õÈìæË°®Êó∂‰ºöÊåÅÊúâ PEB->LoaderLock (‰πüÂ∞±ÊòØLdrLockLoaderLock)„ÄÇÂ¶ÇÊûúÂú®‰Ω†ÁöÑ Rust‰ª£Á†Å‰∏≠ÊâãÂä®ÈÅçÂéÜËøô‰∫õÈìæË°®‰∏î‰∏çËé∑ÂèñÈîÅÔºåÁêÜËÆ∫‰∏äÂ≠òÂú®Á´û‰∫âÊù°‰ª∂ÔºàËôΩÁÑ∂Âú®ÂçïÁ∫øÁ®ã Shellcode‰∏≠ÈÄöÂ∏∏ÂøΩÁï•‰∏çËÆ°Ôºâ„ÄÇ

#### LDR_DATA_TABLE_ENTRYÂ¶Ç‰Ωï‰∫ßÁîüÂπ∂Áª¥Êä§?

LDR_DATA_TABLE_ENTRY ÁªìÊûÑ‰ΩìÂÆåÂÖ®Áî± Windows Áî®Êà∑Ê®°ÂºèÂä†ËΩΩÂô® (User Mode Loader) ‰∫ßÁîüÂíåÁª¥Êä§ÔºåÂÖ∑‰ΩìÂÆûÁé∞‰Ωç‰∫é `ntdll.dll` ‰∏≠„ÄÇ

ÂÆÉ‰∏çÊòØÂÜÖÊ†∏ÂØπË±°ÔºåËÄåÊòØÂ≠òÂú®‰∫éËøõÁ®ãÁßÅÊúâÂ†ÜÔºàProcess HeapÔºâ‰∏≠ÁöÑÊôÆÈÄöÊï∞ÊçÆÁªìÊûÑ„ÄÇËøôÊÑèÂë≥ÁùÄÊã•ÊúâËØ•ËøõÁ®ãÊùÉÈôêÁöÑ‰ª£Á†ÅÔºàÂåÖÊã¨‰Ω†ÁöÑ dinvkÈ°πÁõÆÔºâÂèØ‰ª•ÈöèÊÑèËØªÂèñÁîöËá≥‰øÆÊîπÂÆÉ„ÄÇ  
‰ª•‰∏ãÊòØÂÖ∂ÁîüÂëΩÂë®ÊúüÁöÑËØ¶ÁªÜËøáÁ®ãÔºö

##### ‰∫ßÁîü (Creation)

ÂΩì‰∏Ä‰∏™Ê®°ÂùóÔºà.exe Êàñ .dllÔºâË¢´Êò†Â∞ÑÂà∞ËøõÁ®ãÂÜÖÂ≠òÊó∂Ôºåntdll.dll‰∏≠ÁöÑÂä†ËΩΩÂô®‰ª£Á†Å‰ºöÂàõÂª∫Ëøô‰∏™ÁªìÊûÑ„ÄÇ

- ÈùôÊÄÅÂØºÂÖ• (ËøõÁ®ãÂêØÂä®Êó∂):
ÂΩìËøõÁ®ãÂàöÂêØÂä®ÔºåÂÜÖÊ†∏ÂÆåÊàêÂü∫Êú¨ÁöÑÂÜÖÂ≠òÊò†Â∞ÑÂêéÔºåÊâßË°åÊùÉ‰∫§Áªô
ntdll!LdrInitializeThunk„ÄÇÂÆÉ‰ºöË∞ÉÁî® LdrpInitializeProcessÔºå‰∏∫‰ª•‰∏ãÊ®°ÂùóÂàÜÈÖçÂπ∂ÂàùÂßãÂåñLDR_DATA_TABLE_ENTRYÔºö

1. Ëá™Ë∫´ (ntdll.dll)
2. ‰∏ªÊâßË°åÊñá‰ª∂ (.exe)
3. ÈùôÊÄÅÂØºÂÖ•Ë°®‰∏≠ÁöÑÊâÄÊúâ DLL (Â¶Ç kernel32.dll)

- Âä®ÊÄÅÂä†ËΩΩ (ËøêË°åÊó∂):
ÂΩì‰Ω†Ë∞ÉÁî® LoadLibrary (Win32 API) Êó∂ÔºåË∞ÉÁî®ÈìæÂ¶Ç‰∏ãÔºö  
LoadLibraryW -> KernelBase!LoadLibraryExW -> ntdll!LdrLoadDll ->`ntdll!LdrpLoadDll`  

Âú® LdrpLoadDll ÂÜÖÈÉ®ÔºàÂÖ∑‰ΩìÂáΩÊï∞ÂêçÈöè Windows ÁâàÊú¨ÂèØËÉΩÂèòÂåñÔºåÂ¶ÇLdrpAllocateDataTableEntryÔºâÔºåÂä†ËΩΩÂô®‰ºöÊâßË°å‰ª•‰∏ãÊìç‰ΩúÔºö

1. Ë∞ÉÁî® RtlAllocateHeap ‰ªéËøõÁ®ãÈªòËÆ§Â†Ü‰∏≠ÂàÜÈÖç‰∏ÄÂùóÂÜÖÂ≠òÔºåÂ§ßÂ∞è‰∏∫sizeof(LDR_DATA_TABLE_ENTRY)„ÄÇ
2. Â°´ÂÖÖÁªìÊûÑ‰ΩìÂ≠óÊÆµÔºö

- DllBase: Â°´ÂÖ•Ê®°ÂùóÊò†Â∞ÑÁöÑÂü∫ÂùÄ„ÄÇ
- FullDllName / BaseDllName: ÂàÜÈÖçÂπ∂Â°´ÂÖ•Ë∑ØÂæÑÂ≠óÁ¨¶‰∏≤„ÄÇ
- LoadCount: ÂàùÂßãÂåñÂºïÁî®ËÆ°Êï∞„ÄÇ

1. Ë∞ÉÁî® LdrpInsertDataTableEntry Â∞ÜËøô‰∏™Êñ∞ËäÇÁÇπÊèíÂÖ•Âà∞ PEB->Ldr ÁöÑ‰∏â‰∏™ÈìæË°®‰∏≠(InLoadOrder, InMemoryOrder, InInitializationOrder)„ÄÇ

##### Áª¥Êä§ (Maintenance)

Âú®Ê®°ÂùóÁöÑÁîüÂëΩÂë®ÊúüÂÜÖÔºåntdll.dll Ë¥üË¥£Áª¥Êä§ÂÖ∂Áä∂ÊÄÅÔºö

- ÂºïÁî®ËÆ°Êï∞ (`LoadCount`):  
Â¶ÇÊûúÂêå‰∏Ä‰∏™ DLL Ë¢´ LoadLibrary Âä†ËΩΩÂ§öÊ¨°ÔºåÂä†ËΩΩÂô®‰∏ç‰ºöÈáçÊñ∞Êò†Â∞ÑÊñá‰ª∂ÔºåËÄåÊòØÊâæÂà∞Áé∞ÊúâÁöÑLDR_DATA_TABLE_ENTRYÔºåÂ∞ÜÂÖ∂ LoadCount Âä† 1„ÄÇ
- ÈáçÂÆö‰Ωç‰∏é‰øÆÂ§ç:  
Âä†ËΩΩÂô®‰ºöÊõ¥Êñ∞ÁªìÊûÑ‰∏≠ÁöÑÊ†áËÆ∞ÔºàFlagsÔºâÔºåË°®ÊòéËØ•Ê®°ÂùóÊòØÂê¶Â∑≤ÂÆåÊàêÈáçÂÆö‰Ωç„ÄÅÊòØÂê¶Â∑≤ÊâßË°å TLSÂõûË∞ÉÁ≠â„ÄÇ

##### ÈîÄÊØÅ (Destruction)

ÂΩì‰Ω†Ë∞ÉÁî® `FreeLibrary` Êó∂ÔºåWindows Âä†ËΩΩÂô®‰ºöÊâßË°å‰ª•‰∏ãÂç∏ËΩΩÊµÅÁ®ãÔºö

1. **Ë∞ÉÁî® `ntdll!LdrUnloadDll`**  
   Áî®Êà∑ÊÄÅÁöÑ `FreeLibrary` ÊúÄÁªà‰ºöËøõÂÖ•ÂÜÖÊ†∏Ê®°ÂºèÂä†ËΩΩÂô®ÂáΩÊï∞ `LdrUnloadDll`„ÄÇ

2. **ÈÄíÂáèÂºïÁî®ËÆ°Êï∞**  
   Âä†ËΩΩÂô®Â∞ÜÁõÆÊ†áÊ®°ÂùóÂØπÂ∫îÁöÑ `LDR_DATA_TABLE_ENTRY` ‰∏≠ÁöÑ `LoadCount` Â≠óÊÆµÂáè 1„ÄÇ

3. **Ê£ÄÊü•ÊòØÂê¶ÁúüÊ≠£Âç∏ËΩΩ**  
   Â¶ÇÊûú `LoadCount` Èôç‰∏∫ 0Ôºà‰∏îËØ• DLL Êú™Ë¢´Ê†áËÆ∞‰∏∫‚ÄúÊ∞∏‰πÖÂä†ËΩΩ‚ÄùÁöÑÁ≥ªÁªüÊ®°ÂùóÔºåÂ¶Ç `ntdll.dll`ÔºâÔºåÂàôÂêØÂä®ÂÆåÊï¥ÁöÑÂç∏ËΩΩÊµÅÁ®ãÔºö
   - **ÊâßË°å `DllMain` ÂõûË∞É**  
     Ë∞ÉÁî®ËØ• DLL ÁöÑÂÖ•Âè£ÁÇπÂáΩÊï∞ÔºåÂπ∂‰º†ÂÖ• `DLL_PROCESS_DETACH` ÈÄöÁü•ÂÖ∂Âç≥Â∞ÜË¢´Âç∏ËΩΩ„ÄÇ
   - **‰ªéÊ®°ÂùóÈìæË°®‰∏≠ÁßªÈô§ËäÇÁÇπÔºàUnlinkÔºâ**  
     Â∞ÜËØ• `LDR_DATA_TABLE_ENTRY` ‰ªé PEB ‰∏≠ÁöÑ‰∏âÊù°ÈìæË°®‰∏≠ÊëòÈô§Ôºö
     - `InLoadOrderModuleList`
     - `InMemoryOrderModuleList`
     - `InInitializationOrderModuleList`
   - **ÈáäÊîæÂ≠óÁ¨¶‰∏≤ËµÑÊ∫ê**  
     ÈáäÊîæ `FullDllName` Âíå `BaseDllName` Á≠â `UNICODE_STRING` ÊâÄÊåáÂêëÁöÑÂä®ÊÄÅÂàÜÈÖçÂÜÖÂ≠ò„ÄÇ
   - **ÈáäÊîæÂÖÉÊï∞ÊçÆÁªìÊûÑ**  
     Ë∞ÉÁî® `RtlFreeHeap` ÈáäÊîæ `LDR_DATA_TABLE_ENTRY` ÁªìÊûÑ‰ΩìÊú¨Ë∫´ÊâÄÂç†Áî®ÁöÑÂ†ÜÂÜÖÂ≠ò„ÄÇ
   - **Ëß£Èô§ÂÜÖÂ≠òÊò†Â∞Ñ**  
     Ë∞ÉÁî®ÂÜÖÂ≠òÁÆ°ÁêÜÂô®Ëß£Èô§ÂØπËØ• DLL Êò†ÂÉèÁöÑÂÜÖÂ≠òÊò†Â∞ÑÔºàÂç≥‰ªéËøõÁ®ãÂú∞ÂùÄÁ©∫Èó¥‰∏≠ÁßªÈô§ÂÖ∂‰ª£Á†ÅÂíåÊï∞ÊçÆÊÆµÔºâ„ÄÇ

> üí° Ê≥®ÊÑèÔºöÂ¶ÇÊûú `LoadCount > 0`Ôºå‰ªÖÈÄíÂáèËÆ°Êï∞Ôºå**‰∏ç‰ºöÊâßË°åÂÆûÈôÖÂç∏ËΩΩ**„ÄÇËøô‰πüÊòØ‰∏∫‰ªÄ‰πàÂ§öÊ¨°Ë∞ÉÁî® `LoadLibrary` ÈúÄË¶ÅÂØπÂ∫îÂ§öÊ¨° `FreeLibrary` ÊâçËÉΩÁúüÊ≠£Âç∏ËΩΩÊ®°Âùó„ÄÇ

- ‰∏∫‰ªÄ‰πàÂú® PEB ‰∏≠‚ÄúÊ≤°ÊúâÁõ¥Êé•ÁúãÂà∞‚ÄùÂÆÉÔºü(‰∏çÊòØPEBÁöÑÂ≠óÊÆµ‰πã‰∏Ä)

‰Ω†ÂÖ∂ÂÆûÂ∑≤ÁªèÂú® PEB ‰∏≠ÊâæÂà∞‰∫ÜÂÆÉÁöÑÂÖ•Âè£ÔºåÂè™ÊòØÂÆÉ‰ª•**ÈìæË°®ËäÇÁÇπ**ÁöÑÂΩ¢ÂºèÂ≠òÂú®ÔºåËÄå‰∏çÊòØÁõ¥Êé•ÂÜÖÂµåÂú® PEB ‰∏≠„ÄÇ  
ÂÜÖÂ≠òÁªìÊûÑÁ§∫ÊÑèÔºö

```text
[ TEB ]
  |
  +-> [ PEB ]
        |
        +-> Ldr (ÊåáÂêë PEB_LDR_DATA)
              |
              +-> InMemoryOrderModuleList (LIST_ENTRY ÈìæË°®Â§¥)
                    |
                    v
              [ LDR_DATA_TABLE_ENTRY A ] <-> [ LDR_DATA_TABLE_ENTRY B ] <-> ...
                    ^                          ^
                    |                          |
              LIST_ENTRY ËäÇÁÇπ           LIST_ENTRY ËäÇÁÇπ
```

Ê†áÂáÜ Windows SDKÔºàÂ¶Ç `windows-sys`ÔºâÈÄöÂ∏∏**‰∏çÂÖ¨ÂºÄÂÆåÊï¥Â≠óÊÆµ**ÔºåÂéüÂõ†ÂåÖÊã¨Ôºö

- ÂæÆËΩØÂ∞ÜÂÖ∂ËßÜ‰∏∫‚ÄúÂÜÖÈÉ®ÂÆûÁé∞ÁªÜËäÇ‚ÄùÔºàUndocumentedÔºâ
- ‰∏∫ÂÖºÂÆπÊÄßÈöêËóèÈÉ®ÂàÜÂ≠óÊÆµ
- ‰∏çÂêå Windows ÁâàÊú¨ÁªìÊûÑÂèØËÉΩÂèòÂåñ

Âõ†Ê≠§Ôºådinvk Âú® `src/types.rs` ‰∏≠**ÊâãÂä®ÂÆö‰πâ**‰∫Ü‰∏Ä‰∏™‰∏éÁúüÂÆûÂÜÖÂ≠òÂ∏ÉÂ±Ä‰∏ÄËá¥ÁöÑÁâàÊú¨

### ImageBaseAddress

ImageBaseAddress ÊòØ PEB ÁªìÊûÑ‰Ωì‰∏≠ÁöÑ‰∏Ä‰∏™ÈáçË¶ÅÂ≠óÊÆµÔºàÈÄöÂ∏∏Âú®ÂÅèÁßª 0x10 Â§ÑÔºâ

- ÂÆÉÂ≠òÂÇ®‰∫ÜÂΩìÂâçËøõÁ®ãÁöÑ‰∏ªÊ®°ÂùóÔºà‰πüÂ∞±ÊòØÂêØÂä®Ëøô‰∏™ËøõÁ®ãÁöÑ .exeÊñá‰ª∂ÔºâË¢´Âä†ËΩΩÂà∞ÂÜÖÂ≠ò‰∏≠ÁöÑËµ∑Âßã‰ΩçÁΩÆ„ÄÇ
- ÂØπ‰∫éÂ§ßÂ§öÊï∞ 64 ‰ΩçÁ®ãÂ∫èÔºåÈªòËÆ§ÊÉÖÂÜµ‰∏ãËøô‰∏™Âú∞ÂùÄÂèØËÉΩÊòØ0x140000000ÔºåÊàñËÄÖÊòØÂõ†ASLRÔºàÂú∞ÂùÄÁ©∫Èó¥Â∏ÉÂ±ÄÈöèÊú∫ÂåñÔºâËÄåÈöèÊú∫ÁîüÊàêÁöÑÊüê‰∏™Âú∞ÂùÄ„ÄÇ

## let mut data_table_entry = (*ldr_data).InMemoryOrderModuleList.Flink as*const LDR_DATA_TABLE_ENTRY

ËøôÈáåÁöÑasÊúâÁÇπÂ§çÊùÇ,asËΩ¨Êç¢Áõ¥Êé•ÊääË£∏Âú∞ÂùÄÂèòÊàê‰∫ÜÂèØÊìç‰ΩúÁöÑÁªìÊûÑ‰ΩìÂØπË±°„ÄÇÂè™Ë¶ÅÂú∞ÂùÄÊï∞ÂÄºÊ≠£Á°ÆÔºå‰∏îÁªìÊûÑ‰ΩìÂ∏ÉÂ±ÄÂåπÈÖçÔºå‰Ω†Â∞±ÂèØ‰ª•Áõ¥Êé•ÂÉèÊìç‰ΩúÊôÆÈÄöÂØπË±°‰∏ÄÊ†∑Ëß£ÂºïÁî®ÂíåËÆøÈóÆÂ≠óÊÆµ„ÄÇ

### Áâ©ÁêÜ‰∫ãÂÆû (Memory Reality)

- Flink ÊåáÈíàÈáåÂ≠òÁöÑÊï∞ÂÄºÊòØ `0x1000`ÔºàÂÅáËÆæËøôÊòØÊüê‰∏™Ê®°Âùó `InMemoryOrderLinks` ÁöÑÂú∞ÂùÄÔºâ„ÄÇ
- Áî±‰∫é `InMemoryOrderLinks` Âú®ËØ•Ê®°ÂùóÁúüÊ≠£ÁöÑËµ∑Âßã‰ΩçÁΩÆÔºà`0x0F90`ÔºâÂæÄÂêé 16 Â≠óËäÇÂ§ÑÔºåÊâÄ‰ª•Áâ©ÁêÜÂú∞ÂùÄÂ∞±ÊòØ `0x1000`„ÄÇ

### ÁºñËØëÂô®ÁöÑ‚ÄúÈîôËßâ‚Äù (Compiler's View)

ÂΩì‰Ω†ÊâßË°å `as *const LDR_DATA_TABLE_ENTRY` Êó∂Ôºö

- **Êåá‰ª§Â±ÇÈù¢**ÔºöËøôË°å‰ª£Á†ÅÂú®ÁîüÊàêÁöÑÊ±áÁºñÈáåÈÄöÂ∏∏‰∏ç‰∫ßÁîü‰ªª‰ΩïÊåá‰ª§ÔºåÂÆÉÂè™ÊòØÊîπÂèò‰∫ÜÁºñËØëÂô®Ë¥¶Êú¨‰∏äÁöÑ‰∏Ä‰∏™Ê†áËÆ∞„ÄÇ
- **ËÆ§Áü•Â±ÇÈù¢**Ôºö‰Ω†ÂëäËØâÁºñËØëÂô®Ôºö‚Äú‰ªéÁé∞Âú®ÂºÄÂßãÔºåÊää `0x1000` Ëøô‰∏™Âú∞ÂùÄÁúã‰ΩúÊòØ `LDR_DATA_TABLE_ENTRY` ÁªìÊûÑ‰ΩìÁöÑÁ¨¨ 0 ‰∏™Â≠óËäÇ„ÄÇ‚Äù

### ÁªìÊûúÔºöÂÅèÁßªÈáèÁöÑ‚ÄúÂπ≥Áßª‚Äù

Âõ†‰∏∫ÁºñËØëÂô®ËÆ§‰∏∫ `0x1000` ÊòØ `0x00`ÔºåÈÇ£‰πàÂΩì‰Ω†Âú®‰ª£Á†ÅÈáåËÆøÈóÆÊüê‰∏™Â≠óÊÆµÔºàÊØîÂ¶ÇÂÅèÁßª‰∏∫ `0x48` ÁöÑÂ≠óÊÆµÔºâÊó∂Ôºö

- **ÁºñËØëÂô®ËÆ°ÁÆó**ÔºöÂΩìÂâç‰ΩçÁΩÆ (`0x1000`) + Â≠óÊÆµÂÅèÁßª (`0x48`) = `0x1048`„ÄÇ
- **Áâ©ÁêÜÂØπÊØî**ÔºöÂú®ÁúüÂÆûÁöÑÂÜÖÂ≠òÂ∏ÉÂ±Ä‰∏≠Ôºå`0x1048` ÂØπÂ∫îÁöÑÊòØÁúüÂÆûÂ§¥ÈÉ® (`0x0F90`) + `0x58`„ÄÇ
- **Á•ûÂ•áÂèëÁé∞**Ôºö`0x58` Â§ÑÊ≠£Â•ΩÂ∞±ÊòØÊàë‰ª¨Ë¶ÅÊâæÁöÑÈÇ£‰∏™Êï∞ÊçÆÂ≠óÊÆµÔºÅ

### ÊÄªÁªì

- ‚ÄúÊåáÂêë...ÂÅèÁßª‰ΩçÁΩÆ (`0x10`)‚ÄùÔºöËøôÊòØÁâ©ÁêÜ‰∫ãÂÆûÔºåÊåáÈíàÁ°ÆÂÆûÊåáÂú®‰∫∫ÂÆ∂ÁªìÊûÑ‰ΩìÁöÑ‚ÄúËÇöÂ≠ê‚Äù‰∏ä„ÄÇ
- ‚ÄúÁºñËØëÂô®ÁúãÊù•‰ªçÁÑ∂ÊòØÊåáÂêë...Á¨¨ 0 ‰∏™Â≠óËäÇÂ§Ñ‚ÄùÔºöËøôÊòØÁ±ªÂûãËΩ¨Êç¢ÁöÑ‰ΩúÁî®Ôºå‰Ω†Âº∫Ëø´ÁºñËØëÂô®‰ªé‚ÄúËÇöÂ≠ê‚ÄùÂºÄÂßãÁÆó‰Ωú‚ÄúÂ§¥‚Äù„ÄÇ

## Êåá‰ª§ÈõÜÊû∂ÊûÑ

Èô§‰∫Ü x86_64ÔºàAMD64Ôºâ‰πãÂ§ñÔºåËøòÂ≠òÂú®Â§öÁßç‰∏ªÊµÅÂíå‰∏ìÁî®ÁöÑÊåá‰ª§ÈõÜÊû∂ÊûÑÔºàISAÔºâ„ÄÇ‰Ωú‰∏∫‰∏ÄÂêç Rust ÂºÄÂèëËÄÖÔºå‰∫ÜËß£‰ª•‰∏ãÂá†ÁßçÊû∂ÊûÑÂ∞§‰∏∫ÈáçË¶ÅÔºåÂõ†‰∏∫ÂÆÉ‰ª¨ÊòØ Rust ‰∫§ÂèâÁºñËØëÁöÑÂ∏∏ËßÅÁõÆÊ†á„ÄÇ

---

### 1. ARM Êû∂ÊûÑÔºàAArch64 / ARM64Ôºâ

- **ÁâπÁÇπ**ÔºöÂü∫‰∫é RISCÔºàÁ≤æÁÆÄÊåá‰ª§ÈõÜËÆ°ÁÆóÔºâÔºåÂäüËÄó‰ΩéÔºåËÉΩÊïàÊØîÈ´ò„ÄÇ
- **Â∫îÁî®Âú∫ÊôØ**Ôºö
  - **ÁßªÂä®ËÆæÂ§á**ÔºöÂá†‰πéÊâÄÊúâÁöÑ Android ÊâãÊú∫Âíå iPhone„ÄÇ
  - **Ê°åÈù¢Á´Ø**ÔºöApple SiliconÔºàM1„ÄÅM2„ÄÅM3„ÄÅM4ÔºâÁ≥ªÂàóËäØÁâá„ÄÇ
  - **ÊúçÂä°Âô®**ÔºöAWS Graviton Á≠âÈ´òÊÄßËÉΩ‰∫ëÊúçÂä°Âô®„ÄÇ
  - **ÂµåÂÖ•Âºè**ÔºöRaspberry PiÔºàÊ†ëËéìÊ¥æÔºâ„ÄÇ
- **Rust ÁõÆÊ†á‰∏âÂÖÉÁªÑÁ§∫‰æã**Ôºö
  - `aarch64-unknown-linux-gnu`
  - `aarch64-apple-darwin`

---

### 2. RISC-V

- **ÁâπÁÇπ**ÔºöÂÆåÂÖ®ÂºÄÊ∫ê„ÄÅÂÖçË¥π„ÄÅÊ®°ÂùóÂåñÁöÑ RISC Êû∂ÊûÑ„ÄÇÂÖÅËÆ∏‰ªª‰Ωï‰∫∫ËÆæËÆ°„ÄÅÂà∂ÈÄ†ÂíåÈîÄÂîÆ RISC-V ËäØÁâáËÄåÊó†ÈúÄÊîØ‰ªò‰∏ìÂà©Ë¥πÔºåË¢´Ë™â‰∏∫‚ÄúËäØÁâáÁïåÁöÑ Linux‚Äù„ÄÇ
- **Â∫îÁî®Âú∫ÊôØ**Ôºö
  - ÂΩìÂâç‰∏ªË¶ÅÁî®‰∫éÁâ©ËÅîÁΩëÔºàIoTÔºâ„ÄÅÂµåÂÖ•ÂºèÊéßÂà∂Âô®„ÄÇ
  - Ê≠£Âú®ÂêëÊúçÂä°Âô®ÂíåÈ´òÊÄßËÉΩËÆ°ÁÆóÔºàHPCÔºâÈ¢ÜÂüüÂø´ÈÄüÊâ©Â±ï„ÄÇ
- **Rust ÊîØÊåÅ**Ôºö
  - ÂÆòÊñπÊîØÊåÅËâØÂ•ΩÔºå‰æãÂ¶ÇÔºö`riscv64gc-unknown-linux-gnu`

---

### 3. WebAssemblyÔºàWasmÔºâ

- **ËØ¥Êòé**ÔºöËôΩÁÑ∂‰∏çÊòØÁâ©ÁêÜ CPU Êû∂ÊûÑÔºå‰ΩÜÊòØ‰∏ÄÁßçÊûÅÂÖ∂ÈáçË¶ÅÁöÑ**ËôöÊãüÊåá‰ª§ÈõÜÊû∂ÊûÑ**„ÄÇ
- **ÁâπÁÇπ**ÔºöÂü∫‰∫éÂ†ÜÊ†àÁöÑ‰∫åËøõÂà∂Êåá‰ª§Ê†ºÂºèÔºåËÆæËÆ°‰∏∫ÂèØÁßªÊ§çÁöÑÁºñËØëÁõÆÊ†á„ÄÇ
- **Â∫îÁî®Âú∫ÊôØ**Ôºö
  - Âú®ÊµèËßàÂô®‰∏≠‰ª•Êé•ËøëÂéüÁîüÈÄüÂ∫¶ËøêË°å Rust ‰ª£Á†Å„ÄÇ
  - ËæπÁºòËÆ°ÁÆóÔºàEdge ComputingÔºâ„ÄÇ
  - Êèí‰ª∂Á≥ªÁªüÔºàÂ¶Ç Envoy Proxy„ÄÅFermyon SpinÔºâ„ÄÇ
- **Rust ÁõÆÊ†á‰∏âÂÖÉÁªÑ**Ôºö
  - `wasm32-unknown-unknown`
  - `wasm32-wasi`

---

### 4. x86Ôºà32-bitÔºâ/ i686

- **ÁâπÁÇπ**Ôºöx86_64 ÁöÑÂâçË∫´Ôºå32 ‰ΩçÊû∂ÊûÑÔºåÂÜÖÂ≠òÂØªÂùÄ‰∏äÈôê‰∏∫ 4GB„ÄÇ
- **Â∫îÁî®Âú∫ÊôØ**Ôºö
  - ËÄÅÊóß PC„ÄÅÂ∑•‰∏öÊéßÂà∂Á≥ªÁªü„ÄÅÈÅóÁïôÂµåÂÖ•ÂºèËÆæÂ§á„ÄÇ
  - ËôΩÁÑ∂Áé∞‰ª£ÂºÄÂèëÂ∑≤ÈÄêÊ∏êÊ∑òÊ±∞Ôºå‰ΩÜÂú®ÂÖºÂÆπÊÄßÁª¥Êä§‰∏≠‰ªçÈúÄÂÖ≥Ê≥®„ÄÇ
- **Rust ÁõÆÊ†áÁ§∫‰æã**Ôºö`i686-unknown-linux-gnu`

---

### 5. ÂÖ∂‰ªñÂµåÂÖ•Âºè‰∏é‰∏ìÁî®Êû∂ÊûÑ

| Êû∂ÊûÑ       | ÁÆÄ‰ªã                                                                 |
|------------|----------------------------------------------------------------------|
| **MIPS**   | ÊõæÂπøÊ≥õÁî®‰∫éË∑ØÁî±Âô®ÂíåÊú∫È°∂ÁõíÔºåÁé∞ÈÄêÊ∏êË¢´ ARM Âíå RISC-V Âèñ‰ª£„ÄÇ               |
| **PowerPC (PPC)** | ÊõæÁî®‰∫éËÄÅÊ¨æ Mac ÂíåÊ∏∏Êàè‰∏ªÊú∫ÔºàÂ¶Ç PS3„ÄÅXbox 360ÔºâÔºåÁé∞‰∏ªË¶ÅÁî®‰∫éÊ±ΩËΩ¶ÁîµÂ≠ê„ÄÅËà™Â§©Á≠âÈ´òÂèØÈù†È¢ÜÂüü„ÄÇ |
| **AVR**    | 8 ‰ΩçÂæÆÊéßÂà∂Âô®Êû∂ÊûÑÔºåÂÖ∏Âûã‰ª£Ë°®ÊòØ Arduino UnoÔºåÈÄÇÁî®‰∫éÊûÅ‰ΩéÂäüËÄóÂµåÂÖ•ÂºèÂú∫ÊôØ„ÄÇ     |

---

### ÊÄªÁªìÔºöCISC vs RISC

ËÆ°ÁÆóÊú∫‰ΩìÁ≥ªÁªìÊûÑ‰∏ªË¶ÅÂàÜ‰∏∫‰∏§Â§ßÊµÅÊ¥æÔºö

1. **CISCÔºàComplex Instruction Set ComputingÔºåÂ§çÊùÇÊåá‰ª§ÈõÜÔºâ**
   - **‰ª£Ë°®**Ôºöx86 / x86_64
   - **ÁâπÁÇπ**Ôºö
     - ÂçïÊù°Êåá‰ª§ÂèØÂÆåÊàêÂ§çÊùÇÊìç‰ΩúÔºàÂ¶ÇÁõ¥Êé•ÂÜÖÂ≠òËØªÂÜôÔºâ„ÄÇ
     - ‰ª£Á†ÅÂØÜÂ∫¶È´òÔºàÁ®ãÂ∫è‰ΩìÁßØÂ∞èÔºâ„ÄÇ
     - Á°¨‰ª∂ÂÆûÁé∞ÊûÅÂÖ∂Â§çÊùÇÔºå‰æùËµñÂæÆÁ†ÅÔºàmicrocodeÔºâ„ÄÇ

2. **RISCÔºàReduced Instruction Set ComputingÔºåÁ≤æÁÆÄÊåá‰ª§ÈõÜÔºâ**
   - **‰ª£Ë°®**ÔºöARM„ÄÅRISC-V
   - **ÁâπÁÇπ**Ôºö
     - Êåá‰ª§ÂäüËÉΩÁÆÄÂçï„ÄÅÂõ∫ÂÆöÈïøÂ∫¶„ÄÅÊâßË°åÈÄüÂ∫¶Âø´„ÄÇ
     - ‰æùËµñÁºñËØëÂô®‰ºòÂåñÊù•ÁªÑÂêàÂ§öÊù°ÁÆÄÂçïÊåá‰ª§„ÄÇ
     - Á°¨‰ª∂ËÆæËÆ°ÁÆÄÊ¥ÅÔºåÂäüËÄó‰ΩéÔºåÈÄÇÂêàÂπ∂Ë°åÂíåËÉΩÊïàÊïèÊÑüÂú∫ÊôØ„ÄÇ

---

> üí° **ÂØπ RustRedOps ÂºÄÂèëËÄÖÁöÑÊèêÁ§∫**Ôºö  
> Â¶ÇÊûú‰Ω†Ê≠£Âú®ÂºÄÂèëÂ∫ïÂ±ÇÁ∫¢Èòü/ËìùÈòüÂ∑•ÂÖ∑ÔºàÂ¶Ç shellcode„ÄÅPE Ëß£ÊûêÂô®„ÄÅÁ≥ªÁªüË∞ÉÁî®Â∞ÅË£ÖÁ≠âÔºâÔºåÊú™Êù•ÂæàÂèØËÉΩÈúÄË¶ÅÂ§ÑÁêÜ **x86_64 ‰∏é AArch64** Âú®‰ª•‰∏ãÊñπÈù¢ÁöÑÂ∑ÆÂºÇÔºö
>
> - Á≥ªÁªüË∞ÉÁî®ÁºñÂè∑‰∏éÁ∫¶ÂÆöÔºàsyscall ABIÔºâ
> - ÂØÑÂ≠òÂô®ÂëΩÂêç‰∏éÁî®ÈÄîÔºàÂ¶Ç `rax` vs `x0`Ôºâ
> - ÂÜÖÂ≠òÈ°∫Â∫èÊ®°ÂûãÔºàMemory OrderingÔºâ
> - Êåá‰ª§ÁºñÁ†Å‰∏é Shellcode ÁºñÂÜô
>
> ÊéåÊè°Â§öÊû∂ÊûÑÁü•ËØÜÔºåÂ∞ÜÊûÅÂ§ßÊèêÂçáÂ∑•ÂÖ∑ÁöÑÂèØÁßªÊ§çÊÄß‰∏éÈöêËîΩÊÄß„ÄÇ

## EXE Êñá‰ª∂Âíå PE Êñá‰ª∂ÁöÑÂÖ≥Á≥ªÔºüÈô§‰∫Ü EXE ËøòÊúâÂì™‰∫õ PE Êñá‰ª∂Ôºü

- **PE**ÔºàPortable ExecutableÔºâ  
  ÊòØÂæÆËΩØÂÆö‰πâÁöÑ**‰∫åËøõÂà∂Êñá‰ª∂Ê†ºÂºèÊ†áÂáÜ**ÔºåËßÑÂÆö‰∫ÜÂèØÊâßË°åÊñá‰ª∂Âú®Á£ÅÁõò‰∏äÁöÑÁªìÊûÑ‰ª•ÂèäÂä†ËΩΩÂà∞ÂÜÖÂ≠òÂêéÁöÑÂ∏ÉÂ±ÄÊñπÂºè„ÄÇ
- **EXE**Ôºà`.exe`Ôºâ  
  ÊòØÁ¨¶Âêà PE Ê†ºÂºèÁöÑ‰∏ÄÁßç**ÂÖ∑‰ΩìÊñá‰ª∂Á±ªÂûã**Ôºå‰∏ìÁî®‰∫éÊ†áËØÜ‚ÄúÂèØÁõ¥Êé•ÂêØÂä®Âπ∂‰Ωú‰∏∫Áã¨Á´ãËøõÁ®ãËøêË°å‚ÄùÁöÑÁ®ãÂ∫è„ÄÇ

> üèóÔ∏è **Á±ªÊØî**Ôºö  
>
> - PE Ê†áÂáÜ ‚âà **Âª∫Á≠ëËßÑËåÉ**ÔºàËßÑÂÆöÂú∞Âü∫„ÄÅÊâøÈáçÂ¢ô„ÄÅÈó®Á™ó‰ΩçÁΩÆÔºâ  
> - EXE Êñá‰ª∂ ‚âà **ÊåâËßÑËåÉÂª∫ÊàêÁöÑ‰ΩèÂÆÖ**ÔºàÂèØÁõ¥Êé•ÂÖ•‰ΩèÔºâ

---

### 2. Èô§‰∫Ü EXEÔºåËøòÊúâÂì™‰∫õÂ∏∏ËßÅÁöÑ PE Êñá‰ª∂Ôºü

Âè™Ë¶ÅÊòØÁ¨¶Âêà PE ÁªìÊûÑÁöÑÊñá‰ª∂ÔºåÊó†ËÆ∫Êâ©Â±ïÂêçÂ¶Ç‰ΩïÔºåÈÉΩÂ±û‰∫é PE ÂÆ∂Êóè„ÄÇÂ∏∏ËßÅÁ±ªÂûãÂåÖÊã¨Ôºö

#### A. Âä®ÊÄÅÈìæÊé•Â∫ìÔºàDLLÔºâ

- **`.dll`**ÔºöÊúÄÂ∏∏ËßÅÂΩ¢ÂºèÔºå‰æõ EXE ÊàñÂÖ∂‰ªñ DLL Ë∞ÉÁî®Ôºå‰∏çËÉΩÁã¨Á´ãÂêØÂä®„ÄÇ
- **`.ocx`**ÔºöActiveX Êéß‰ª∂ÔºàÊóßÁâà IE ‰ΩøÁî®ÔºâÔºåÊú¨Ë¥®ÊòØÂ∏¶ COM Êé•Âè£ÁöÑ DLL„ÄÇ
- **`.cpl`**ÔºöÊéßÂà∂Èù¢ÊùøÈ°πÔºàÂ¶Ç‚ÄúÈº†Ê†áËÆæÁΩÆ‚ÄùÔºâÔºåÊú¨Ë¥®ÊòØÂØºÂá∫ `CPlApplet` ÂáΩÊï∞ÁöÑ DLL„ÄÇ

#### B. È©±Âä®Á®ãÂ∫èÔºàDriversÔºâ

- **`.sys`**ÔºöWindows ÂÜÖÊ†∏Ê®°ÂºèÈ©±Âä®ÔºåÁî±ÂÜÖÊ†∏Âä†ËΩΩÂô®Âä†ËΩΩÔºåËøêË°åÂú® Ring 0„ÄÇ

#### C. ÂÖ∂‰ªñÁ≥ªÁªü/ÂäüËÉΩÊñá‰ª∂

- **`.efi`**ÔºöUEFI Âõ∫‰ª∂ÂèØÊâßË°åÊñá‰ª∂ÔºåÁî®‰∫éÁ≥ªÁªüÂºïÂØºÈò∂ÊÆµ„ÄÇ
- **`.scr`**ÔºöÂ±èÂπï‰øùÊä§Á®ãÂ∫èÔºåÊú¨Ë¥®ÊòØÊîπÂêçÁöÑ EXE„ÄÇ
- **`.mui`**ÔºöÂ§öËØ≠Ë®ÄÁî®Êà∑ÁïåÈù¢ËµÑÊ∫êÊñá‰ª∂„ÄÇ
- **`.tsp`**ÔºöÁîµËØùÊúçÂä°Êèê‰æõÁ®ãÂ∫è„ÄÇ

---

### 3. Â¶Ç‰ΩïÂå∫ÂàÜ‰∏çÂêåÁ±ªÂûãÁöÑ PE Êñá‰ª∂Ôºü

Â∞ΩÁÆ°ÁªìÊûÑÁõ∏ÂêåÔºåWindows ÈÄöËøá **PE Êñá‰ª∂Â§¥‰∏≠ÁöÑÊ†áÂøó‰Ωç**ËøõË°åËØÜÂà´Ôºö

```rust
// src/types.rs
pub struct IMAGE_FILE_HEADER {
    pub Machine: IMAGE_FILE_MACHINE,
    pub NumberOfSections: u16,
    pub TimeDateStamp: u32,
    pub PointerToSymbolTable: u32,
    pub NumberOfSymbols: u32,
    pub SizeOfOptionalHeader: u16,
    pub Characteristics: IMAGE_FILE_CHARACTERISTICS, // ‚Üê ÂÖ≥ÈîÆÂ≠óÊÆµ
}
```

ÂÖ≥ÈîÆÊ†áÂøó‰ΩçÔºà`Characteristics`ÔºâÔºö

- `IMAGE_FILE_EXECUTABLE_IMAGE` (`0x0002`) ‚Üí ÂèØÊâßË°åÊñá‰ª∂ÔºàEXE/SCRÔºâ
- `IMAGE_FILE_DLL` (`0x2000`) ‚Üí Âä®ÊÄÅÈìæÊé•Â∫ìÔºàDLL/OCX/CPLÔºâ
- `IMAGE_FILE_SYSTEM` (`0x1000`) ‚Üí Á≥ªÁªüÊñá‰ª∂ÔºàÂ¶Ç `.sys` È©±Âä®Ôºâ

Ê≠§Â§ñÔºå**Â≠êÁ≥ªÁªüÂ≠óÊÆµ**Ôºà`Subsystem` in `IMAGE_OPTIONAL_HEADER`Ôºâ‰πüÂèØÁî®‰∫éÂå∫ÂàÜÔºö

- `IMAGE_SUBSYSTEM_WINDOWS_GUI` / `CONSOLE` ‚Üí ÊôÆÈÄö EXE
- `IMAGE_SUBSYSTEM_NATIVE` ‚Üí È©±Âä®ÊàñÂÜÖÊ†∏ÁªÑ‰ª∂
- `IMAGE_SUBSYSTEM_EFI_APPLICATION` ‚Üí EFI ÂèØÊâßË°åÊñá‰ª∂

> ‚úÖ **ÊÄªÁªì**Ôºö  
>
> - **PE ÊòØ‚ÄúÁ±ªÂêç‚Äù**ÔºàÊäΩË±°Ê†ºÂºèÊ†áÂáÜÔºâ  
> - **EXE/DLL/SYS/EFI ÊòØ‚ÄúÂÆû‰æã‚Äù**ÔºàÂÖ∑‰ΩìÁî®ÈÄîÁöÑÂÆûÁé∞Ôºâ  
> ÂÆÉ‰ª¨ÂÖ±‰∫´Áõ∏ÂêåÁöÑ‚ÄúÂøÉËÑè‚ÄùÔºàPE Â§¥ÁªìÊûÑÔºâÔºå‰ΩÜÊâÆÊºî‰∏çÂêåÁöÑÁ≥ªÁªüËßíËâ≤„ÄÇ

---
ËôΩÁÑ∂ÈÉΩÈÅµÂæ™ PE Ê†áÂáÜÔºå‰ΩÜ‰∏çÂêåÊñá‰ª∂Á±ªÂûãÊâøÊãÖÁùÄ**Êà™ÁÑ∂‰∏çÂêåÁöÑÊìç‰ΩúÁ≥ªÁªüËÅåË¥£**„ÄÇËøôÁßçÂ§öÊ†∑ÊÄßÊ∫ê‰∫éÂØπ**Ê®°ÂùóÂåñ„ÄÅÂÆâÂÖ®ÊÄß„ÄÅËµÑÊ∫êÊïàÁéáÂíåÂêØÂä®ÊµÅÁ®ã**ÁöÑÈúÄÊ±Ç„ÄÇ

---

### 1. EXEÔºàExecutableÔºâ‚Äî‚Äî Áã¨Á´ãÁöÑÊâßË°å‰∏ª‰Ωì

- **ÁâπÁÇπ**Ôºö
  - Êã•ÊúâÊòéÁ°ÆÂÖ•Âè£ÁÇπÔºàÂ¶Ç `main`„ÄÅ`WinMain`Ôºâ„ÄÇ
  - Êìç‰ΩúÁ≥ªÁªü‰∏∫ÂÖ∂ÂàõÂª∫**Áã¨Á´ãËøõÁ®ã**„ÄÅPEB Âíå‰∏ªÁ∫øÁ®ã„ÄÇ
  - ÊòØ‚Äú‰∏ªÂä®‚ÄùÊâßË°åÂçïÂÖÉÔºåÊéßÂà∂Á®ãÂ∫è‰∏ªÊµÅÁ®ã„ÄÇ
- **‰∏∫‰ΩïÈúÄË¶Å**Ôºü
  - ‰Ωú‰∏∫Áî®Êà∑‰∫§‰∫íÂíå‰∏öÂä°ÈÄªËæëÁöÑ‰∏ªË¶ÅËΩΩ‰Ωì„ÄÇ
  - ÊòØÂ∫îÁî®Á®ãÂ∫èÁöÑ‚ÄúÊåáÊå•‰∏≠ÂøÉ‚ÄùÔºåË¥üË¥£Ë∞ÉÂ∫¶ÂÖ∂‰ªñÁªÑ‰ª∂„ÄÇ

---

### 2. DLLÔºàDynamic Link LibraryÔºâ‚Äî‚Äî ÂÖ±‰∫´ÁöÑ‰ª£Á†Å‰ªìÂ∫ì

- **ÁâπÁÇπ**Ôºö
  - **Ë¢´Âä®Âä†ËΩΩ**ÔºöÈúÄÁî± EXE ÊàñÂÖ∂‰ªñ DLL ÊòæÂºè/ÈöêÂºèÂä†ËΩΩ„ÄÇ
  - **ÂÜÖÂ≠òÂÖ±‰∫´**ÔºöÂêå‰∏ÄÁ≥ªÁªü DLLÔºàÂ¶Ç `kernel32.dll`ÔºâÂú®Áâ©ÁêÜÂÜÖÂ≠ò‰∏≠‰ªÖÂ≠ò‰∏Ä‰ªΩ‰ª£Á†ÅÔºàCopy-on-WriteÔºâ„ÄÇ
  - ÂÖ•Âè£ÁÇπ‰∏∫ `DllMain`Ôºå‰ªÖÁî®‰∫éÂàùÂßãÂåñ/Ê∏ÖÁêÜÔºå‰∏çÊåÅÁª≠ËøêË°å„ÄÇ
- **‰∏∫‰ΩïÊúâ‰∫Ü EXE ËøòË¶Å DLL**Ôºü
  - ‚úÖ **Ê®°ÂùóÂåñÂºÄÂèë**ÔºöÂäüËÉΩËß£ËÄ¶Ôºå‰æø‰∫éÁã¨Á´ãÊõ¥Êñ∞ÔºàÊó†ÈúÄÈáçÂèëÊï¥‰∏™ EXEÔºâ„ÄÇ
  - ‚úÖ **ÂÜÖÂ≠òÊïàÁéá**ÔºöÈÅøÂÖçÈáçÂ§çÈùôÊÄÅÈìæÊé•ÈÄöÁî®‰ª£Á†ÅÔºàÂ¶Ç API ÂáΩÊï∞Ôºâ„ÄÇ
  - ‚úÖ **Êèí‰ª∂Êû∂ÊûÑ**ÔºöÊîØÊåÅËøêË°åÊó∂Âä®ÊÄÅÊâ©Â±ïÂäüËÉΩ„ÄÇ

---

### 3. SYSÔºàSystem DriverÔºâ‚Äî‚Äî ÂÜÖÊ†∏ÁöÑÂª∂‰º∏

- **ÁâπÁÇπ**Ôºö
  - ËøêË°åÂú® **Ring 0**ÔºàÂÜÖÊ†∏Ê®°ÂºèÔºâÔºåÊã•ÊúâÊúÄÈ´òÊùÉÈôê„ÄÇ
  - ÂèØÁõ¥Êé•ËÆøÈóÆÁ°¨‰ª∂„ÄÅI/O Á´ØÂè£„ÄÅ‰ªªÊÑèÂÜÖÂ≠ò„ÄÇ
  - **Êó†Áã¨Á´ãËøõÁ®ã**Ôºö‰æùÈôÑ‰∫éÁ≥ªÁªüÁ∫øÁ®ãÊàñ‰∏≠Êñ≠‰∏ä‰∏ãÊñá„ÄÇ
  - Â¥©Ê∫ÉÂØºËá¥ **ËìùÂ±è**ÔºàBSODÔºâÔºåËÄåÈùûÊôÆÈÄöÁ®ãÂ∫èÂ¥©Ê∫É„ÄÇ
- **‰∏∫‰ΩïÈúÄË¶Å**Ôºü
  - üîß **Á°¨‰ª∂ÊäΩË±°**ÔºöEXEÔºàRing 3ÔºâÊó†Ê≥ïÁõ¥Êé•Êìç‰ΩúÁ°¨‰ª∂ÔºåÈúÄÈ©±Âä®‚ÄúÁøªËØë‚Äù„ÄÇ
  - üõ°Ô∏è **Á≥ªÁªüÁ∫ßÂÆâÂÖ®**ÔºöÊùÄÊØíËΩØ‰ª∂„ÄÅEDR ÈúÄÂú®ÂÜÖÊ†∏Â±ÇÁõëÊéßË°å‰∏∫„ÄÇ
  - ‚öôÔ∏è **Ê†∏ÂøÉÊúçÂä°ÂÆûÁé∞**ÔºöÊñá‰ª∂Á≥ªÁªü„ÄÅÁΩëÁªúÂçèËÆÆÊ†àÁ≠âÂùáÁî±È©±Âä®Êèê‰æõ„ÄÇ

---

### 4. EFIÔºàExtensible Firmware InterfaceÔºâ‚Äî‚Äî Á≥ªÁªüÁöÑÂêØÂä®ËÄÖ

- **ÁâπÁÇπ**Ôºö
  - Âú® **Êìç‰ΩúÁ≥ªÁªüÂä†ËΩΩÂâçËøêË°å**ÔºåÁî± UEFI Âõ∫‰ª∂Áõ¥Êé•ÊâßË°å„ÄÇ
  - **Êó† OS ‰æùËµñ**ÔºöÊ≠§Êó∂Êó† Windows/LinuxÔºå‰ªÖËÉΩË∞ÉÁî® UEFI ÊúçÂä°„ÄÇ
  - PE Â§¥‰∏≠ `Subsystem = IMAGE_SUBSYSTEM_EFI_APPLICATION`„ÄÇ
- **‰∏∫‰ΩïÈúÄË¶Å**Ôºü
  - üö™ **Ëß£ÂÜ≥‚ÄúÈ∏°ÁîüËõã‚ÄùÈóÆÈ¢ò**ÔºöEXE ÈúÄË¶Å OS ÊâçËÉΩËøêË°åÔºå‰ΩÜ OS Êú¨Ë∫´ÈúÄË¢´Âä†ËΩΩ„ÄÇ
  - üíæ **ÂºïÂØºÂä†ËΩΩÂô®**ÔºöÂ¶Ç `bootmgfw.efi` Ë¥üË¥£Âä†ËΩΩ Windows ÂÜÖÊ†∏„ÄÇ
  - üåê **Ê†áÂáÜÂåñÂõ∫‰ª∂Êé•Âè£**ÔºöÂèñ‰ª£ BIOSÔºåÊèê‰æõÁªü‰∏ÄÁ°¨‰ª∂ÂàùÂßãÂåñËÉΩÂäõ„ÄÇ

---

### 5. SCRÔºàScreen SaverÔºâ‚Äî‚Äî ÁâπÊÆäÁî®ÈÄîÁöÑ EXE

- **ÁâπÁÇπ**Ôºö
  - **Êú¨Ë¥®ÊòØ EXE**ÔºåÈáçÂëΩÂêç‰∏∫ `.exe` Âç≥ÂèØËøêË°å„ÄÇ
  - ÂøÖÈ°ªÂìçÂ∫îÁâπÂÆöÂëΩ‰ª§Ë°åÂèÇÊï∞Ôºö
    - `/s`ÔºöÂÖ®Â±èËøêË°å
    - `/c`ÔºöÊâìÂºÄÈÖçÁΩÆÁ™óÂè£
    - `/p <hwnd>`ÔºöÈ¢ÑËßàÊ®°Âºè
- **‰∏∫‰ΩïÈúÄË¶Å‰∏ìÁî®Ê†ºÂºè**Ôºü
  - ‰∏ªË¶ÅÊòØ **ÂéÜÂè≤ËßÑËåÉ‰∏éÁ≥ªÁªüËØÜÂà´‰æøÂà©ÊÄß**Ôºå‰æø‰∫éÈõÜÊàêÂà∞ Windows ËÆæÁΩÆ‰∏≠„ÄÇ

---

### 6. OCX / CPL ‚Äî‚Äî Êèí‰ª∂ÂºèÊû∂ÊûÑÁöÑÂÆûÁé∞ËÄÖ

| Á±ªÂûã | ÂÖ®Áß∞ | Êú¨Ë¥® | ÂÖ≥ÈîÆË¶ÅÊ±Ç |
|------|------|------|--------|
| **OCX** | OLE Control Extension | ÁâπÂÆöËßÑËåÉÁöÑ DLL | ÂÆûÁé∞ COM Êé•Âè£ÔºàÂ¶Ç `DllRegisterServer`Ôºâ |
| **CPL** | Control Panel Item | ÁâπÂÆöËßÑËåÉÁöÑ DLL | ÂØºÂá∫ `CPlApplet` ÂáΩÊï∞ |

- **‰∏∫‰ΩïÈúÄË¶Å**Ôºü
  - üß© **Ê†áÂáÜÂåñÊèí‰ª∂Êé•Âè£**ÔºöÊéßÂà∂Èù¢ÊùøÂè™ÈúÄËØÜÂà´ `.cpl` Âπ∂Ë∞ÉÁî® `CPlApplet`ÔºåÊó†ÈúÄ‰∫ÜËß£ÂÜÖÈÉ®ÈÄªËæë„ÄÇ
  - üîå **Âç≥ÊèíÂç≥Áî®**ÔºöÁ¨¨‰∏âÊñπÂºÄÂèëËÄÖÂèØÊåâËßÑËåÉÁºñÂÜôÊ®°ÂùóÔºåÊó†ÁºùÈõÜÊàêÂà∞Á≥ªÁªü‰∏≠„ÄÇ

---

## ÊÄªÁªìÔºö‰∏∫‰ΩïÈúÄË¶ÅÂ¶ÇÊ≠§Â§öÊ†∑ÁöÑ PE Ê†ºÂºèÔºü

Áé∞‰ª£Êìç‰ΩúÁ≥ªÁªüÈááÁî® **ÂàÜÂ±Ç„ÄÅËÅåË¥£ÂàÜÁ¶ª** ÁöÑËÆæËÆ°Âì≤Â≠¶Ôºö

| Â±ÇÁ∫ß | ÁªÑ‰ª∂ | ËÅåË¥£ |
|------|------|------|
| **Âõ∫‰ª∂Â±Ç** | EFI | ÂêØÂä®Á°¨‰ª∂ÔºåÂä†ËΩΩÂÜÖÊ†∏ |
| **ÂÜÖÊ†∏Â±Ç** | SYS | ÁÆ°ÁêÜÁ°¨‰ª∂„ÄÅÂÜÖÂ≠ò„ÄÅÂÆâÂÖ® |
| **Á≥ªÁªüÊúçÂä°Â±Ç** | DLL | Êèê‰æõÈÄöÁî® APIÔºàÊñá‰ª∂„ÄÅÁΩëÁªú„ÄÅÂõæÂΩ¢Á≠âÔºâ |
| **Â∫îÁî®Â±Ç** | EXE | ÂÆûÁé∞Áî®Êà∑ÂäüËÉΩ‰∏é‰∫§‰∫í |

> ‚ùå **Â¶ÇÊûúÂè™Êúâ EXE**Ôºö  
>
> - ÊØè‰∏™Á®ãÂ∫èÈÉΩË¶ÅËá™Â∑±ÂÜôÊòæÂç°È©±Âä®„ÄÅÂÜÖÂ≠òÁÆ°ÁêÜÂô®„ÄÇ  
> - Êó†Ê≥ïÂÆûÁé∞Â§ö‰ªªÂä°Âçè‰ΩúÊàñËµÑÊ∫êÂÖ±‰∫´„ÄÇ  
> - Á≥ªÁªüËáÉËÇø„ÄÅ‰ΩéÊïà„ÄÅÊûÅ‰∏çÁ®≥ÂÆö„ÄÇ

‚úÖ **Â§öÊ†∑ÂåñÁöÑ PE Ê†ºÂºè** ÊòØÁé∞‰ª£Â§ö‰ªªÂä°Êìç‰ΩúÁ≥ªÁªü**È´òÊïà„ÄÅÂÆâÂÖ®„ÄÅÂèØÊâ©Â±ï**ËøêË°åÁöÑÂü∫Áü≥„ÄÇÂÆÉ‰ª¨ÂÖ±ÂêåÊûÑÊàê‰∫Ü‰ªéÁ°¨‰ª∂Âà∞Áî®Êà∑Â∫îÁî®ÁöÑÂÆåÊï¥ÊâßË°åÈìæÊù°„ÄÇ

## Ê∫êÁ†Å

### CStr::from_ptr(ptr).to_string_lossy().into_owned()

ËøôÊÆµ‰ª£Á†ÅÁöÑÊ†∏ÂøÉ‰ΩúÁî®ÊòØÔºö**Â∞ÜÁõÆÊ†á DLL ÂÜÖÂ≠òÊò†Â∞ÑÂå∫‰∏≠ÁöÑ‚ÄúC È£éÊ†ºÂ≠óÁ¨¶‰∏≤Ôºà‰ª• null ÁªìÂ∞æÁöÑÂéüÂßãÂ≠óËäÇÔºâ‚ÄùÂÆâÂÖ®Âú∞ËΩ¨Êç¢Êàê Rust ÁéØÂ¢É‰∏≠ÂèØÁî®ÁöÑ„ÄÅÊâÄÊúâÊùÉÁã¨Á´ãÁöÑ `String` ÂØπË±°„ÄÇ**

ËøôÁßçËΩ¨Êç¢Âú®Á∫¢ÈòüÂä†ËΩΩÂô®ÔºàÂ¶Ç `dinvk`Ôºâ‰∏≠Ëá≥ÂÖ≥ÈáçË¶Å‚Äî‚ÄîÊó¢Ë¶ÅÊ≠£Á°ÆËØªÂèñ Windows PE ÁªìÊûÑ‰∏≠ÁöÑÂéüÂßãÊï∞ÊçÆÔºåÂèàË¶ÅÈÅøÂÖçÂÜÖÂ≠òÂÆâÂÖ®ÈóÆÈ¢ò„ÄÇÊàë‰ª¨ÂèØ‰ª•Â∞ÜÂÖ∂ÊãÜËß£‰∏∫‰ª•‰∏ã‰∏â‰∏™ÂÖ≥ÈîÆÊ≠•È™§Ôºö

---

#### 1. `CStr::from_ptr(ptr)`ÔºöÂ∞ÅË£ÖÂéüÂßãÊåáÈíàÔºåÂàõÂª∫ÂÆâÂÖ®ËßÜÂõæ

- **ËÉåÊôØ**Ôºö  
  `ptr` ÊòØ‰∏Ä‰∏™Ë£∏ÊåáÈíàÔºà`*const i8`ÔºâÔºåÊåáÂêë DLL ÂÜÖÂ≠òÊò†ÂÉè‰∏≠Êüê‰∏™ÂêçÁß∞Â≠óÁ¨¶‰∏≤Ôºà‰æãÂ¶Ç `"kernel32.dll\0"` Êàñ `"NtAllocateVirtualMemory\0"`Ôºâ„ÄÇ

- **‰ΩúÁî®**Ôºö  
  `CStr::from_ptr(ptr)` ÂëäËØâ RustÔºö‚Äú‰ªéËøô‰∏™Âú∞ÂùÄÂºÄÂßãÔºåÈÄêÂ≠óËäÇËØªÂèñÔºåÁõ¥Âà∞ÈÅáÂà∞ `\0` Â≠óËäÇ‰∏∫Ê≠¢‚ÄùÔºåÂπ∂Â∞ÜËØ•ÂÜÖÂ≠òÁâáÊÆµÂåÖË£Ö‰∏∫‰∏Ä‰∏™ `CStr` Á±ªÂûã„ÄÇ

- **ÂÖ≥ÈîÆÁâπÊÄß**Ôºö  
  - **Èõ∂Êã∑Ë¥ù**Ôºö`CStr` ‰ªÖÊòØÂØπÂéüÂßãÂÜÖÂ≠òÁöÑ**ÂÄüÁî®ÔºàborrowÔºâ**Ôºå‰∏çËøõË°åÊï∞ÊçÆÂ§çÂà∂„ÄÇ
  - **ÁîüÂëΩÂë®ÊúüÁªëÂÆö**ÔºöÂÆÉÈöêÂê´Âú∞‰æùËµñ‰∫éÂ∫ïÂ±ÇÂÜÖÂ≠òÁöÑÊúâÊïàÊÄß‚Äî‚ÄîÂ¶ÇÊûú DLL Ë¢´Âç∏ËΩΩÊàñÂÜÖÂ≠òË¢´ÈáäÊîæÔºåËØ• `CStr` Â∞ÜÂèò‰∏∫ÊÇ¨Á©∫ÂºïÁî®Ôºàdangling pointerÔºâ„ÄÇ
  - **ÂÆâÂÖ®ÊäΩË±°**ÔºöRust ÈÄöËøá `CStr` Êèê‰æõ‰∫ÜÂØπ C Â≠óÁ¨¶‰∏≤ÁöÑÂÆâÂÖ®ËÆøÈóÆÊé•Âè£ÔºåÈò≤Ê≠¢Ë∂äÁïåËØªÂèñ„ÄÇ

> ‚úÖ Ê≠§Ê≠•Âª∫Á´ã‰∫ÜÂØπ DLL ÂÜÖÈÉ®Â≠óÁ¨¶‰∏≤ÁöÑ**ÂèóÊéßËßÜÂõæ**Ôºå‰ΩÜÂ∞öÊú™ËÑ±Á¶ªÂéüÂßãÂÜÖÂ≠òÁöÑÊùüÁºö„ÄÇ

---

#### 2. `.to_string_lossy()`ÔºöÂÆπÈîôÂºè UTF-8 ËΩ¨Êç¢

- **ËÉåÊôØ**Ôºö  
  PE Êñá‰ª∂‰∏≠ÁöÑÂáΩÊï∞ÂêçÂíåÊ®°ÂùóÂêçÈÄöÂ∏∏‰ΩøÁî® **ASCII** Êàñ **ANSIÔºàÂ¶Ç Windows-1252Ôºâ** ÁºñÁ†ÅÔºåËÄå Rust ÁöÑ `String` **‰∏•Ê†ºË¶ÅÊ±ÇÂêàÊ≥ï UTF-8**„ÄÇ

- **‰ΩúÁî®**Ôºö  
  - Â∞ùËØïÂ∞Ü `CStr` ‰∏≠ÁöÑÂ≠óËäÇÂ∫èÂàóËß£Èáä‰∏∫ UTF-8„ÄÇ
  - **‚ÄúLossy‚ÄùÔºàÊúâÊçüÔºâÁ≠ñÁï•**ÔºöËã•ÈÅáÂà∞ÈùûÊ≥ï UTF-8 Â∫èÂàóÔºà‰æãÂ¶ÇÊüê‰∫õÊâ©Â±ï ASCII Â≠óÁ¨¶ÔºâÔºå‰∏ç‰ºö panicÔºåËÄåÊòØÁî® Unicode Êõø‰ª£Â≠óÁ¨¶ ``ÔºàU+FFFDÔºâ‰ª£ÊõøÊó†ÊïàÂ≠óËäÇ„ÄÇ
  - ËøîÂõûÁ±ªÂûã‰∏∫ `Cow<str>`ÔºàClone-on-WriteÔºâÔºö  
    - Â¶ÇÊûúËæìÂÖ•Â∑≤ÊòØÂêàÊ≥ï UTF-8ÔºåÂèØËÉΩÁõ¥Êé•ËøîÂõû `&str`ÔºàÈõ∂ÂàÜÈÖçÔºâÔºõ  
    - Âê¶ÂàôÔºå‰ºöÂàÜÈÖçÊñ∞ÂÜÖÂ≠òÂπ∂ËøîÂõûÊã•ÊúâÊâÄÊúâÊùÉÁöÑ `String`„ÄÇ

- **‰∏∫‰ΩïÈúÄË¶ÅÔºü**  
  Âú®Á∫¢ÈòüÂú∫ÊôØ‰∏≠Ôºå‰Ω†Êó†Ê≥ïÊéßÂà∂ÁõÆÊ†á DLL ÁöÑÁºñÁ†ÅÁªÜËäÇÔºàÂ∞§ÂÖ∂ÊòØÁ¨¨‰∏âÊñπÊàñÁ≥ªÁªü DLLÔºâ„ÄÇ`to_string_lossy()` Êèê‰æõ‰∫Ü**ÂÅ•Â£ÆÊÄß‰øùÈöú**ÔºåÈÅøÂÖçÂõ†‰∏™Âà´ÈùûÊ†áÂáÜÂ≠óÁ¨¶ÂØºËá¥Êï¥‰∏™Âä†ËΩΩÂô®Â¥©Ê∫É„ÄÇ

---

#### 3. `.into_owned()`ÔºöÂ§∫ÂèñÊâÄÊúâÊùÉÔºåÂÆûÁé∞Ê∑±Êã∑Ë¥ù

- **ËÉåÊôØ**Ôºö  
  `to_string_lossy()` ËøîÂõûÁöÑ `Cow<str>` ÂèØËÉΩ‰ªçÊòØÂØπ DLL ÂÜÖÂ≠òÁöÑÂºïÁî®ÔºàÂ∞§ÂÖ∂Âú®Á∫Ø ASCII ÊÉÖÂÜµ‰∏ãÔºâ„ÄÇ

- **‰ΩúÁî®**Ôºö  
  Âº∫Âà∂Â∞ÜÂ≠óÁ¨¶‰∏≤ÂÜÖÂÆπ**Ê∑±Êã∑Ë¥ùÂà∞ Rust Â†ÜÂÜÖÂ≠ò‰∏≠**ÔºåËøîÂõû‰∏Ä‰∏™ÂÆåÂÖ®Áã¨Á´ãÁöÑ `String` ÂØπË±°„ÄÇ

- **ÂÆâÂÖ®ÊÑè‰πâ**Ôºö  
  - Âç≥‰æøÂêéÁª≠ DLL Ë¢´ `FreeLibrary` Âç∏ËΩΩÔºåÊàñÂÖ∂ÂÜÖÂ≠òË¢´Ë¶ÜÁõñ/ÈáäÊîæÔºåËØ• `String` ‰æùÁÑ∂ÊúâÊïà„ÄÇ
  - Á¨¶Âêà Rust ÁöÑ**ÊâÄÊúâÊùÉÊ®°Âûã**Ôºö`dll_name` ÂèòÈáèÁé∞Âú®Êã•ÊúâËá™Â∑±ÁöÑÊï∞ÊçÆÔºåÁîüÂëΩÂë®Êúü‰∏çÂÜç‰æùËµñÂ§ñÈÉ®Ê®°Âùó„ÄÇ

> üîí ËøôÊòØÂÆûÁé∞‚ÄúÂÜÖÂ≠òÈöîÁ¶ª‚ÄùÁöÑÂÖ≥ÈîÆ‰∏ÄÊ≠•‚Äî‚ÄîËÆ©ÊïèÊÑüÊìç‰ΩúÔºàÂ¶ÇÊó•Âøó„ÄÅËΩ¨ÂèëËß£Êûê„ÄÅÂìàÂ∏åÊØîÂØπÔºâÂü∫‰∫é**ÂÆâÂÖ®ÂâØÊú¨**ËøõË°å„ÄÇ

---

#### Âú® `dinvk` È°πÁõÆ‰∏≠ÁöÑÂÖ∑‰ΩìÊÑè‰πâ

Âú® `get_proc_address` ÂáΩÊï∞‰∏≠ÔºåËé∑ÂèñÂΩìÂâç DLL ÁöÑÂêçÁß∞Ôºà`dll_name`Ôºâ‰∏ªË¶ÅÁî®‰∫éÂ§ÑÁêÜ **ÂáΩÊï∞ËΩ¨ÂèëÔºàExport ForwardingÔºâ** Âú∫ÊôØÔºö

- Êüê‰∫õ DLLÔºàÂ¶Ç `kernel32.dll`ÔºâÂπ∂‰∏çÁõ¥Êé•ÂÆûÁé∞ÊâÄÊúâÂØºÂá∫ÂáΩÊï∞ÔºåËÄåÊòØÈÄöËøáÂØºÂá∫Ë°®‰∏≠ÁöÑ**ËΩ¨ÂèëÊù°ÁõÆ**ÊåáÁ§∫Ôºö‚ÄúËØ∑Âéª `kernelbase.dll!SomeFunction` ÊâæÁúüÊ≠£ÁöÑÂÆûÁé∞‚Äù„ÄÇ
- ‰∏∫‰∫ÜÈÄíÂΩíËß£ÊûêËøôÁ±ªËΩ¨ÂèëÔºåÁ®ãÂ∫èÂøÖÈ°ªÁü•ÈÅìÔºö
  1. ÂΩìÂâçÊ≠£Âú®Ëß£ÊûêÁöÑÊòØÂì™‰∏™ DLLÔºàÂç≥ `dll_name`ÔºâÔºõ
  2. ËΩ¨ÂèëÁõÆÊ†áÁöÑÊ†ºÂºèÔºàÂ¶Ç `"KERNELBASE.CreateFileW"`Ôºâ„ÄÇ

Âõ†Ê≠§Ôºå`dll_name` ‰ºöË¢´‰º†ÂÖ• `get_forwarded_address` ÂáΩÊï∞ÔºåÁî®‰∫éÔºö

- ÂàÜÂâ≤ËΩ¨ÂèëÂ≠óÁ¨¶‰∏≤ÔºàÊèêÂèñÁõÆÊ†á DLL ÂêçÂíåÂáΩÊï∞ÂêçÔºâ
- ÈÄíÂΩíÂä†ËΩΩÊàñÊü•ÊâæÁõÆÊ†áÊ®°Âùó
- ÊúÄÁªàÂÆö‰ΩçÁúüÂÆûÂáΩÊï∞Âú∞ÂùÄ

---

#### ‰∏ÄÂè•ËØùÊÄªÁªì

> ËøôË°å‰ª£Á†ÅÂÆåÊàê‰∫Ü‰ªé **‚ÄúÂç±Èô©ÁöÑÂéüÂßãÂÜÖÂ≠òÂ≠óËäÇ‚Äù** Âà∞ **‚ÄúÂÆâÂÖ®ÁöÑ„ÄÅÁ¨¶Âêà Rust ÊâÄÊúâÊùÉÊ®°ÂûãÁöÑÊ†áÂáÜÂ≠óÁ¨¶‰∏≤‚Äù** ÁöÑË∑®Ë∂äÔºåÊó¢‰øùËØÅ‰∫Ü‰∏é Windows PE ÁªìÊûÑÁöÑÂÖºÂÆπÊÄßÔºåÂèàÊùúÁªù‰∫ÜÊÇ¨Á©∫ÊåáÈíàÂíåÁºñÁ†ÅÂ¥©Ê∫ÉÈ£éÈô©‚Äî‚ÄîËøôÊòØÊûÑÂª∫ÂèØÈù†„ÄÅÈöêËîΩÂä†ËΩΩÂô®ÁöÑÂü∫Áü≥‰πã‰∏Ä„ÄÇ
